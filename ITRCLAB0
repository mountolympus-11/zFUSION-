ITRCLAB0 TITLE '- GENERATE TRACE EVENT CLASS/CODE LABEL'                00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ITRCLAB0 - GENERATE TRACE EVENT CLASS/CODE LABEL             00040000
*                                                                       00050000
**<DOC-OFF>****************************************************         00060000
                                                                        00070000
         EJECT                                                          00080000
         $TRCDEF DSECT=YES        FORMATTER / EXIT MAPPINGS             00090000
                                                                        00100000
         EJECT                                                          00110000
         EQUS  ,                                                        00120000
                                                                        00130000
         EJECT ,                                                        00140000
ITRCLAB0 #ENTER PREG=(R8,R7),SAVE=NO                                    00150000
                                                                        00160000
         EJECT                                                          00170000
***************************************************************         00180000
*                                                                       00190000
*   RETURN CLASS/CODE IN 20 BYTE FIXED LENGTH AREA                      00200000
*                                                                       00210000
***************************************************************         00220000
         USING TRCFMTX,R8         FORMATTER EXIT ROUTINE                00230000
                                                                        00240000
         MVI   0(R7),C' '         CLEAR THE AIR                         00250000
         MVC   1(19,R7),0(R7)                                           00260000
         LR    R6,R7              CURRENT POSITION                      00270000
                                                                        00280000
*--- INSERT EVENT CLASS NAME ----------------------------------         00290000
                                                                        00300000
         ICM   R5,15,TRCFXCLS     CLASS DESCRIPTOR                      00310000
         BZ    UNKNOWN                                                  00320000
         USING TRFCLS,R5                                                00330000
         ICM   R2,15,TRFCLTGL     TAG PROVIDED?                         00340000
         BZ    UNKNOWN            SKIP IF NOT                           00350000
         L     R1,TRFCLTGA        TAG ORIGIN                            00360000
         BCTR  R2,0               PREPARE FOR COPY                      00370000
         EX    R2,*+4             INSERT IN RETURN AREA                 00380000
         MVC   0(*-*,R6),0(R1)                                          00390000
                                                                        00400000
         LA    R6,1(R2,R6)        LOCATE FREE BYTE                      00410000
         MVI   0(R6),C'/'         CLASS/CODE SEPARATOR                  00420000
         LA    R6,1(,R6)                                                00430000
         DROP  R5                                                       00440000
                                                                        00450000
*--- INSERT EVENT CODE NAME -----------------------------------         00460000
                                                                        00470000
         ICM   R4,15,TRCFXCOD     CODE DESCRIPTOR                       00480000
         BZ    UNKNOWN                                                  00490000
         USING TRFCODE,R4                                               00500000
         ICM   R2,15,TRFCOTGL     TAG PROVIDED?                         00510000
         BZ    UNKNOWN            SKIP IF NOT                           00520000
         L     R1,TRFCOTGA        TAG ORIGIN                            00530000
         BCTR  R2,0               PREPARE FOR COPY                      00540000
         EX    R2,*+4             INSERT IN RETURN AREA                 00550000
         MVC   0(*-*,R6),0(R1)                                          00560000
         B     RETURN                                                   00570000
         DROP  R4                                                       00580000
                                                                        00590000
*--- UNKNOWN CLASS OR CODE ------------------------------------         00600000
                                                                        00610000
UNKNOWN  DS    0H                                                       00620000
         MVC   0(L'DFLTAG,R6),DFLTAG                                    00630000
                                                                        00640000
         EJECT                                                          00650000
*--------------------------------------------------------------         00660000
*   COMPLETE THE REQUEST                                                00670000
*--------------------------------------------------------------         00680000
RETURN   DS    0H                 LINE COMPLETED - TRACE REC COMPLETE   00690000
         LR    R1,R7              RETURN STRING                         00700000
         LA    R0,20              FIXED LENGTH                          00710000
         LA    R15,RC00                                                 00720000
                                                                        00730000
         #EXIT ,                  RETURN                                00740000
                                                                        00750000
         EJECT ,                                                        00760000
***************************************************************         00770000
*                                                                       00780000
*   LOCAL READ ONLY WORKING STORAGE                                     00790000
*                                                                       00800000
***************************************************************         00810000
DFLTAG   DC    C'*UNKNOWN*'                                             00820000
                                                                        00830000
         LTORG ,                                                        00840000
                                                                        00850000
         PRINT NOGEN                                                    00860000
         ICVT ,                                                         00870000
         END   ,                                                        00880000
