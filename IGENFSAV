IGENFSAV TITLE '- #EXIT SAVEAREA FRAME RELEASE'                         00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE:  IGENFSAV - #EXIT SAVEAREA FRAME RELEASE                     00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    The savearea frame previously allocated by IGENGSAV is             00080000
*    removed from the $FRAME stack and $RETSTOR released.               00090000
*    Refer to IGENGSAV for a discussion of savearea frame               00100000
*    format and management.                                             00110000
*                                                                       00120000
*                                                                       00130000
* NOTES:                                                                00140000
*                                                                       00150000
*    This routine and its underlying $RETSTOR service accept            00160000
*    nonSTDENV, task mode callers.                                      00170000
*                                                                       00180000
*                                                                       00190000
* ON ENTRY:                                                             00200000
*                                                                       00210000
*    R1  contains the savearea frame origin                             00220000
*                                                                       00230000
*                                                                       00240000
* ON EXIT:                                                              00250000
*                                                                       00260000
*    R15 contains zero                                                  00270000
*                                                                       00280000
**<DOC-OFF>****************************************************         00290000
                                                                        00300000
         EJECT                                                          00310000
         @CB   WORKUNIT=YES                                             00320000
                                                                        00330000
         EJECT                                                          00340000
         FRCA  ,                  FRAME CONTROL AREA                    00350000
                                                                        00360000
         EJECT                                                          00370000
         EQUS  LINKAGE=COND                                             00380000
                                                                        00390000
         EJECT                                                          00400000
IGENFSAV #ENTER LINKAGE=BAKR,SAVE=NO,ASC=P,PREG=(R8)                    00410000
                                                                        00420000
         @RESTENV TASKMODE=YES                                          00430000
                                                                        00440000
         USING ITASK,R10          STDENV RESTORED                       00450000
                                                                        00460000
         EJECT                                                          00470000
***************************************************************         00480000
*                                                                       00490000
*   REMOVE THE SAVEAREA FROM THE $FRAME STACK IF STDENV                 00500000
*                                                                       00510000
***************************************************************         00520000
         LR    R2,R8              FRAME ORIGIN                          00530000
         AH    R2,0(R8)           LOCATE FRCA APPENDAGE                 00540000
         AH    R2,2(,R8)                                                00550000
                                                                        00560000
         $FRAME POP,FRCA=(R2)     UNSTACK THE FRAME                     00570000
                                                                        00580000
         LR    R3,R1              WORKUNIT ORIGIN                       00590000
                                                                        00600000
***************************************************************         00610000
*                                                                       00620000
*   RELEASE THE SAVEAREA FRAME SUPPLYING CURRENT WORKUNIT               00630000
*                                                                       00640000
***************************************************************         00650000
         $RETSTOR (R8),OWNER=(R3)                                       00660000
                                                                        00670000
***************************************************************         00680000
*                                                                       00690000
*   RETURN TO CALLER                                                    00700000
*                                                                       00710000
***************************************************************         00720000
         LA    R15,RC00           COMPLETE                              00730000
                                                                        00740000
         #EXIT ,                                                        00750000
                                                                        00760000
         EJECT                                                          00770000
***************************************************************         00780000
*                                                                       00790000
*   LOCAL READ ONLY WORKING STORAGE                                     00800000
*                                                                       00810000
***************************************************************         00820000
         LTORG ,                                                        00830000
                                                                        00840000
         PRINT NOGEN                                                    00850000
         ICVT  ,                                                        00860000
         ITASK ,                                                        00870000
         END   ,                                                        00880000
