ILOCSSET TITLE '- LOCATE SCREEN SET DESCRIPTOR'                         00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ILOCSSET - Locate screen set descriptor                      00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    This routine is used to acquire the address of the screen          00080000
*    set descriptor (EXRGNET) associated with a screen or               00090000
*    screen set containing regions.  The screen(set) is                 00100000
*    identified by name.  If the screen(set) does not contain           00110000
*    regions, RC04 is returned.                                         00120000
*                                                                       00130000
*                                                                       00140000
* ON ENTRY:                                                             00150000
*                                                                       00160000
*    R1 - addr of screen(set) name                                      00170000
*                                                                       00180000
*                                                                       00190000
* ON EXIT:                                                              00200000
*                                                                       00210000
*    R15 contains one of the following return codes                     00220000
*                                                                       00230000
*        RC00 - matching screen set exrgnet returned via R1             00240000
*                                                                       00250000
*        RC04 - no matching screen set exrgnet found                    00260000
*                                                                       00270000
*        RC08 - screen set found but region tree is invalid             00280000
*                                                                       00290000
*               R0 - region tree build failure code                     00300000
*                                                                       00310000
**<DOC-OFF>****************************************************         00320000
                                                                        00330000
         EJECT                                                          00340000
         REGION ,                                                       00350000
                                                                        00360000
         EJECT                                                          00370000
         EXRGNET ,                                                      00380000
                                                                        00390000
         EJECT                                                          00400000
         EQUS  ,                                                        00410000
                                                                        00420000
         EJECT ,                                                        00430000
ILOCSSET #ENTER BASE=R12,PREG=R8,SAVE=NO                                00440000
                                                                        00450000
         USING ITASK,R10          ITASK ADDRESSABILITY                  00460000
         L     R9,TSKPCBC         ADDR OF CURRENT PCB                   00470000
         USING IPCB,R9            IPCB  ADDRESSABILITY                  00480000
         L     R7,PCBUSER         ADDR OF USER BLOCK                    00490000
         USING IUSER,R7           TEMP ADDRESSABILITY                   00500000
         ICM   R7,15,USRPROJ      ADDR OF PROJ BLOCK                    00510000
         USING IPROJ,R7           ADDRESSABILITY                        00520000
         BZ    ILOCMISS           PROJECT NOT OPEN                      00530000
                                                                        00540000
*--------------------------------------------------------------         00550000
*   LOCATE SCREEN SET DESCRIPTOR                                        00560000
*--------------------------------------------------------------         00570000
         ICM   R5,15,PRJEXRGN     EXRGNET ANCHOR                        00580000
         BZ    ILOCMISS           NO SCREEN SETS DEFINED                00590000
         USING EXRGNET,R5         IDENTIFIER FORMAT                     00600000
                                                                        00610000
ILOCNEXT DS    0H                                                       00620000
         CLC   EXRNSSET,0(R8)     MATCHING SCREEN SET?                  00630000
         BE    ILOCHIT            SUCCESS IF SO                         00640000
         ICM   R5,15,EXRNEXT      ELSE CONTINUE                         00650000
         BNZ   ILOCNEXT           UNTIL MATCH OR END OF LIST            00660000
         B     ILOCMISS           NO MATCH                              00670000
                                                                        00680000
*--------------------------------------------------------------         00690000
*   RETURN COMPLETION STATUS TO CALLER                                  00700000
*--------------------------------------------------------------         00710000
ILOCHIT  DS    0H                                                       00720000
         LA    R1,EXRGNET         RETURN MATCHING EXRGNET               00730000
         LA    R15,RC00           ASSUME REGION TREE IS VALID           00740000
         ICM   R0,15,EXRNRC       ASSUMPTION CORRECT                    00750000
         BZ    ILOCRET            DONE IF SO                            00760000
         LA    R15,RC08           ELSE INDICATE ERROR                   00770000
         B     ILOCRET                                                  00780000
                                                                        00790000
ILOCMISS DS    0H                 NO MATCHING EXRGNET FOUND             00800000
         LA    R15,RC04                                                 00810000
         B     ILOCRET                                                  00820000
                                                                        00830000
ILOCRET  DS    0H                                                       00840000
         #EXIT ,                  RETURN                                00850000
                                                                        00860000
***************************************************************         00870000
*                                                                       00880000
*   LOCAL READ-ONLY DATA AREAS, MAPPINGS, ETC.                          00890000
*                                                                       00900000
***************************************************************         00910000
                                                                        00920000
         LTORG ,                                                        00930000
         DROP  ,                                                        00940000
                                                                        00950000
         PRINT NOGEN                                                    00960000
         ICVT  ,                                                        00970000
         ITASK ,                                                        00980000
         IPCB  ,                                                        00990000
         IUSER ,                                                        01000000
         IPROJ ,                                                        01010000
         END   ,                                                        01020000
