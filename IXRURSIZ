IXRURSIZ TITLE '- DERIVE BULK DATA RESPONSE BUFFER SIZE'                00010000
**<DOC-ON>******************************************************        00020000
*                                                                       00030000
* ROUTINE: IXRURSIZ - Derive bulk data response buffer size             00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    This routine is used to acquire a default bulk data                00080000
*    response (TXP) buffer size appropriate for the type of             00090000
*    communications link connecting the transaction server              00100000
*    to the cooperative process.                                        00110000
*                                                                       00120000
*    A possible strategy is to move a buffer size value within          00130000
*    lower and upper bounds, continually adjusting it based on          00140000
*    feedback from HXP.  Consider as a major control the                00150000
*    amount of the buffer actually used and the fragmentation           00160000
*    of the last extent (zero w/LU6.2).                                 00170000
*                                                                       00180000
*                                                                       00190000
* ON ENTRY:                                                             00200000
*                                                                       00210000
*    N/A                                                                00220000
*                                                                       00230000
* ON EXIT:                                                              00240000
*                                                                       00250000
*    R1  contains the recommended bulk data response buffer size        00260000
*                                                                       00270000
**<DOC-OFF>*****************************************************        00280000
                                                                        00290000
         EJECT                                                          00300000
****************************************************************        00310000
*                                                                       00320000
* MAINTENANCE:                                                          00330000
*                                                                       00340000
*   08/11/94 R. Turgeon                                                 00350000
*            Initial version                                            00360000
*                                                                       00370000
****************************************************************        00380000
                                                                        00390000
         EJECT                                                          00400000
         TXPHDR ,                 TXP BUFFER MANAGEMENT                 00410000
                                                                        00420000
         EJECT                                                          00430000
         REQHDR ,                 TRANSMISSION DESCRIPTOR FORMAT        00440000
                                                                        00450000
         EJECT                                                          00460000
         IUSER  ,                 USER INSTANCE                         00470000
                                                                        00480000
         EJECT                                                          00490000
         EQUS  ,                  GENERAL EQUATES                       00500000
                                                                        00510000
         EJECT                                                          00520000
IXRURSIZ #ENTER SAVE=NO,PREG=R8   ENTRY LINKAGE                        +00530000
                                                                        00540000
         USING ITASK,R10          STDENV                                00550000
                                                                        00560000
         L     R9,TSKPCBC         PROCESS MODE                          00570000
         USING IPCB,R9                                                  00580000
                                                                        00590000
         L     R6,PCBUSER         LOCATE IUSER                          00600000
         USING IUSER,R6                                                 00610000
                                                                        00620000
*---------------------------------------------------------------        00630000
*   SELECT DEFAULT TXP BUFFER SIZE                                      00640000
*---------------------------------------------------------------        00650000
         L     R1,=A(6*1024)                big block                   00660000
         SH    R1,OVHDTXP                   LESS TXP OVERHEAD           00670000
         SH    R1,ICTOVSTG                  LESS $GETSTOR OVERHEAD      00680000
                                                                        00690000
*---------------------------------------------------------------        00700000
*   RETURN TO REQUESTER                                                 00710000
*---------------------------------------------------------------        00720000
         LA    R15,RC00           NORMAL COMPLETION                     00730000
         SR    R0,R0              REASON CODE NOT DEFINED               00740000
                                                                        00750000
         #EXIT ,                  RETURN                                00760000
                                                                        00770000
         EJECT                                                          00780000
****************************************************************        00790000
*                                                                       00800000
*  CONSTANTS AND LITERALS                                               00810000
*                                                                       00820000
****************************************************************        00830000
OVHDTXP  DC    AL2((TXPHDRLN+REQHDRLN+7)/8*8)                           00840000
         LTORG ,                                                        00850000
                                                                        00860000
         PRINT NOGEN                                                    00870000
         ICVT  ,                                                        00880000
         ITASK ,                                                        00890000
         IPCB  ,                                                        00900000
         END   ,                                                        00910000
