ICMDICT  TITLE '- COUNT COMMAND PROCESSOR'                              00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ICMDICT - COUNT command processor                            00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    This routine processes the various forms of the COUNT              00080000
*    command used to update and/or display item counter values.         00090000
*                                                                       00100000
* BASIC SYNTAX:                                                         00110000
*                                                                       00120000
*    COUNT DISPLAY <ITEM(item-list)>                                    00130000
*    COUNT RESET <ITEM(item-list)>                                      00140000
*    where:                                                             00150000
*      <item-list> := comma delimitted list of item tags                00160000
*                  := * means all items                                 00170000
*                                                                       00180000
* NOTES:                                                                00190000
*    COUNT RESET displays counts before reseting.                       00200000
*                                                                       00210000
* ON ENTRY:                                                             00220000
*                                                                       00230000
*    R1  contains the address of the command request block              00240000
*        (CMDREQ) in local CMDPROC format                               00250000
*                                                                       00260000
**<DOC-OFF>****************************************************         00270000
                                                                        00280000
***************************************************************         00290000
*                                                                       00300000
* MAINTENANCE:                                                          00310000
*                                                                       00320000
***************************************************************         00330000
                                                                        00340000
         #WORK ,             BEGIN WORKAREA                             00350000
WREGS1   DS    16F           REGISTER SAVE AREA                         00360000
         ORG   WREGS1                                                   00370000
WMKLREGS DS    16F                                                      00380000
                                                                        00390000
WREGS2   DS    16F           REGISTER SAVE AREA                         00400000
         ORG   WREGS2                                                   00410000
WALLREGS DS    16F                                                      00420000
                                                                        00430000
WSTCK    DS    D             CURRENT TIME                               00440000
WFLAGS   DS    X             CONTROL/STATUS FLAGS                       00450000
#WFHDR   EQU   X'01'           DISPLAY HEADER DISPLAYED                 00460000
#WFDISPL EQU   X'02'           DISPLAY COUNTS COMMAND                   00470000
#WFRESET EQU   X'04'           RESET COUNTS COMMAND                     00480000
#WFCMD   EQU   #WFRESET+#WFDISPL COMMANDS                               00490000
                                                                        00500000
WCMDORG  DS    A             OPERAND STRING ORIGIN                      00510000
WREQ     DS    XL(L'CCSID)   REQUEST CODE                               00520000
WVORG    DS    A             VALUE ITEM-LIST ORIGIN                     00530000
WVCOUNT  DS    F             VALUE ITEM-LIST ENTRIES                    00540000
WTAG     DS    CL(L'ICATAG)  ITEM NAME WORK AREA                        00550000
                                                                        00560000
WACTION  DS    X             ITEM ACTION                                00570000
#WAFRST  EQU   X'01'         RESET ITEM COUNTER DATA                    00580000
#WAFDSP  EQU   X'02'         DISPLAY ITEM COUNTER DATA                  00590000
                                                                        00600000
PATAREA  DS    XL9                                                      00610000
*                            ITEM ACTION LIST - ACTIONS TO TAKE PER     00620000
*                              ITEM IN THE ITEM COUNTER TABLE           00630000
WIAL     DS    XL(256*L'WACTION) ROOM FOR 256 ITEMS                     00640000
                                                                        00650000
         #ENDWORK ,          END OF WORKAREA                            00660000
*---------------------------------------------------------------------- 00670000
                                                                        00680000
         EJECT ,                                                        00690000
         CMDREQ ,            COMMAND REQUEST BLOCK                      00700000
                                                                        00710000
         EJECT ,                                                        00720000
         CCSUMRY ,           COMMAND OPERAND PREPARSE SUMMARY           00730000
                                                                        00740000
         EJECT ,                                                        00750000
         $MCLASS DSECT=YES   MSG CLASS DEFINITIONS AND CLASS ENTRIES    00760000
                                                                        00770000
         EJECT ,                                                        00780000
         $MSGCNST ,          MESSAGE CONSTANTS / ROUTING CODES          00790000
                                                                        00800000
         EJECT ,                                                        00810000
         $INCR TYPE=DSECT                                               00820000
                                                                        00830000
         EJECT ,                                                        00840000
         KEYCODES COMMANDSET=COUNT                                      00850000
                                                                        00860000
         EJECT ,                                                        00870000
         CMDCODES ,                                                     00880000
                                                                        00890000
         EJECT ,                                                        00900000
         ABCODES ,                                                      00910000
                                                                        00920000
         EJECT ,                                                        00930000
         EQUS  ,                                                        00940000
*---------------------------------------------------------------------- 00950000
                                                                        00960000
         EJECT ,                                                        00970000
         $MSGDFT PREFIX=ICTPID,COMPID='CMD',TABLE=*#MSGS,              X00980000
               CONID=*CMRQCNID,CONNAME=CMRQCNAM,CART=CMRQCART,         X00990000
               DESTADD=*CMRQDMSK,                                      X01000000
               MSGQA=*CMRQMQA,STGQH=*CMRQSTGQ,                         X01010000
               MF=(E,MFE_LIST),                                        X01020000
               PRINT=NOGEN                                              01030000
                                                                        01040000
ICMDICT  #ENTER BASE=R12,                                              +01050000
               PREG=R8,                                                +01060000
               AMODE=31,                                               +01070000
               RMODE=ANY                                                01080000
                                                                        01090000
         USING ICVT,R11                                                 01100000
         USING ITASK,R10                                                01110000
                                                                        01120000
         EJECT ,                                                        01130000
***************************************************************         01140000
*                                                                       01150000
*    COMMAND PARSE                                                      01160000
*                                                                       01170000
***************************************************************         01180000
                                                                        01190000
         USING CMDREQ,R8          COMMAND REQUEST BLOCK                 01200000
                                                                        01210000
         ICM   R7,15,CMRQSMRY     COMMAND SUMMARY ?                     01220000
         BZ    PARSDONE             NO, DONE                            01230000
                                                                        01240000
         USING CCSUMRY,R7         R7 --> CCSUMRY                        01250000
                                                                        01260000
         ICM   R5,15,CMRQSMR#     OPERAND ENTRIES ?                     01270000
         BZ    PARSDONE             NO, DONE                            01280000
                                                                        01290000
         L     R1,CMRQOPST        SAVE OPERAND STRING ORIGIN            01300000
         ST    R1,WCMDORG                                               01310000
                                                                        01320000
*--------------------------------------------------------------         01330000
*   IDENTIFY THE OPERANDS PROVIDED AND VALIDATE                         01340000
*--------------------------------------------------------------         01350000
                                                                        01360000
PARSENXT DS    0H                                                       01370000
         CLC   CCSID,=AL2(COUNT_DISPLAY)                                01380000
         BE    PARSDISPL          DISPLAY                               01390000
                                                                        01400000
         CLC   CCSID,=AL2(COUNT_RESET)                                  01410000
         BE    PARSRESET          RESET                                 01420000
                                                                        01430000
         CLC   CCSID,=AL2(COUNT_ITEM)                                   01440000
         BE    PARSITML           ITEM LIST                             01450000
                                                                        01460000
         B     ERREJECT           REJECT OTHERWISE                      01470000
                                                                        01480000
*--------------------------------------------------------------         01490000
*   COMMAND REQUESTS                                                    01500000
*--------------------------------------------------------------         01510000
                                                                        01520000
PARSDISPL DS 0H                                                         01530000
         OI    WFLAGS,#WFDISPL     DISPLAY COUNTS                       01540000
         B     ADVANCE             NEXT OPERAND                         01550000
                                                                        01560000
*--------------------------------------------------------------         01570000
*   COMMAND REQUESTS                                                    01580000
*--------------------------------------------------------------         01590000
                                                                        01600000
PARSRESET DS 0H                                                         01610000
         OI    WFLAGS,#WFRESET     RESET COUNTS                         01620000
         B     ADVANCE             NEXT OPERAND                         01630000
                                                                        01640000
*--------------------------------------------------------------         01650000
*   ITEM LIST                                                           01660000
*--------------------------------------------------------------         01670000
                                                                        01680000
PARSITML DS    0H                                                       01690000
         OC    WVORG,WVORG        ITEM LIST ALREADY GIVEN ?             01700000
         BNZ   ERRCNFLC             YES, CONFLICT                       01710000
         LA    R0,CCSVALS         SAVE ITEM VALUE LIST ORIGIN           01720000
         ST    R0,WVORG                                                 01730000
         LH    R0,CCSVALCT        SAVE NUMBER OF ENTRIES                01740000
         ST    R0,WVCOUNT                                               01750000
         B     ADVANCE            NEXT OPERAND                          01760000
                                                                        01770000
*--------------------------------------------------------------         01780000
*   PROCESS ALL KEYWORDS                                                01790000
*--------------------------------------------------------------         01800000
                                                                        01810000
ADVANCE  DS    0H                                                       01820000
         LA    R15,CCSVSLN        LENGTH OF EACH VALUE ENTRY            01830000
         MH    R15,CCSVALCT       TOTAL SIZE CONSUMED BY VALUES         01840000
         LA    R7,CCSUMRY+CCSPFXL(R15)                                  01850000
         BCT   R5,PARSENXT        EXAMINE ALL OPERANDS                  01860000
         DROP  R7                 CCSUMRY                               01870000
                                                                        01880000
PARSDONE DS 0H                                                          01890000
         TM    WFLAGS,#WFCMD      ANY COMMANDS ?                        01900000
         BNZ   RQDISPLAY            YES, PROCESS THEM                   01910000
         OI    WFLAGS,#WFDISPL      NO, DEFAULT TO DISPLAY              01920000
                                                                        01930000
RQDISPLAY DS 0H                                                         01940000
                                                                        01950000
         TM    WFLAGS,#WFDISPL    DISPLAY ?                             01960000
         BNO   RQRESET              NO, TRY RESET                       01970000
*        $INCR ICA_COUNT_DISPLAY  UPDATE "DISPLAY" COUNTER              01980000
         OI    WACTION,#WAFDSP    INDICATE DISPLAY ACTION               01990000
                                                                        02000000
RQRESET  DS 0H                                                          02010000
         TM    WFLAGS,#WFRESET    DISPLAY ?                             02020000
         BNO   RQ_COMMON            NO, TRY RESET                       02030000
*        $INCR ICA_COUNT_RESET    UPDATE "RESET" COUNTER                02040000
         OI    WACTION,#WAFRST    INDICATE RESET ACTION                 02050000
         B     RQ_COMMON                                                02060000
                                                                        02070000
*                                                                       02080000
* Value list processing                                                 02090000
*                                                                       02100000
RQ_COMMON DS 0H                                                         02110000
         OC    WVORG,WVORG        ITEM VALUE LIST GIVEN ?               02120000
         BNZ   RQD_MAKE_LIST        YES, VALIDATE VALUE LIST            02130000
         BAS   R14,TAGALL           NO, BUILD LIST OF ALL               02140000
         B     ACTON_LIST         ACT ON ALL ITEMS                      02150000
                                                                        02160000
RQD_MAKE_LIST DS 0H                                                     02170000
         BAS   R14,MAKELIST       VALIDATE VALUES & BUILD ACTION LIST   02180000
         BNZ   ERR_BAD_LIST       BUILT OK ? NO, ERROR                  02190000
         B     ACTON_LIST         ACT ON SELECTED ITEMS                 02200000
                                                                        02210000
         EJECT ,                                                        02220000
*--------------------------------------------------------------         02230000
* TAKE ACTION(S) PER LIST ITEM                                          02240000
*--------------------------------------------------------------         02250000
ACTON_LIST DS 0H                                                        02260000
         STCK  WSTCK              CURRENT TIME                          02270000
                                                                        02280000
         L     R7,ICTICTRA        ITEM COUNTER AREA                     02290000
         USING ICAH,R7            R7 --> ICAH                           02300000
         LH    R6,ICAE#           NUMBER OF ITEM ENTRIES                02310000
         LA    R7,ICAEORG         ITEM ENTRY'S ORIGIN                   02320000
         USING ICAE,R7            r7 --> ICAE                           02330000
                                                                        02340000
ACT_NEXT DS 0H                                                          02350000
         LA    R5,WIAL            LIST ITEM'S ACTION FLAGS              02360000
         SR    R4,R4                                                    02370000
         IC    R4,ICAID           ID IS ITEM'S ACTION LIST OFFSET       02380000
         LA    R5,0(R4,R5)        ITEM'S ACTION-FLAGS ADDRESS           02390000
         TM    0(R5),#WAFDSP      DISPLAY ?                             02400000
         BNO   ACT_NO_DISP          NO                                  02410000
*                                                                       02420000
* Display item's counts                                                 02430000
*                                                                       02440000
         TM    WFLAGS,#WFHDR      HEADER DISPLAYED ?                    02450000
         BNZ   ACT_HDR              YES, DO NOT DISPLAY AGAIN           02460000
                                                                        02470000
         $MSG  351                DISPLAY HEADER                        02480000
                                                                        02490000
         OI    WFLAGS,#WFHDR      REMEMBER HEADER DISPLAYED             02500000
                                                                        02510000
ACT_HDR  DS 0H                                                          02520000
         L     R4,ICAI#           COMPUTE CURRENT TOTAL                 02530000
         LR    R3,R4                                                    02540000
         A     R4,ICAT#                                                 02550000
         L     R1,ICAIS           INTERVAL START TIME                   02560000
         L     R0,WSTCK           CURRENT TIME                          02570000
         SR    R0,R1              ELAPSED TIME (IN 1.048576 SECS)       02580000
         SR    R1,R1              CLEAR FOR SHIFT                       02590000
         SRDL  R0,12              ELAPSED TIME (IN MICRO SECS)          02600000
         D     R0,=F'1000000'     (TIME IN SECS)                        02610000
*        D     R0,=F'100000000'   (TIME IN 100 SECS)                    02620000
         SR    R2,R2              CLEAR FOR DIVIDE                      02630000
         MH    R3,=H'100'         (COUNT IN 100 SECS)                   02640000
         C     R1,=F'0'           ZERO DIVIDE ?                         02650000
         BNE   ACT_RATE             NO, OK TO DO IT                     02660000
         MVC   PATAREA+1(L'PATAREA-1),=C'    ?.??'                      02670000
         B     ACT_MSG            DISPLAY IT                            02680000
                                                                        02690000
ACT_RATE DS 0H                                                          02700000
         DR    R2,R1              COUNTS / (100 SECS)                   02710000
         CVD   R3,DWORD                                                 02720000
         MVC   PATAREA,=X'4020202021204B2020'                           02730000
         ED    PATAREA,DWORD+4                                          02740000
                                                                        02750000
ACT_MSG  DS 0H                                                          02760000
         $MSG  352,                                                    +02770000
               FIELDS=(ICATAG,ICADESC,ICAI#,(R4),                      +02780000
               (PATAREA+1,L'PATAREA-1))                                 02790000
                                                                        02800000
ACT_NO_DISP DS 0H                                                       02810000
         TM    0(R5),#WAFRST      RESET ?                               02820000
         BNO   ACT_NEXT_ENTRY       NO                                  02830000
*                                                                       02840000
* Reset item's interval count                                           02850000
*                                                                       02860000
         L     R14,ICAI#          CURRENT ITEM COUNT                    02870000
ACT_RESET_INTERVAL DS 0H                                                02880000
         SR    R15,R15            NEW ITEM COUNT IS ZERO                02890000
         CS    R14,R15,ICAI#      UPDATE COUNT                          02900000
         BNE   ACT_RESET_INTERVAL UPDATED ? NO, TRY AGAIN               02910000
                                                                        02920000
         MVC   ICAIS,WSTCK        SET NEW TIME - NOT STRICTLY LEGAL     02930000
*                                                                       02940000
* Update item's total count                                             02950000
*                                                                       02960000
         LR    R1,R14             SAVE TOTAL'S UPDATE-AMOUNT            02970000
         L     R14,ICAT#          CURRENT TOTAL COUNT                   02980000
ACT_RESET_TOTAL DS 0H                                                   02990000
         LA    R15,0(R1,R14)      NEW TOTAL COUNT                       03000000
         CS    R14,R15,ICAT#      UPDATE                                03010000
         BNE   ACT_RESET_TOTAL    UPDATED ? NO, TRY AGAIN               03020000
*                                                                       03030000
* Next item counter area entry                                          03040000
*                                                                       03050000
ACT_NEXT_ENTRY DS 0H                                                    03060000
         LA    R7,ICAELEN(,R7)    NEXT ITEM ENTRY                       03070000
         BCT   R6,ACT_NEXT                                              03080000
                                                                        03090000
         TM    WFLAGS,#WFRESET    COUNTS RESET ?                        03100000
         BNO   RETURNOK                                                 03110000
                                                                        03120000
         $MSG  353                COUNTS RESET                          03130000
                                                                        03140000
         B     RETURNOK           DONE                                  03150000
         DROP  R7                                                       03160000
                                                                        03170000
         EJECT ,                                                        03180000
***************************************************************         03190000
*                                                                       03200000
* Validate value list and flag item ids for action                      03210000
*                                                                       03220000
* Loop through the list of supplied values.  For each value             03230000
* verify that it has a valid length and is an item in the               03240000
* item counter area.    If valid, update the item action list           03250000
* by flagging it's entry with the supplied flag value.  The item's      03260000
* action list entry is at offset ICAID from the start of the list.      03270000
*                                                                       03280000
***************************************************************         03290000
                                                                        03300000
MAKELIST DS 0H                                                          03310000
         PUSH USING                                                     03320000
         STM   R0,R15,WMKLREGS    PROTECT CALLER'S REGISTERS            03330000
                                                                        03340000
         ICM   R15,15,ICTICTRA    ITEM COUNTER AREA EXIST ?             03350000
         BZ    MKL_EXIT             NO, EXIT                            03360000
                                                                        03370000
         USING ICAH,R15           R15 --> ICAH                          03380000
                                                                        03390000
         LH    R0,ICAE#           ITEM ENTRIES IN ICA                   03400000
         LTR   R0,R0              ANY ?                                 03410000
         BZ    MKL_EXIT             NO, EXIT                            03420000
                                                                        03430000
         L     R1,WVORG           VALUE LIST ORIGIN                     03440000
                                                                        03450000
         USING CCSVALS,R1         R1 --> CCSVALS                        03460000
                                                                        03470000
         L     R2,WVCOUNT         VALUE LIST COUNT                      03480000
         LA    R3,WIAL            ITEM-ACTION-LIST ORIGIN               03490000
         L     R4,WCMDORG         COMMAND LINE ORIGIN                   03500000
*                                                                       03510000
* Inspect value list entry                                              03520000
*                                                                       03530000
MKL_TESTVAL DS 0H                                                       03540000
         LH    R5,CCSVLEN         VALUE'S LENGTH LOWER BOUND ...        03550000
         LTR   R5,R5              ... LEGAL ?                           03560000
         BNP   MKL_BAD_VLEN         NO, ERROR                           03570000
                                                                        03580000
         CH    R5,=AL2(L'ICATAG)  VALUE'S LENGTH UPPER BOUND OK ?       03590000
         BH    MKL_BAD_VLEN         NO, ERROR                           03600000
                                                                        03610000
         L     R6,CCSVDISP        VALUE'S COMMAND LINE OFFSET           03620000
         AR    R6,R4              VALUE'S ADDRESS                       03630000
                                                                        03640000
         BCTR  R5,0               VALUE'S EX LENGTH                     03650000
         LTR   R5,R5              SOLO CHAR ?                           03660000
         BNZ   MKL_SCAN             NO, CANNOT BE A WILD CARD           03670000
         CLI   0(R6),C'*'         WILD CARD ?                           03680000
         BNE   MKL_SCAN             NO, SCAN FOR A MATCH                03690000
                                                                        03700000
         BAS   R14,TAGALL         TAG ALL ITEMS ...                     03710000
         B     MKL_NEXTVAL        ...BUT CHECK FOR BAD VALUE TOO        03720000
*                                                                       03730000
* Scan ITEMs to match supplied item-list value.                         03740000
*                                                                       03750000
MKL_SCAN DS 0H                                                          03760000
         LH    R0,ICAE#           R0 = ENTRIES IN ICA                   03770000
         LA    R7,ICAEORG         ENTRIES' ORIGIN                       03780000
                                                                        03790000
         USING ICAE,R7            R7 --> ICAE                           03800000
                                                                        03810000
MKL_SCAN_NEXT DS 0H                                                     03820000
         MVC   WTAG,BLANKS                                              03830000
         EX    R5,*+4                                                   03840000
         MVC   WTAG(0),0(R6)                                            03850000
         CLC   WTAG,ICATAG                                              03860000
         BNE   MKL_NEXTITM          NO, NEXT ITEM                       03870000
         SR    R8,R8              PREPARE FOR INSERT                    03880000
         ICM   R8,B'0001',ICAID   ID IS OFFSET INTO ITEM ACTION LIST    03890000
         AR    R8,R3              ITEM'S ACTION FLAG                    03900000
         OC    0(1,R8),WACTION    SET ITEM'S ACTION                     03910000
         B     MKL_NEXTVAL        NEXT VALUE                            03920000
                                                                        03930000
MKL_NEXTITM DS 0H                                                       03940000
         LA    R7,ICAELEN(0,R7)   NEXT ITEM ENTRY                       03950000
         BCT   R0,MKL_SCAN_NEXT   SCAN ALL                              03960000
         B     MKL_NOMATCH        NOT FOUND                             03970000
                                                                        03980000
         DROP  R7                                                       03990000
*                                                                       04000000
* Position to next value list entry                                     04010000
*                                                                       04020000
MKL_NEXTVAL DS 0H                                                       04030000
         LA    R1,CCSVSLN(0,R1)   NEXT VALUE ENTRY                      04040000
         BCT   R2,MKL_TESTVAL     TEST ALL VALUES                       04050000
         SR    R15,R15            INDICATE NO ERROR DETECTED            04060000
         B     MKL_EXIT           EXIT                                  04070000
                                                                        04080000
         DROP  R1                                                       04090000
         DROP  R15                                                      04100000
                                                                        04110000
MKL_NOMATCH DS 0H                 VALUE NOT FOUND IN ITEM COUNTER TBL   04120000
MKL_BAD_VLEN DS 0H                INVALID VALUE LENGTH                  04130000
         LA    R15,RC04           INDICATE ERROR                        04140000
                                                                        04150000
MKL_EXIT DS 0H                                                          04160000
         LM    R0,R14,WMKLREGS    RESTORE CALLER'S REGISTERS            04170000
         LTR   R15,R15            SET CC                                04180000
         BR    R14                                                      04190000
         POP   USING                                                    04200000
                                                                        04210000
         EJECT ,                                                        04220000
***************************************************************         04230000
*                                                                       04240000
* Turn on the supplied flag for all items                               04250000
*                                                                       04260000
* Entry:                                                                04270000
*   WACTION - a one byte flag to be ORed into item-id                   04280000
*   action list                                                         04290000
*                                                                       04300000
***************************************************************         04310000
                                                                        04320000
TAGALL   DS 0H                                                          04330000
         PUSH  USING                                                    04340000
         STM   R0,R15,WALLREGS    PROTECT CALLER'S REGISTERS            04350000
                                                                        04360000
         ICM   R15,15,ICTICTRA    ITEM COUNTER AREA EXIST ?             04370000
         BZ    TAG_EXIT             NO, DONE                            04380000
         USING ICAH,R15                                                 04390000
         LH    R0,ICAE#           NUMBER OF ENTRIES                     04400000
         DROP  R15                                                      04410000
         LA    R3,WIAL            ITEM-ACTION-LIST ORIGIN               04420000
                                                                        04430000
TAG_NEXT DS 0H                                                          04440000
         OC    0(1,R3),WACTION    TURN ON ACTION FLAG                   04450000
         LA    R3,1(R3)           NEXT ITEM                             04460000
         BCT   R0,TAG_NEXT        TURN ON FOR ALL                       04470000
                                                                        04480000
TAG_EXIT DS 0H                                                          04490000
         LM    R0,R15,WALLREGS    RESTORE CALLER'S REGISTERS            04500000
         BR    R14                                                      04510000
                                                                        04520000
         POP   USING                                                    04530000
                                                                        04540000
         EJECT ,                                                        04550000
***************************************************************         04560000
*                                                                       04570000
* Errors                                                                04580000
*                                                                       04590000
***************************************************************         04600000
                                                                        04610000
ERR_BAD_LIST DS 0H                                                      04620000
ERRSYNTX DS 0H                                                          04630000
         L     R15,=A(CCODE_SYNTAX)                                     04640000
         B     RETURN                                                   04650000
                                                                        04660000
ERRCNFLC DS 0H                                                          04670000
         L     R15,=A(CCODE_CONFLICT)                                   04680000
         B     RETURN                                                   04690000
                                                                        04700000
ERREJECT DS 0H                                                          04710000
         L     R15,=A(CCODE_REJECT)                                     04720000
         B     RETURN                                                   04730000
                                                                        04740000
RETURNOK DS 0H                                                          04750000
         SR    R15,R15                                                  04760000
         B     RETURN                                                   04770000
                                                                        04780000
RETURN   DS 0H                                                          04790000
         #EXIT                                                          04800000
         EJECT ,                                                        04810000
***************************************************************         04820000
*                                                                       04830000
* Constants                                                             04840000
*                                                                       04850000
***************************************************************         04860000
BLANKS   DC    CL(L'ICATAG)' '                                          04870000
         LTORG ,                                                        04880000
                                                                        04890000
         PRINT NOGEN                                                    04900000
         ICVT  ,                                                        04910000
         ITASK ,                                                        04920000
         IPCB  ,                                                        04930000
         END   ,                                                        04940000
