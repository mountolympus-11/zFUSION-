ILOCRGN  TITLE '- LOCATE REGION ENTRY'                                  00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ILOCRGN - LOCATE REGION ENTRY                                00040000
*                                                                       00050000
* ON ENTRY:                                                             00060000
*                                                                       00070000
*    R0 - ADDR OF SCREEN SET DESCRIPTOR (EXRGNET)                       00080000
*    R1 - ADDR OF REGION NAME                                           00090000
*                                                                       00100000
* ON EXIT:                                                              00110000
*                                                                       00120000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00130000
*                                                                       00140000
*        RC00 - REGION ENTRY LOCATED AND RETURNED VIA R1                00150000
*        RC04 - REGION NOT FOUND                                        00160000
*                                                                       00170000
**<DOC-OFF>****************************************************         00180000
                                                                        00190000
         EJECT                                                          00200000
         REGION ,                                                       00210000
                                                                        00220000
         EJECT                                                          00230000
         EXRGNET ,                                                      00240000
                                                                        00250000
         EJECT                                                          00260000
         ICATALOG REGION                                                00270000
                                                                        00280000
         EJECT                                                          00290000
         EQUS  ,                                                        00300000
                                                                        00310000
         EJECT                                                          00320000
ILOCRGN  CSECT ,                                                        00330000
ILOCRGN  AMODE 31                                                       00340000
ILOCRGN  RMODE ANY                                                      00350000
                                                                        00360000
         USING *,R15                                                    00370000
         @CPYRYT ,                                                      00380000
                                                                        00390000
         STM   R14,R12,12(R13)                                          00400000
         LR    R12,R15                                                  00410000
         USING ILOCRGN,R12                                              00420000
         DROP  R15                                                      00430000
                                                                        00440000
*--------------------------------------------------------------         00450000
*   LOCATE REGION ENTRY WITHIN GIVEN SCREEN SET DESCRIPTOR              00460000
*--------------------------------------------------------------         00470000
                                                                        00480000
         LR    R5,R0              RGN NET IDENTIFIER                    00490000
         USING EXRGNET,R5         FORMAT                                00500000
         LA    R15,RC04           ASSUME NO MATCH                       00510000
                                                                        00520000
         ICM   R2,15,EXRNTRYS     NUMBER OF REGION ENTRIES              00530000
         BNP   ILOCRXIT           FAIL IF INVALID                       00540000
         L     R7,EXRNTLST        REGION ENTRY ARRAY                    00550000
         USING RGNTRY,R7          REGION ENTRY FORMAT                   00560000
                                                                        00570000
ILOCRNXT DS    0H                                                       00580000
         L     R3,RGNSRGN         LOCATE REGION DEFINITION              00590000
         USING SYSRGN,R3          SYSRGN FORMAT                         00600000
         CLC   SRNAME,0(R1)       REGION LOCATED?                       00610000
         BE    ILOCRCPT           SUCCESS IF SO                         00620000
         LA    R7,RGNTRYLN(,R7)   ELSE TRY NEXT ONE                     00630000
         BCT   R2,ILOCRNXT        TRY ALL ENTRIES                       00640000
         B     ILOCRXIT           FAIL                                  00650000
                                                                        00660000
ILOCRCPT DS    0H                                                       00670000
         LA    R1,RGNTRY          RETURN REGION NET ENTRY               00680000
         LA    R15,RC00           INDICATE SUCCESS                      00690000
                                                                        00700000
*--------------------------------------------------------------         00710000
*   RETURN COMPLETION STATUS TO CALLER                                  00720000
*--------------------------------------------------------------         00730000
                                                                        00740000
ILOCRXIT DS    0H                                                       00750000
         L     R14,12(,R13)       RESTORE RETURN ADDRESS                00760000
         LM    R2,R12,28(R13)     RESTORE RETURN REGS                   00770000
         BR    R14                RETURN                                00780000
                                                                        00790000
         LTORG ,                                                        00800000
         END   ,                                                        00810000
