IICAINIT TITLE 'INITIALIZE EVENT COUNTER AREA'                          00010000
**<DOC-ON>******************************************************        00020000
*                                                                       00030000
* ROUTINE: IICAINIT - INITIALIZE EVENT COUNTER AREA                     00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS USED TO CONSTRUCT THE EVENT COUNTER AREA           00080000
*    USED BY $INCR TO COUNT EVENTS OF INTEREST.                         00090000
*                                                                       00100000
*                                                                       00110000
* ON ENTRY:                                                             00120000
*                                                                       00130000
*    N/A                                                                00140000
*                                                                       00150000
* ON EXIT:                                                              00160000
*                                                                       00170000
*    R15 contains zero                                                  00180000
*                                                                       00190000
**<DOC-OFF>*****************************************************        00200000
                                                                        00210000
         EJECT ,                                                        00220000
****************************************************************        00230000
*                                                                       00240000
* MAINTENANCE:                                                          00250000
*                                                                       00260000
*   05/19/94 T. WELTZER                                                 00270000
*            Initial version                                            00280000
*                                                                       00290000
*   10/31/95 R. Turgeon                                                 00300000
*            Changed "description" for run-time SQL functions           00310000
*            to their true CLI / ODBC names.                            00320000
*                                                                       00330000
****************************************************************        00340000
                                                                        00350000
         EJECT                                                          00360000
         #WORK ,                                                        00370000
WISTCK   DS    D                  INIT TIME                             00380000
         #ENDWORK ,                                                     00390000
                                                                        00400000
         EJECT                                                          00410000
         EQUS  ,                                                        00420000
                                                                        00430000
         EJECT                                                          00440000
         $INCR TYPE=DSECT                                               00450000
                                                                        00460000
         EJECT                                                          00470000
****************************************************************        00480000
IICAINIT #ENTER ,                                                       00490000
                                                                        00500000
         USING ICVT,R11           R11 --> ICVT                          00510000
*                                                                       00520000
* ACQUIRE STORAGE FOR ICA                                               00530000
*                                                                       00540000
         LH    R2,COUNT           NUMBER OF EVENTS                      00550000
         LR    R3,R2              SAVE                                  00560000
         MH    R2,=AL2(ICAELEN)   TIMES ENTRY LENGTH                    00570000
         LA    R2,ICAHLEN(,R2)    PLUS HEADER OVERHEAD                  00580000
                                                                        00590000
         STGGET (R2),QH=ICTSTG    ACQUIRE STORAGE                       00600000
                                                                        00610000
         LR    R7,R1              ALLOCATED STORAGE                     00620000
         USING ICAH,R7            R7 --> ICAH                           00630000
*                                                                       00640000
* INITIALIZE HEADER                                                     00650000
*                                                                       00660000
         MVC   ICAEYE,=C'ICA*'    EYECATCH                              00670000
         STH   R2,ICAL            LENGTH                                00680000
         STH   R3,ICAE#           NUMBER OF ENTRIES                     00690000
         STCK  WISTCK             START TIME                            00700000
         MVC   ICAIT,WISTCK                                             00710000
                                                                        00720000
         LA    R4,ICAFIRST                                              00730000
         LA    R5,ICAEORG                                               00740000
                                                                        00750000
         USING ICAE,R5            R5 --> ICAE                           00760000
         USING ICAI,R4            R4 --> ICAI                           00770000
*                                                                       00780000
* INITIALIZE ENTRIES                                                    00790000
*                                                                       00800000
INIT_ICAE DS 0H                                                         00810000
         XC    ICAE(ICAELEN),ICAE                                       00820000
         MVC   ICATAG,ICAITAG     NAME TAG                              00830000
         MVC   ICADESC,ICAIDESC   DESCRIPTION                           00840000
         MVC   ICAID,ICAIID       ID                                    00850000
         MVC   ICAATTR,ICAIATTR   ATTRIBUTES                            00860000
         MVC   ICAIS,WISTCK       INTERVAL START TIME                   00870000
         LA    R4,ICAILEN(0,R4)   NEXT ICAI                             00880000
         LA    R5,ICAELEN(0,R5)   NEXT ICAE                             00890000
         BCT   R3,INIT_ICAE       INIT ALL                              00900000
*                                                                       00910000
* ANCHOR INITIALIZED BLOCK AND RETURN TO REQUESTOR                      00920000
*                                                                       00930000
         ST    R7,ICTICTRA        ANCHOR THE BLOCK                      00940000
         SR    R15,R15            RETURN CODES UNDEFINED                00950000
         #EXIT ,                                                        00960000
                                                                        00970000
         EJECT                                                          00980000
****************************************************************        00990000
*                                                                       01000000
*   LOCAL READ-ONLY DATA AREAS                                          01010000
*                                                                       01020000
****************************************************************        01030000
                                                                        01040000
*                                                                       01050000
* ICA INITIALIZATION VALUES                                             01060000
*                                                                       01070000
ICAINIT  $INCR TYPE=START                                               01080000
                                                                        01090000
ICAFIRST $INCR ICA_SQL_STATEMENTS,TYPE=ITEM,                           +01100000
               TAG='SQLS',                                             +01110000
               DESC='SQL statements'                                    01120000
                                                                        01130000
         $INCR ICA_SQL_PREPARE,TYPE=ITEM,                              +01140000
               TAG='SQLP',                                             +01150000
               DESC='SQLPrepare()'                                      01160000
                                                                        01170000
         $INCR ICA_SQL_EXEC,TYPE=ITEM,                                 +01180000
               TAG='SQLE',                                             +01190000
               DESC='SQLExecute()'                                      01200000
                                                                        01210000
         $INCR ICA_SQL_EXEC_DIR,TYPE=ITEM,                             +01220000
               TAG='SQLD',                                             +01230000
               DESC='SQLExecDirect()'                                   01240000
                                                                        01250000
         $INCR ICA_VSESSIONS,TYPE=ITEM,                                +01260000
               TAG='VSES',                                             +01270000
               DESC='VSession establishments'                           01280000
                                                                        01290000
         $INCR ICA_VSESS_TRANS,TYPE=ITEM,                              +01300000
               TAG='VSEX',                                             +01310000
               DESC='VSession transactions'                             01320000
                                                                        01330000
COUNT    $INCR TYPE=END                                                 01340000
                                                                        01350000
         LTORG ,                                                        01360000
                                                                        01370000
         PRINT NOGEN                                                    01380000
         ICVT  ,                                                        01390000
         END   ,                                                        01400000
