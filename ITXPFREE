ITXPFREE TITLE '- FREE TXP BUFFER'                                      00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ITXPFREE - FREE TXP BUFFER                                   00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS USED TO RELEASE A TRANSACTION RESPONSE             00080000
*    BUFFER PREVIOUSLY ALLOCATED VIA ITXPINIT.                          00090000
*                                                                       00100000
*                                                                       00110000
* ON ENTRY:                                                             00120000
*                                                                       00130000
*    STDENV - NO ADDITIONAL REQUIREMENTS                                00140000
*                                                                       00150000
*                                                                       00160000
* ON EXIT:                                                              00170000
*                                                                       00180000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00190000
*                                                                       00200000
*        RC00 - NORMAL COMPLETION                                       00210000
*                                                                       00220000
**<DOC-OFF>****************************************************         00230000
                                                                        00240000
         EJECT                                                          00250000
         TXPHDR ,                 TXP BUFFER / FUNCTION ARRAY FORMAT    00260000
                                                                        00270000
         EJECT                                                          00280000
         EQUS  ,                                                        00290000
                                                                        00300000
         EJECT                                                          00310000
ITXPFREE #ENTER SAVE=NO                                                 00320000
                                                                        00330000
         USING ICVT,R11           STDENV                                00340000
         USING ITASK,R10                                                00350000
         USING IPCB,R9                                                  00360000
         L     R9,TSKPCBC         PROCESS MODE                          00370000
                                                                        00380000
*--------------------------------------------------------------         00390000
*   RELEASE TXP BUFFER AND RESTORE PROCESS (GLOBAL) INFO                00400000
*--------------------------------------------------------------         00410000
         ICM   R7,15,PCBXPBUF     TXP BUFFER PRESENT                    00420000
         BNP   FREE_FIN           DONE IF NOT                           00430000
                                                                        00440000
         $RETSTOR (R7)            RELEASE STORAGE                       00450000
                                                                        00460000
         SR    R0,R0              RESET TXP BUFFER INFO                 00470000
         ST    R0,PCBXPBUF        BUFFER PTR                            00480000
         ST    R0,PCBXPBLN        BUFFER LENGTH                         00490000
                                                                        00500000
*--------------------------------------------------------------         00510000
*   RETURN COMPLETION STATUS TO CALLER                                  00520000
*--------------------------------------------------------------         00530000
FREE_FIN DS    0H                                                       00540000
         LA    R15,RC00                                                 00550000
         #EXIT ,                                                        00560000
                                                                        00570000
         EJECT                                                          00580000
***************************************************************         00590000
*                                                                       00600000
*   LOCAL READ/ONLY STORAGE AREAS                                       00610000
*                                                                       00620000
***************************************************************         00630000
         LTORG ,                                                        00640000
                                                                        00650000
         PRINT NOGEN                                                    00660000
         ICVT  ,                                                        00670000
         ITASK ,                                                        00680000
         IPCB  ,                                                        00690000
         END   ,                                                        00700000
