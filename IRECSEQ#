IRECSEQ# TITLE '- ACQUIRE SCREEN SEQUENCE NUMBER'                       00010000
*************************************************************           00020000
*                                                                       00030000
* ROUTINE: IRECSEQ# - ACQUIRE SCREEN SEQUENCE NUMBER                    00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS USED WHEN STORING A RECORDING TO ACQUIRE           00080000
*    A BASE SCREEN IDENTIFIER/NUMBER. BECAUSE A UNIQUE SCREEN           00090000
*    NUMBER IS ASSIGNED TO EACH SCREEN SAVED IN THE ACTIVE              00100000
*    PROJECT, THE ACTUAL SCREEN NUMBER STORED CAN BE COMPUTED           00110000
*    BY ADDING THE BASE RETURNED BY THIS ROUTINE TO A RELATIVE          00120000
*    SCREEN NUMBER ASSIGNED SEQUENTIALLY TO EACH SCREEN                 00130000
*    CAPTURED.                                                          00140000
*                                                                       00150000
*                                                                       00160000
* ON ENTRY:                                                             00170000
*                                                                       00180000
*    R1  - ADDR OF IPROJ                                                00190000
*                                                                       00200000
*                                                                       00210000
* ON EXIT:                                                              00220000
*                                                                       00230000
*    R15 - RC00                                                         00240000
*    R1  - BASE SCREEN ID ( >= 0 )                                      00250000
*                                                                       00260000
***************************************************************         00270000
                                                                        00280000
         EJECT                                                          00290000
***************************************************************         00300000
*                                                                       00310000
* MAINTENANCE:                                                          00320000
*                                                                       00330000
*   12/06/94 R. Turgeon                                                 00340000
*            Removed PAGE= / SHRPAGE= for $SPACE, $OBJECT,              00350000
*            and TB* service requests                                   00360000
*                                                                       00370000
***************************************************************         00380000
                                                                        00390000
         EJECT                                                          00400000
         #WORK ,                                                        00410000
                                                                        00420000
$SYSNAV  DS    XL(SNAVLN)         SYSNAVIGATION INPUT BUFFER            00430000
                                                                        00440000
         #ENDWORK ,                                                     00450000
                                                                        00460000
         EJECT                                                          00470000
         IPROJ ,                  PROJECT CONTROL BLOCK                 00480000
                                                                        00490000
         EJECT                                                          00500000
         $TOKEN ,                 TOKEN FORMAT, REF'D IN IPROJ          00510000
                                                                        00520000
         EJECT                                                          00530000
         TBSERVIS SET,GET,PRINT=NOGEN                                   00540000
                                                                        00550000
         ICATALOG NAVIGATION                                            00560000
                                                                        00570000
         EJECT                                                          00580000
         ABCODES ,                                                      00590000
                                                                        00600000
         EQUS  ,                                                        00610000
                                                                        00620000
         EJECT ,                                                        00630000
IRECSEQ# #ENTER PREG=R8                                                 00640000
                                                                        00650000
         USING ITASK,R10          STDENV                                00660000
         USING IPROJ,R8           LIFE OF FUNCTION                      00670000
                                                                        00680000
         EJECT ,                                                        00690000
***************************************************************         00700000
*                                                                       00710000
*   SET CRP TO TOP OF SYSNAVIGATION                                     00720000
*                                                                       00730000
***************************************************************         00740000
                                                                        00750000
         TBSET POS=TOP,           ESTABLISH POSITION AT TOP OF TABLE   X00760000
               TTOKEN=PRJTKNAV,                                        X00770000
               MF=(E,MFE_LIST)                                          00780000
                                                                        00790000
         LTR   R15,R15                                                  00800000
         BNZ   ERR_TBSV                                                 00810000
                                                                        00820000
*--------------------------------------------------------------         00830000
*   SCAN ALL SYSNAVIGATION ENTRIES RETAINING HIGH SCREEN #              00840000
*--------------------------------------------------------------         00850000
         SR    R4,R4              HIGH SCREEN ID                        00860000
         LA    R5,$SYSNAV         SYSNAVIGATION BUFFER                  00870000
         USING SNAVSECT,R5                                              00880000
                                                                        00890000
NEXTNAV  DS    0H                                                       00900000
         TBGET SNAVSECT,          ACQUIRE NEXT SYSNAV ROW              X00910000
               LENGTH=SNAVLN,                                          X00920000
               POS=NEXT,                                               X00930000
               TTOKEN=PRJTKNAV,                                        X00940000
               MF=(E,MFE_LIST)                                          00950000
                                                                        00960000
         C     R15,=A(RC04)       SUCCESSFUL COMPLETION?                00970000
         BE    RET_FIN            END OF TABLE                          00980000
         BH    ERR_TBSV           TERMINATING ERROR                     00990000
                                                                        01000000
         LH    R0,SNAVLNO#        CANDIDATE EXTERNAL SCREEN NUMBER      01010000
         CR    R0,R4              EXCEEDS HIGH FOUND SO FAR?            01020000
         BNH   *+6                SKIP IF NOT                           01030000
         LR    R4,R0              RETAIN HIGH SCREEN NUMBER             01040000
         B     NEXTNAV            AGAIN                                 01050000
                                                                        01060000
*--------------------------------------------------------------         01070000
*   CLEANUP, RETURN BASE SCREEN NUMBER TO REQUESTOR                     01080000
*--------------------------------------------------------------         01090000
RET_FIN  DS    0H                                                       01100000
         LR    R1,R4              RETURN SCREEN # BASE                  01110000
         SR    R0,R0              REASON CODE UNDEFINED                 01120000
         LA    R15,RC00           RETURN CODE                           01130000
                                                                        01140000
         #EXIT ,                                                        01150000
                                                                        01160000
         EJECT                                                          01170000
***************************************************************         01180000
*                                                                       01190000
*   CATASTROPHIC FAILURES                                               01200000
*                                                                       01210000
***************************************************************         01220000
ERR_TBSV DS    0H                 CATALOG / TABLE SERVICE FAILURE       01230000
         $ABEND ABE_TBSERV,DUMP=YES,                                   X01240000
               TITLE='TABLE SERVICE FAILURE'                            01250000
                                                                        01260000
         EJECT                                                          01270000
***************************************************************         01280000
*                                                                       01290000
*   LOCAL READ-ONLY DATA AREAS, ETC.                                    01300000
*                                                                       01310000
***************************************************************         01320000
         LTORG ,                                                        01330000
                                                                        01340000
         EJECT                                                          01350000
         PRINT NOGEN                                                    01360000
         ICVT  ,                                                        01370000
         ITASK ,                                                        01380000
         END   ,                                                        01390000
