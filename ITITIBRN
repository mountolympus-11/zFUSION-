ITITIBRN TITLE 'ITITIBRN - TABLE INTERFACE BLOCK / CHANGE PROJECT'      00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: ITITIBRN - TABLE INTERFACE BLOCK / CHANGE PROJECT            00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    WHEN A PROJECT NAME CHANGES, USUALLY AS A RESULT OF A              00080000
*    PROJECT "SAVE AS" REQUEST, THE PROJECT NAME ASSOCIATION            00090000
*    MAINTAINED IN THE ACTIVE TIB CHAIN IS INVALIDATED.                 00100000
*    THIS ROUTINE IS USED TO REASSOCIATE OPEN TABLES, AS                00110000
*    REPRESENTED BY TABLE INTERFACE BLOCKS (TIB'S) WITH THE             00120000
*    NEW PROJECT NAME.                                                  00130000
*                                                                       00140000
*                                                                       00150000
* ON ENTRY:                                                             00160000
*                                                                       00170000
*    R1 - CONTAINS THE ADDRESS OF A PARAMETER LIST CONSTRUCTED          00180000
*         AS FOLLOWS:                                                   00190000
*                                                                       00200000
*         +00 - OLD PROJECT NAME                                        00210000
*         +04 - NEW PROJECT NAME                                        00220000
*                                                                       00230000
* ON EXIT:                                                              00240000
*                                                                       00250000
*    R15 CONTAINS ZERO                                                  00260000
*                                                                       00270000
**<DOC-OFF>****************************************************         00280000
                                                                        00290000
         EJECT ,                                                        00300000
***************************************************************         00310000
*                                                                       00320000
* MAINTENANCE:                                                          00330000
*                                                                       00340000
*   04/06/94  R. TURGEON                                                00350000
*             INITIAL VERSION                                           00360000
*                                                                       00370000
***************************************************************         00380000
                                                                        00390000
         EJECT                                                          00400000
         TIBLOCK ,                TABLE INTERFACE BLOCK          (TIB)  00410000
                                                                        00420000
         EJECT                                                          00430000
         EQUS  ,                  GENERAL EQUATES                       00440000
                                                                        00450000
         EJECT ,                                                        00460000
ITITIBRN #ENTER BASE=R12,PREG=R8,SAVE=NO                                00470000
                                                                        00480000
         USING ITASK,R10          ITASK ADDRESSABILITY                  00490000
                                                                        00500000
         L     R9,TSKPCBC         ADDRESS OF CURRENT PCB                00510000
         USING IPCB,R9            ADDRESSABILTY                         00520000
         L     R6,PCBUSER         USER BLOCK                            00530000
         USING IUSER,R6           IUSER ADDRESSABILITY                  00540000
                                                                        00550000
*--------------------------------------------------------------         00560000
*   RUN THE TIB CHAIN REPLACING OLD PROJ NAME WITH NEW                  00570000
*--------------------------------------------------------------         00580000
         L     R2,0(,R8)          OLD PROJ NAME ADDR                    00590000
         L     R3,4(,R8)          NEW PROJ NAME ADDR                    00600000
                                                                        00610000
         ICM   R5,15,USRTIBS      LOCATE FIRST TIB                      00620000
         BZ    RETURN             NO ACTIVE TIBS                        00630000
         USING TIBLOCK,R5                                               00640000
                                                                        00650000
NEXT_TIB DS    0H                                                       00660000
         CLC   TIBPROJ,0(R2)      TIB SELECTED?                         00670000
         BNE   *+10               SKIP IF NOT                           00680000
         MVC   TIBPROJ,0(R3)      MAKE PROJECT NAME SUBSTITUTION        00690000
         ICM   R5,15,TIBNEXT      ADVANCE TO NEXT TIB                   00700000
         BNZ   NEXT_TIB           EXAMINE ALL TIBS                      00710000
                                                                        00720000
         EJECT                                                          00730000
*--------------------------------------------------------------         00740000
*   RETURN COMPLETION STATUS TO CALLER                                  00750000
*--------------------------------------------------------------         00760000
RETURN   DS    0H                                                       00770000
         SR    R15,R15            RETURN CODE NOT DEFINED               00780000
                                                                        00790000
         #EXIT ,                  RETURN                                00800000
                                                                        00810000
         EJECT                                                          00820000
***************************************************************         00830000
*                                                                       00840000
*   LOCAL READ ONLY STORAGE                                             00850000
*                                                                       00860000
***************************************************************         00870000
         LTORG ,                                                        00880000
                                                                        00890000
         PRINT NOGEN                                                    00900000
         ICVT  ,                                                        00910000
         ITASK ,                                                        00920000
         IPCB  ,                                                        00930000
         IUSER ,                                                        00940000
         END   ,                                                        00950000
