IRTSDISC TITLE '- PREPARE FOR RUN-TIME DISCONNECT'                      00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: IRTSDISC - PREPARE FOR RUNT-TIME DISCONNECT                  00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS SCHEDULED AS THE RTSYNC.RTDISC TRANSACTION         00080000
*    PROCESSOR.  COOP ISSUES THE REQUEST TO NOTIFY THE HOST             00090000
*    THAT AN ACTIVE RUN-TIME CONNECTION (SQL COMMUNICATIONS             00100000
*    CHANNEL) IS ABOUT TO BE TERMINATED.  THIS TRANSACTION              00110000
*    PERFORMS END OF CONNECTION CLEANUP AS DESCRIBED BELOW.             00120000
*    THE COOP TREATS THIS RU AS A NOTIFICATION ONLY AND DOES            00130000
*    NOT EXPECT A RESPONSE.                                             00140000
*                                                                       00150000
* METHOD:                                                               00160000
*                                                                       00170000
*    1) IPSBDEL IS INVOKED TO DELETE ALL PREPARED STATEMENTS            00180000
*       ASSOCIATED WITH THE INDICATED CONNECTION.                       00190000
*                                                                       00200000
* ENTRY:                                                                00210000
*                                                                       00220000
*    R1  CONTAINS THE ADDRESS OF THE DISCONNECTION NOTIFICATION         00230000
*        PARAMETER LIST (XRTDISC) IN TRANSACTION FORMAT.                00240000
*                                                                       00250000
* EXIT:                                                                 00260000
*                                                                       00270000
*    R15 CONTAINS THE IPSBDEL RETURN CODE.  NO RESPONSE IS              00280000
*        SENT TO COOP.                                                  00290000
*                                                                       00300000
**<DOC-OFF>****************************************************         00310000
                                                                        00320000
         EJECT                                                          00330000
***************************************************************         00340000
*                                                                       00350000
* MAINTENANCE:                                                          00360000
*                                                                       00370000
*   04/26/94  R. TURGEON                                                00380000
*             INITIAL VERSION                                           00390000
*                                                                       00400000
***************************************************************         00410000
                                                                        00420000
         EJECT                                                          00430000
         #WORK ,                       READ/WRITE WORKAREA              00440000
         #ENDWORK ,                                                     00450000
                                                                        00460000
         EJECT                                                          00470000
         XRTDISC ,                     RUN-TIME DISCONNECT NOTIFICATION 00480000
                                                                        00490000
         EJECT                                                          00500000
         EQUS  ,                                                        00510000
                                                                        00520000
         EJECT                                                          00530000
IRTSDISC #ENTER BASE=R12,PREG=(R8)                                      00540000
                                                                        00550000
         USING ITASK,R10               ITASK ADDRESSABILITY             00560000
         L     R9,TSKPCBC              PROCESS MODE                     00570000
         USING IPCB,R9                                                  00580000
                                                                        00590000
         EJECT                                                          00600000
*--------------------------------------------------------------         00610000
*   GENERIC DELETE OF PREPARED STATMENTS ASSOC WITH CONNECTION          00620000
*--------------------------------------------------------------         00630000
         USING XRTDISC,R8              RUN-TIME DISCONNECT NOTIFICATION 00640000
                                                                        00650000
         @CALL IPSBDEL,(IPCB,*PCBUSER,XDSCHNDL,TRUE),  GENERIC DELETE  X00660000
               CTYPE=CVT,MF=(E,MFE_LIST)                                00670000
                                                                        00680000
RETURN   DS    0H                      REFLECT PSBDEL COMPLETION        00690000
         #EXIT ,                       RETURN                           00700000
                                                                        00710000
         EJECT                                                          00720000
***************************************************************         00730000
*                                                                       00740000
*   LOCAL READ ONLY STORAGE                                             00750000
*                                                                       00760000
***************************************************************         00770000
         LTORG ,                                                        00780000
                                                                        00790000
         PRINT NOGEN                                                    00800000
         ICVT  ,                                                        00810000
         ITASK ,                                                        00820000
         IPCB  ,                                                        00830000
         END   ,                                                        00840000
