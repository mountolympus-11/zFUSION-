IPRJRTA  TITLE '- PROJECT SERVICES RUN-TIME ACCESS'                     00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: IPRJRTA - PROJECT SERVICES RUN-TIME ACCESS                   00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE PROVIDES AN INTERFACE TO THE PROJECT SERVICES         00080000
*    ACCESSIBLE TO RUN-TIME REQUESTORS.  AN XPRJREQ PARAMETER           00090000
*    LIST AND THE PRJINFO RETURN AREAS ARE PREPARED AND IPRJX,          00100000
*    THE PROJECT SERVICES COMMON INTERFACE, IS INVOKED TO               00110000
*    PERFORM THE REQUESTED FUNCTION.  AN ERROR MESSAGE BLOCK IN         00120000
*    RUMSGS MAY BE RETURNED IF APPROPRIATE.                             00130000
*                                                                       00140000
*                                                                       00150000
* NOTES:                                                                00160000
*                                                                       00170000
*    NO MESSAGE BUFFER IS ALLOCATED BY THIS ROUTINE.  HOWEVER,          00180000
*    IF ERROR MESSAGES ARE RETURNED IN A DYNAMICALLY ALLOCATED          00190000
*    RUMSGS STRUCTURE VIA PRJINFO.PICOPMSG, THAT MESSAGE BUFFER         00200000
*    IS RETURNED TO THE CALLER.  IT IS THE CALLERS RESPONSIBILITY       00210000
*    TO FREE THAT AREA.                                                 00220000
*                                                                       00230000
*                                                                       00240000
* ON ENTRY:                                                             00250000
*                                                                       00260000
*    R1 - ADDRESS OF THE PROJECT NAME                                   00270000
*                                                                       00280000
*    R0 - PROJECT FUNCTION CODE, AS FOLLOWS:                            00290000
*                                                                       00300000
*         ZERO    - OPEN                                                00310000
*         NONZERO - CLOSE                                               00320000
*                                                                       00330000
*                                                                       00340000
* ON EXIT:                                                              00350000
*                                                                       00360000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00370000
*                                                                       00380000
*        RC00 - REQUEST COMPLETE                                        00390000
*                                                                       00400000
*        RCNN - REQUEST FAILED, REF IPRJX                               00410000
*                                                                       00420000
*              R1 CONTAINS THE ADDRESS OF A MESSAGE BLOCK IN            00430000
*                 RUMSGS (RU MESSAGE) FORMAT OR ZERO IF NO              00440000
*                 MESSAGES ARE AVAILABLE.  THE REQUESTOR IS             00450000
*                 REQUIRED TO $RETSTOR THE BUFFER.                      00460000
*                                                                       00470000
**<DOC-OFF>****************************************************         00480000
                                                                        00490000
         EJECT ,                                                        00500000
         #WORK ,                                                        00510000
                                                                        00520000
         EJECT                                                          00530000
         XPRJREQ DSECT=NO         PROJECT SERVICES TRANSACTION PLIST    00540000
                                                                        00550000
         EJECT                                                          00560000
         PRJINFO DSECT=NO         PROJECT INFORMATION RETURN AREA       00570000
                                                                        00580000
         #ENDWORK ,                                                     00590000
                                                                        00600000
         EJECT                                                          00610000
         EQUS  ,                                                        00620000
                                                                        00630000
         EJECT ,                                                        00640000
IPRJRTA  #ENTER PREG=(R8,R7)                                            00650000
                                                                        00660000
         USING ICVT,R11                                                 00670000
         USING ITASK,R10                                                00680000
                                                                        00690000
         EJECT ,                                                        00700000
***************************************************************         00710000
*                                                                       00720000
*   CONSTRUCT XPRJREQ AND INVOKE PROJECT SERVICES INTERFACE             00730000
*                                                                       00740000
***************************************************************         00750000
         MVC   XPJNAME,0(R8)      PROJECT NAME                          00760000
         MVI   XPJTYPE,XPJTRT     RUN-TIME REQUEST                      00770000
         OI    XPJOPTS,XPJOCNFM   CONFIMATION, IF NEEDED, IS GIVEN      00780000
                                                                        00790000
         LA    R6,PRJINFO         PROJECT INFO RETURN AREA              00800000
         USING PRJINFO,R6         LIFE OF FUNCTION ADDRESSABILITY       00810000
         ST    R6,XPJRETA         PROVIDED FOR PROJECT INTERFACE        00820000
                                                                        00830000
         LA    R0,XPJSOPEN        ASSUME A PROJECT OPEN                 00840000
         LTR   R7,R7              ASSUMPTION CORRECT?                   00850000
         BZ    *+8                SKIP IF SO                            00860000
         LA    R0,XPJSCLOS        ELSE A PROJECT CLOSE                  00870000
         ST    R0,XPJSFNC         PROJREQ SUBFUNCTION                   00880000
                                                                        00890000
         LA    R1,XPRJREQ         PROJECT TRANSACTION PLIST             00900000
         @CALL IPRJX,CTYPE=CVT    COMMON PROJECT FUNCTIONS              00910000
                                                                        00920000
*--------------------------------------------------------------         00930000
*   RETURN PROJECT SERVICES INTERFACE COMPLETION STATUS                 00940000
*--------------------------------------------------------------         00950000
         L     R1,PICOPMSG        RETURN RUMSGS ERROR DOC OR ZERO       00960000
                                                                        00970000
         #EXIT ,                                                        00980000
                                                                        00990000
         EJECT ,                                                        01000000
***************************************************************         01010000
*                                                                       01020000
*   LOCAL READ ONLY DATA AREAS, ETC.                                    01030000
*                                                                       01040000
***************************************************************         01050000
         LTORG ,                                                        01060000
                                                                        01070000
         EJECT                                                          01080000
         PRINT NOGEN                                                    01090000
         ICVT  ,                                                        01100000
         ITASK ,                                                        01110000
         END   ,                                                        01120000
