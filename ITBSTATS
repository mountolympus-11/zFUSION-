ITBSTATS TITLE 'TABLE SERVICES - TABLE STATISTICS'                      00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE:  ITBSTATS - Table services - table statistics                00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    This routine implements the facilities described by the            00080000
*    TBSTATS macro.  It provides storage utilization statistics         00090000
*    in the form of a $TBSTATS block describing the base table          00100000
*    object, its row locator object, and all associated index           00110000
*    objects when provided with a table token.                          00120000
*                                                                       00130000
*    The $TBSTATS return area is a variable length structure.           00140000
*    It can be constructed in a workarea provided by the caller         00150000
*    or an appropriate storage area can be allocated by this            00160000
*    service routine.  If allocated by the caller, the area             00170000
*    provided must be large enough to contain the entire result         00180000
*    or a warning and the required storage size is returned.            00190000
*    $STORAGE is used to allocate the result in this service if         00200000
*    requested.  Consult the macro prolog for implmentation             00210000
*    notes and a discussion of the callers storage release              00220000
*    requirements.                                                      00230000
*                                                                       00240000
*                                                                       00250000
* NOTES:                                                                00260000
*                                                                       00270000
*    This service acquires storage occupancy information from           00280000
*    the $OBJECT/$SPACE management blocks directly rather than          00290000
*    from the $OBJECT ACCESS facility used in most of table             00300000
*    services.  The LOCOIE interface provides access to more            00310000
*    of the underlying storage management info than is available        00320000
*    otherwise.                                                         00330000
*                                                                       00340000
*                                                                       00350000
* ON ENTRY:                                                             00360000
*                                                                       00370000
*    R1  contains the address of a parameter list described by          00380000
*        the @TBSTATS mapping                                           00390000
*                                                                       00400000
*                                                                       00410000
* ON EXIT:                                                              00420000
*                                                                       00430000
*    R15 contains one of the following return codes                     00440000
*    R0  may contain an associated reason code or other data            00450000
*                                                                       00460000
*        RC00 - $TBSTATS area returned.  The R0-R1 contents             00470000
*               described below are provided regardless of              00480000
*               whether the return area was allocated by the            00490000
*               caller or by this service.                              00500000
*                                                                       00510000
*               R1 - $TBSTATS block origin                              00520000
*               R0 - $TBSTATS length                                    00530000
*                                                                       00540000
*        RC04 - The return area provided by the caller is not           00550000
*               large enough to contain the result $TBSTATS             00560000
*               block, or the service routine was unable to             00570000
*               acquire the storage required.                           00580000
*                                                                       00590000
*               R0 - length of workarea required                        00600000
*                                                                       00610000
*        RC08 - reserved                                                00620000
*                                                                       00630000
*        RC12 - request in error                                        00640000
*                                                                       00650000
*               RSN04 - invalid table token supplied                    00660000
*                                                                       00670000
*        RC16 - object management error encountered                     00680000
*                                                                       00690000
*               R1 - @PUSHERR summary of service rtn failure            00700000
*                                                                       00710000
*               RSN04 - table slot locator not accessable               00720000
*               RSN08 - some index not accessable                       00730000
*               RSN12 - base table not accessable                       00740000
*                                                                       00750000
**<DOC-OFF>****************************************************         00760000
                                                                        00770000
         EJECT                                                          00780000
***************************************************************         00790000
*                                                                       00800000
* MAINTENANCE:                                                          00810000
*                                                                       00820000
*    03/25/92 R. Turgeon                                                00830000
*             Initial version                                           00840000
*                                                                       00850000
*    10/23/95 R. Turgeon                                                00860000
*             Implement the NOLOCATOR property                          00870000
*                                                                       00880000
***************************************************************         00890000
                                                                        00900000
         EJECT                                                          00910000
***************************************************************         00920000
*                                                                       00930000
*   Working storage area                                                00940000
*                                                                       00950000
***************************************************************         00960000
                                                                        00970000
WORKAREA DSECT                                                          00980000
                                                                        00990000
         @WORK ,                  STANDARD WORKAREA                     01000000
                                                                        01010000
TABLBASE DS    A                  TABLE BASE                            01020000
TABLOBJS DS    F                  # OF ALUS ASSIGNED                    01030000
TABLUSED DS    F                  AMOUNT OF STORAGE MANAGED BY TBSERV   01040000
                                                                        01050000
RLOCBASE DS    A                  LOCATOR BASE ADDR OR ZERO IF UNALLOC  01060000
RLOCOBJS DS    F                  # OF ALUS ASSIGNED                    01070000
RLOCUSED DS    F                  AMOUNT OF STORAGE MANAGED BY TBSERV   01080000
                                                                        01090000
INDXBASE DS    A                  CURRENT INDEX BASE                    01100000
INDXOBJS DS    F                  # OF ALUS ASSIGNED                    01110000
INDXUSED DS    F                  AMOUNT OF STORAGE MANAGED BY TBSERV   01120000
                                                                        01130000
CURNDXID DS    F                  TBKEYDEF SEQUENCE IS TTOKEN SEQUENCE  01140000
                                                                        01150000
WORKFREE DS    0D                 AVAILABLE TO SERVICE ROUTINES         01160000
WORKLEN  EQU   *-WORKAREA         LENGTH OF WORKAREA                    01170000
                                                                        01180000
         EJECT                                                          01190000
         @TBSTATS ,               PARAMETER LIST FORMAT                 01200000
                                                                        01210000
         EJECT                                                          01220000
         $TBSTATS ,               RESPONSE BLOCK FORMAT                 01230000
                                                                        01240000
         EJECT                                                          01250000
         $TOKEN  ,                OBJECT / SPACE TOKEN                  01260000
                                                                        01270000
         EJECT                                                          01280000
         TBTOKEN ,                TABLE TOKEN                           01290000
                                                                        01300000
         EJECT                                                          01310000
         $STG TYPE=DSECT          FREE STORAGE MGMT                     01320000
                                                                        01330000
         EJECT                                                          01340000
         @TABLE ,                 TABLE OBJECT PREFIX                   01350000
                                                                        01360000
         EJECT                                                          01370000
         @TBCOLDF ,               COLUMN DEFINITION                     01380000
                                                                        01390000
         EJECT                                                          01400000
         @TBKEYDF ,               INDEX DEFINITION                      01410000
                                                                        01420000
         EJECT                                                          01430000
         LOCATOR ,                RECORD LOCATOR ARRAY FORMAT           01440000
                                                                        01450000
         EJECT                                                          01460000
         OIE   ,                  OBJECT INDEX ENTRY                    01470000
                                                                        01480000
         EJECT                                                          01490000
         SPCBLOCK ,               OBJECT SPACE BLOCK                    01500000
                                                                        01510000
         EJECT                                                          01520000
         EQUS  LINKAGE=VCON                                             01530000
                                                                        01540000
         EJECT                                                          01550000
ITBSTATS @ENTER WORKA=(WORKAREA,WORKLEN),ASC=AR                         01560000
                                                                        01570000
         EJECT                                                          01580000
***************************************************************         01590000
*                                                                       01600000
*   Fetch request parameters, general initialization                    01610000
*                                                                       01620000
***************************************************************         01630000
                                                                        01640000
         LAM   R1,R7,MFE_LIST     PRIMARY SPACE ADDRESSING              01650000
                                                                        01660000
         LR    R7,R1              PARAMETER LIST                        01670000
         USING TBSTATS,R7         TBSTATS SERVICE                       01680000
         L     R6,TBSTTOKN        LOCATE TABLE TOKEN                    01690000
         L     R6,0(,R6)          TOKEN IS A PTR                        01700000
         USING TBTOKEN,R6         TABLE TOKEN ADDRESSABILITY LOF        01710000
         CLC   TTOKTAG,=CL8'TBTOKEN'                                    01720000
         BNE   ETBTOKEN                                                 01730000
                                                                        01740000
         EJECT                                                          01750000
***************************************************************         01760000
*                                                                       01770000
*   Acquire base table OIE and object proper                            01780000
*                                                                       01790000
***************************************************************         01800000
                                                                        01810000
         LA    R3,TTOKTABL        OBJECT $TOKEN OF BASE TABLE           01820000
         USING $TOKEN,R3          ADDRESSABILITY REQUIRED BY LOCOIE     01830000
                                                                        01840000
         L     R10,$SPCBASE       ALU0 OF TABLE SPACE                   01850000
         LAM   AR10,AR10,$ALET    AR QUALIFIED ADDRESS                  01860000
         USING SPCBLOCK,R10                                             01870000
                                                                        01880000
*-------------------------------------------------------------          01890000
*   Locate base table OIE and extract storage occupancy info            01900000
*-------------------------------------------------------------          01910000
                                                                        01920000
         LOCOIE ALUERR=ETABLOBJ   ACQUIRE ACCESS TO OIE                 01930000
                                                                        01940000
         CPYA  AR11,AR10          AR QUALIFIED TABLE OIE ADDRESS        01950000
         LR    R11,R1             PERM ADDRESSABILITY FOR TABLE         01960000
         USING OIE,R11            OBJECT INDEX ENTRY                    01970000
                                                                        01980000
         MVC   TABLOBJS,OIESTLEN  # ALUS OCCUPIED                       01990000
         MVC   TABLUSED,OIESTHWM  STORAGE (CONTIG) ACQUIRED FROM OBJECT 02000000
         DROP  R3                 $TOKEN                                02010000
                                                                        02020000
*-------------------------------------------------------------          02030000
*   Locate base table proper and validate                               02040000
*-------------------------------------------------------------          02050000
                                                                        02060000
         L     R1,OIESTORG        OBJECT ORIGIN ALU #                   02070000
                                                                        02080000
         @ALU  (R1)               CONVERT ALU NUMBER TO BASE ADDRESS    02090000
                                                                        02100000
         LR    R11,R1             AR QUALIFIED TABLE OBJECT ORIGIN      02110000
         USING TABLE,R11          TABLE BASE                            02120000
         CLC   TBLTAG,=CL8'TBTABLE'                                     02130000
         BNE   ETABLOBJ                                                 02140000
         ST    R11,TABLBASE        UNQUALIFIED TABLE BASE ADDRESS       02150000
                                                                        02160000
         EJECT                                                          02170000
***************************************************************         02180000
*                                                                       02190000
*   Acquire row locator OIE and object proper, if allocated             02200000
*                                                                       02210000
***************************************************************         02220000
                                                                        02230000
         TM    TBLPROP1,TBLP_NOLOCATOR                                  02240000
         BO    NOROWLOC           ROW LOCATOR NOT IN USE                02250000
                                                                        02260000
         LA    R3,TTOKLOCR        OBJECT $TOKEN OF BASE TABLE           02270000
         USING $TOKEN,R3          ADDRESSABILITY REQUIRED BY LOCOIE     02280000
                                                                        02290000
*-------------------------------------------------------------          02300000
*   Locate row locator OIE and extract storage occupancy info           02310000
*-------------------------------------------------------------          02320000
                                                                        02330000
         LOCOIE ALUERR=ELOCROBJ   ACQUIRE ACCESS TO OIE                 02340000
                                                                        02350000
         CPYA  AR8,AR10           AR QUALIFIED LOCATOR OIE ADDRESS      02360000
         LR    R8,R1              ADDRESSABILITY FOR LOCATOR            02370000
         USING OIE,R8             OBJECT INDEX ENTRY                    02380000
                                                                        02390000
         MVC   RLOCOBJS,OIESTLEN  # ALUS OCCUPIED                       02400000
         MVC   RLOCUSED,OIESTHWM  STORAGE (CONTIG) ACQUIRED FROM OBJECT 02410000
         DROP  R3                 $TOKEN                                02420000
                                                                        02430000
*-------------------------------------------------------------          02440000
*   Locate row locator proper and validate                              02450000
*-------------------------------------------------------------          02460000
                                                                        02470000
         L     R1,OIESTORG        OBJECT ORIGIN ALU #                   02480000
                                                                        02490000
         @ALU  (R1)               CONVERT ALU NUMBER TO BASE ADDRESS    02500000
                                                                        02510000
         LR    R8,R1              AR QUALIFIED TABLE OBJECT ORIGIN      02520000
         USING LOCATOR,R8         LOCATOR BASE                          02530000
         CLC   LOCTAG,=CL8'LOCATOR'                                     02540000
         BNE   ELOCROBJ                                                 02550000
         ST    R8,RLOCBASE        SAVE UNQUALIFIED BASE ADDRESS         02560000
         DROP  R8                 LOCATOR                               02570000
                                                                        02580000
NOROWLOC DS    0H                                                       02590000
                                                                        02600000
         EJECT                                                          02610000
***************************************************************         02620000
*                                                                       02630000
*   Determine $TBSTATS resp block size - validate or allocate           02640000
*                                                                       02650000
***************************************************************         02660000
                                                                        02670000
         USING $TBSTATS,R5        RETURN AREA FORMAT - INTENTIONS       02680000
                                                                        02690000
         L     R2,TBL#KEYS        NUMBER OF TABLE KEYS / INDEXES        02700000
         MH    R2,=AL2($TBST_NDX_LEN)   COMPUTE LENGTH OF INDEX SECTION 02710000
         LA    R2,$TBST_FIX_LEN(,R2)    TOTAL LENGTH REQUIREMENT        02720000
                                                                        02730000
         ICM   R5,15,TBSTRETA     RETURN AREA PROVIDED BY CALLER?       02740000
         BZ    ALLOC              ALLOCATE LOCALLY IF NOT               02750000
         CL    R2,TBSTRETL        RETURN AREA LARGE ENOUGH?             02760000
         BH    ERR_RETA           FAIL OTHERWISE                        02770000
                                                                        02780000
         LAE   R14,0(R5,0)        CLEAR THE PREALLOCATED RETURN AREA    02790000
         LR    R15,R2                                                   02800000
         SR    R1,R1                                                    02810000
         MVCL  R14,R0                                                   02820000
         B     INITRESP                                                 02830000
                                                                        02840000
*--------------------------------------------------------------         02850000
*   Return area allocated by this service                               02860000
*--------------------------------------------------------------         02870000
                                                                        02880000
ALLOC    DS    0H                                                       02890000
         $STORAGE OBTAIN,LENGTH=(R2),COND=YES,LOC=ANY                   02900000
                                                                        02910000
         LTR   R15,R15            CLEAR STORAGE ACQUIRED?               02920000
         BNZ   ERR_RETA           FAIL OTHERWISE                        02930000
                                                                        02940000
         LR    R5,R1              STD ADDRESSABILITY TO RESPONSE AREA   02950000
                                                                        02960000
*--------------------------------------------------------------         02970000
*   Common $TBSTATS return area initialization                          02980000
*--------------------------------------------------------------         02990000
                                                                        03000000
INITRESP DS    0H                                                       03010000
         MVC   $TBST_CBID,=CL8'$TBSTATS'                                03020000
         ST    R2,$TBST_CBLEN     CONTROL BLOCK LENGTH                  03030000
                                                                        03040000
         MVC   $TBST_TAB_NAME,TBLNAME                                   03050000
         MVC   $TBST_PFX_SZ,TBLPFXSZ                                    03060000
         MVC   $TBST_ROW_SZ,TBLROWSZ                                    03070000
         MVC   $TBST_ROW_CNT,TBLROWS                                    03080000
         MVC   $TBST_COL_CNT,TBL#COLS                                   03090000
         MVC   $TBST_TNDX_CNT,TBL#KEYS                                  03100000
                                                                        03110000
         MVC   $TBST_BASE_USE,TABLUSED                                  03120000
         MVC   $TBST_LOC_USE,RLOCUSED                                   03130000
                                                                        03140000
         L     R15,SPC_ALU_POWER2 CONVERSION FACTOR FOR ALU SIZE        03150000
                                                                        03160000
         L     R3,TABLOBJS        BASE TABLE OBJECT ALU COUNT           03170000
         SLL   R3,0(R15)          CONVERT TO SIZE                       03180000
         ST    R3,$TBST_BASE_OBJ                                        03190000
                                                                        03200000
         L     R3,RLOCOBJS        LOCATOR OBJECT ALU COUNT              03210000
         SLL   R3,0(R15)          CONVERT TO SIZE                       03220000
         ST    R3,$TBST_LOC_OBJ                                         03230000
                                                                        03240000
         EJECT                                                          03250000
***************************************************************         03260000
*                                                                       03270000
*   Scan all index objects gathering single and accum stats             03280000
*                                                                       03290000
***************************************************************         03300000
                                                                        03310000
         LA    R4,$TBST_NDX       ORIGIN OF $TBSTATS INDEX SECTION      03320000
         USING $TBST_NDX,R4       TIGHTEN UP THE ADDRESSABILITY         03330000
                                                                        03340000
         LAE   R9,TBLKYLST-(TBKLINK-TBKEYDEF)                           03350000
         USING TBKEYDEF,R9        TBKEYDEF ENTRY                        03360000
                                                                        03370000
*--------------------------------------------------------------         03380000
*   Locate next index definition                                        03390000
*--------------------------------------------------------------         03400000
                                                                        03410000
SCANDX   DS    0H                                                       03420000
         ICM   R9,15,TBKLINK      ADVANCE TO NEXT INDEX DEFINITION      03430000
         BZ    FINDX              DONE AT END OF LIST                   03440000
         LA    R9,TABLE(R9)       CONVERT OFFLINK TO ADDRESS            03450000
                                                                        03460000
         MVC   $TBST_NDX_NAME,TBKEYNAM  INDEX NAME                      03470000
         MVC   $TBST_NDX_NAMX,BLANKS    PREPARE FOR FUTURE EXPANSION    03480000
                                                                        03490000
         LH    R0,TBKCOUNT        NUMBER OF COLUMNS SPANNED BY INDEX    03500000
         ST    R0,$TBST_NDX_COLS                                        03510000
                                                                        03520000
         L     R1,CURNDXID        ID NUMBER OF CURRENT INDEX            03530000
         LA    R0,1(,R1)          RELATIVE TO ONE                       03540000
         ST    R0,CURNDXID        RETAIN FOR NEXT PASS                  03550000
                                                                        03560000
         MH    R1,=AL2($TOKLN)    OFFSET TO NTH TOKEN                   03570000
         LA    R3,TTOKNDX(R1)     ACQUIRE PTR TO INDEX OBJECT TOKEN     03580000
         USING $TOKEN,R3          ADDRESSABILITY REQUIRED FOR LOCOIE    03590000
                                                                        03600000
*--------------------------------------------------------------         03610000
*   Locate index OIE and extract storage occupancy info                 03620000
*--------------------------------------------------------------         03630000
                                                                        03640000
         LOCOIE ALUERR=ENDXLOC    ACQUIRE ACCESS TO OIE                 03650000
                                                                        03660000
         CPYA  AR8,AR10           AR QUALIFIED LOCATOR OIE ADDRESS      03670000
         LR    R8,R1              ADDRESSABILITY FOR LOCATOR            03680000
         USING OIE,R8             OBJECT INDEX ENTRY                    03690000
                                                                        03700000
         MVC   INDXOBJS,OIESTLEN  # ALUS OCCUPIED                       03710000
         MVC   INDXUSED,OIESTHWM  STORAGE (CONTIG) ACQUIRED FROM OBJECT 03720000
         DROP  R3                 $TOKEN                                03730000
                                                                        03740000
*--------------------------------------------------------------         03750000
*   Locate index and validate                                           03760000
*--------------------------------------------------------------         03770000
                                                                        03780000
         L     R1,OIESTORG        OBJECT ORIGIN ALU #                   03790000
                                                                        03800000
         @ALU  (R1)               CONVERT ALU NUMBER TO BASE ADDRESS    03810000
                                                                        03820000
         LR    R8,R1              AR QUALIFIED TABLE OBJECT ORIGIN      03830000
         USING LOCATOR,R8         LOCATOR BASE                          03840000
         CLC   LOCTAG,=CL8'LOCATOR'                                     03850000
         BNE   ENDXLOC                                                  03860000
         ST    R8,INDXBASE        SAVE UNQUALIFIED BASE ADDRESS         03870000
                                                                        03880000
*--------------------------------------------------------------         03890000
*   Extract index stats, post individual and accum stats                03900000
*--------------------------------------------------------------         03910000
                                                                        03920000
         L     R2,INDXOBJS        INDEX OBJECT ALU COUNT                03930000
         L     R15,SPC_ALU_POWER2 CONVERSION FACTOR FOR ALU SIZE        03940000
         SLL   R2,0(R15)          CONVERT TO SIZE                       03950000
         ST    R2,$TBST_NDX_OBJ   INDEX OBJECT SIZE                     03960000
         AL    R2,$TBST_TNDX_OBJ  ACCUMULATE FOR ALL INDECIES           03970000
         ST    R2,$TBST_TNDX_OBJ  SAVE UPDATED VALUE                    03980000
                                                                        03990000
         L     R3,INDXUSED        STORAGE ACQUIRED FROM OBJECT          04000000
         ST    R3,$TBST_NDX_USE   INDEX STORAGE USED                    04010000
         AL    R3,$TBST_TNDX_USE  ACCUMULATE FOR ALL INDECIES           04020000
         ST    R3,$TBST_TNDX_USE  SAVE UPDATED VALUE                    04030000
                                                                        04040000
         L     R0,=F'-1'          ASSUME IN-USE COUNT NOT AVAILABLE     04050000
         ICM   R1,15,LOCINUSE     NUMBER OF SLOTS IN USE                04060000
         BZ    *+8                SKIP IF INFO NOT MAINTAINED           04070000
         LA    R0,0(,R1)          REMOVE FLAG BIT                       04080000
         ST    R0,$TBST_NDX_ACT   POST ACTIVE ENTRY COUNT               04090000
                                                                        04100000
         ICM   R1,15,$TBST_TNDX_ACT                                     04110000
         BM    ADVNDX             INDEX ACTIVE ENTRY COUNTER INVALID    04120000
         LTR   R0,R0              ACTIVE ENTRY COUNT AVAILABLE?         04130000
         BM    *+8                SKIP IF NOT                           04140000
         AL    R0,$TBST_TNDX_ACT  ELSE ROLL INTO TOTAL FOR ALL INDECIES 04150000
         ST    R0,$TBST_TNDX_ACT  SAVE UPDATED VALUE                    04160000
                                                                        04170000
*--------------------------------------------------------------         04180000
*   Process all indecies associated with the base table                 04190000
*--------------------------------------------------------------         04200000
                                                                        04210000
ADVNDX   DS    0H                                                       04220000
         LA    R4,$TBST_NDX+$TBST_NDX_LEN                               04230000
         B     SCANDX                                                   04240000
                                                                        04250000
FINDX    DS    0H                 ALL INDECIES PROCESSED                04260000
         DROP  R4,R8,R9           $TBSTATS INDEX ENTRY, INDEX, TBKEYDEF 04270000
                                                                        04280000
         EJECT                                                          04290000
***************************************************************         04300000
*                                                                       04310000
*   Prepare $TBSTATS statistics block and/or status to caller           04320000
*                                                                       04330000
***************************************************************         04340000
                                                                        04350000
         L     R2,$TBST_BASE_OBJ  SIZE OF BASE TABLE OBJECT             04360000
         AL    R2,$TBST_LOC_OBJ   PLUS SIZE OF BASE TABLE ROW LOCATOR   04370000
         AL    R2,$TBST_TNDX_OBJ  PLUS SIZE OF ALL INDEX OBJECTS        04380000
         ST    R2,$TBST_TOTL_OBJ  TOTAL COMMITTED OBJECT STORAGE        04390000
                                                                        04400000
         L     R3,$TBST_BASE_USE  BASE TABLE STORAGE USED               04410000
         AL    R3,$TBST_LOC_USE   PLUS BASE TABLE ROW LOCATOR STG USED  04420000
         AL    R3,$TBST_TNDX_USE  PLUS ALL INDEX OBJECTS STG USED       04430000
         ST    R3,$TBST_TOTL_USE  TOTAL STORAGE USED                    04440000
                                                                        04450000
         LA    R15,RC00           FUNCTION COMPLETE                     04460000
         LA    R1,$TBSTATS        $TBSTATS RESPONSE BLOCK ORIGIN        04470000
         L     R0,$TBST_CBLEN     $TBSTATS RESPONSE BLOCK LENGTH        04480000
         B     STAT_RET                                                 04490000
                                                                        04500000
*--------------------------------------------------------------         04510000
*   Warnings                                                            04520000
*--------------------------------------------------------------         04530000
                                                                        04540000
ERR_RETA DS    0H                 R0 <== STORAGE LENGTH REQUIRED        04550000
         LA    R15,RC04                                                 04560000
         LR    R0,R2              $TBSTATS LENGTH                       04570000
         SR    R1,R1              STATS NOT RETURNED                    04580000
         B     STAT_RET                                                 04590000
                                                                        04600000
*--------------------------------------------------------------         04610000
*   Logical request errors                                              04620000
*--------------------------------------------------------------         04630000
                                                                        04640000
ETBTOKEN DS    0H                 INVALID TABLE TOKEN SUPPLIED          04650000
         LA    R0,RSN04                                                 04660000
                                                                        04670000
ERR_REQ  DS    0H                 REQUEST IN ERROR                      04680000
         LA    R15,RC12                                                 04690000
         SR    R1,R1              STATS NOT RETURNED                    04700000
         B     STAT_RET                                                 04710000
                                                                        04720000
*--------------------------------------------------------------         04730000
*   Object management errors                                            04740000
*--------------------------------------------------------------         04750000
                                                                        04760000
ELOCROBJ DS    0H                 COULD NOT ACCESS LOCATOR              04770000
         LA    R2,RSN04                                                 04780000
         B     ERR_OBJ                                                  04790000
                                                                        04800000
ENDXLOC  DS    0H                 COULD NOT ACCESS INDEX                04810000
         LA    R2,RSN08                                                 04820000
         B     ERR_OBJ                                                  04830000
                                                                        04840000
ETABLOBJ DS    0H                 COULD NOT ACCESS BASE TABLE           04850000
         LA    R2,RSN12                                                 04860000
                                                                        04870000
ERR_OBJ  DS    0H                 OBJECT FALURE                         04880000
                                                                        04890000
         @PUSHERR ,               PRESERVE SERVICE ROUTINE STATUS       04900000
                                                                        04910000
         LR    R0,R2              ASSERT LOCAL REASON CODE              04920000
         LA    R15,RC16                                                 04930000
         B     STAT_RET                                                 04940000
                                                                        04950000
         EJECT                                                          04960000
***************************************************************         04970000
*                                                                       04980000
*   Return to caller                                                    04990000
*                                                                       05000000
***************************************************************         05010000
                                                                        05020000
STAT_RET DS    0H                                                       05030000
         SR    R2,R2                                                    05040000
         SAR   AR0,R2                                                   05050000
         SAR   AR1,R2                                                   05060000
         SAR   AR14,R2                                                  05070000
         SAR   AR15,R2                                                  05080000
                                                                        05090000
         @EXIT ,                                                        05100000
                                                                        05110000
         DROP  R5                 $TBSTATS BLOCK                        05120000
                                                                        05130000
         EJECT                                                          05140000
***************************************************************         05150000
*                                                                       05160000
*   Local read-only data areas, etc.                                    05170000
*                                                                       05180000
***************************************************************         05190000
                                                                        05200000
BLANKS   DC    CL32' '                                                  05210000
                                                                        05220000
         LTORG ,                                                        05230000
         END   ,                                                        05240000
