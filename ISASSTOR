ISASSTOR TITLE '- SAS/C STORAGE ALLOCATION'                             00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE:                                                              00040000
*   ISASSTOR - SAS/C HEAP ALLOCATION                                    00050000
*                                                                       00060000
* DESCRIPTION:                                                          00070000
*   A HEAP                                                              00080000
*                                                                       00090000
**<DOC-OFF>****************************************************         00100000
         EJECT ,                                                        00110000
         EQUS  ,                  GENERAL EQUATES                       00120000
                                                                        00130000
         EJECT ,                                                        00140000
         COPY  CRAB               "C"  RUNTIME ANCHOR BLOCK             00150000
         USING CRAB,R12           LIFETIME ADDRESSABILITY               00160000
                                                                        00170000
         EJECT ,                                                        00180000
*********************************************************************** 00190000
*                                                                       00200000
* DYNAMIC SAVE AREA                                                     00210000
*                                                                       00220000
*********************************************************************** 00230000
         COPY  DSA                                                      00240000
WORKAREA DS    0D                  USER DSA AREA                        00250000
MFE_LIST DS    10F                                                      00260000
                                                                        00270000
WORKLEN  EQU   *-WORKAREA          USER DSA AREA LENGTH                 00280000
DSALEN   EQU   *-DSA               LENGTH OF DSA                        00290000
         EJECT ,                                                        00300000
*---------------------------------------------------------------------- 00310000
* FUNCTION: VOID * GETSTOR(LONG SIZE)                                   00320000
*   ALLOCATE INTEGRATOR CONTROLLED STORAGE                              00330000
*   (ALLOCATE A HEAP FOR MALLOC SUBALLOCATIONS)                         00340000
*                                                                       00350000
* ENTRY:                                                                00360000
*   R1 CONTAINS ADDR OF PARAMETER LIST                                  00370000
*                                                                       00380000
*   +0 - SIZE OF STORAGE TO ALLOCATE                                    00390000
*                                                                       00400000
* EXIT:                                                                 00410000
*   VOID * - POINTER TO ALLOCATED HEAP                                  00420000
*---------------------------------------------------------------------- 00430000
                                                                        00440000
ISASSTOR CSECT ,                                                        00450000
GETSTOR  CENTRY DSA=DSALEN                                              00460000
         LR    R7,R1              PROTECT PARM ADDRESS                  00470000
                                                                        00480000
         L     R11,CRABUSR1       R11 --> ICVT                          00490000
         USING ICVT,R11                                                 00500000
         USING DSA,R13            DYNAMIC STORAGE AREA                  00510000
                                                                        00520000
         L     R1,0(,R7)          GET SIZE PARM                         00530000
         $GETSTOR (R1)            ALLOCATE STORAGE                      00540000
                                                                        00550000
         LR    R15,R1                                                   00560000
         CEXIT RC=(R15)           RETURN HEAP POINTER                   00570000
         LTORG ,                                                        00580000
         DROP  R13                                                      00590000
         DROP  R11                                                      00600000
                                                                        00610000
         PRINT NOGEN                                                    00620000
         ICVT  ,                                                        00630000
         PRINT GEN                                                      00640000
                                                                        00650000
         END   ,                                                        00660000
