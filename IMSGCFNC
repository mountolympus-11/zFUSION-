IMSGCFNC TITLE 'MESSAGE SERVICE C-LANGUAGE INTERFACE'                   00010000
**<DOC-ON>******************************************************        00020000
*                                                                       00030000
* ROUTINE:  IMSGCFNC - MESSAGE SERVICES C-LANGUAGE INTERFACE'           00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*   THIS ROUTINE WILL BRIDGE C-LANGUAGE ROUTINES TO                     00080000
*   $MSG (MESSAGING) SERVICES.  FUNCTIONS ARE PROVIDED                  00090000
*   TO SET MESSAGE DEFAULT ATTRIBUTES AND ISSUE MESSAGES.               00100000
*                                                                       00110000
* FUNCTIONS:                                                            00120000
*                                                                       00130000
*   MSGDFT  - SET DEFAULT MESSAGE ATTRIBUTES                            00140000
*   MSG     - REQUEST MESSAGE SERVICES                                  00150000
*   MSGATTR - RETURN MESSAGE CLASS ATTRIBUTES (ACTIVE OR INACTIVE)      00160000
*                                                                       00170000
* ON ENTRY:                                                             00180000
*                                                                       00190000
*   R1 CONTAINS THE ADDRESS OF THE PARAMETER LIST FOLLOWING             00200000
*   THE SAS/C STANDARD LINKAGE CONVENTIONS.                             00210000
*                                                                       00220000
* ON EXIT:                                                              00230000
*                                                                       00240000
*   R15 CONTAINS THE RETURN CODE FROM THE $MSG SERVICE                  00250000
*   REQUESTED.                                                          00260000
*                                                                       00270000
**<DOC-OFF>*****************************************************        00280000
                                                                        00290000
         EJECT ,                                                        00300000
****************************************************************        00310000
*                                                                       00320000
* MAINTENANCE:                                                          00330000
*                                                                       00340000
*   06/03/93 RON COLMONE                                                00350000
*            INITIAL VERSION                                            00360000
*                                                                       00370000
****************************************************************        00380000
         EJECT ,                                                        00390000
         $MREQB ,                 MESSAGE REQUEST BLOCK                 00400000
                                                                        00410000
         EJECT ,                                                        00420000
         EQUS  ,                  GENERAL EQUATES                       00430000
                                                                        00440000
         EJECT ,                                                        00450000
****************************************************************        00460000
*                                                                       00470000
* MAPPING: $MDFTPL - MESSAGE DEFAULT PARAMETER LIST                     00480000
*                                                                       00490000
****************************************************************        00500000
$MDFTPL  DSECT ,                                                        00510000
$MDFHNDL DS    A                  ADDR OF MESSAGE HANDLE                00520000
$MDFPFX  DS    A                  ADDR OF MESSAGE PREFIX                00530000
$MDFCMP  DS    A                  ADDR OF MESSAGE COMPONENT             00540000
$MDFMSGT DS    A                  ADDR OF MESSAGE TABLE                 00550000
$MDFDEST DS    F                  DESTINATION MASK                      00560000
$MDFCNID DS    F                  CONSOLE ID                            00570000
$MDFBUFA DS    A                  ADDR OF MESSAGE BUFFER                00580000
$MDFBUFL DS    F                  LEN  OF MESSAGE BUFFER                00590000
$MDFSUPR DS    F                  SUPPRESS MESSAGE ID                   00600000
$MDFDADD DS    F                  ADDITIONAL DESTINATION MASK           00610000
$MDFCNAM DS    A                  MCS CONSOLE NAME                      00620000
$MDFCART DS    A                  MCS COMMAND RESPONSE TOKEN            00630000
$MDFMSGQ DS    A                  MESSAGE QUEUE ANCHOR ADDRESS          00640000
$MDFSTGH DS    A                  STGMGR STORAGE QUEUE HEADER           00650000
$MDFPLN  EQU   *-$MDFTPL          LENGTH OF MSGDFT PLIST                00660000
                                                                        00670000
#MAXFLDS EQU   16                 MAXIMUM NUMBER OF SUB ELEMS           00680000
                                                                        00690000
         EJECT ,                                                        00700000
         COPY  CRAB               "C"  RUNTIME ANCHOR BLOCK             00710000
         USING CRAB,R12           LIFETIME ADDRESSABILITY               00720000
                                                                        00730000
         EJECT ,                                                        00740000
         COPY  DSA                DYNAMIC SAVE AREA                     00750000
PARMS    DS    10F                STANDARD PLIST                        00760000
DSALEN   EQU   *-DSA              LENGTH OF DSA                         00770000
                                                                        00780000
         EJECT ,                                                        00790000
**<DOC-ON>******************************************************        00800000
*                                                                       00810000
* FUNCTION: MSGDFT  - MESSAGE DEFAULT ATTRIBUTES                        00820000
*                                                                       00830000
* DESCRIPTION:                                                          00840000
*                                                                       00850000
*    THIS ROUTINE WILL INITIALIZE THE MESSAGE HANDLE ($MREQB)           00860000
*    FOR A C-LANGUAGE MSG CALLER.  THIS SERVICE PROVIDES THE            00870000
*    ABILITY FOR A C PROGRAM TO UTILIZE THE MSG FORMATING               00880000
*    AND ROUTING SERVICES PROVIDES BY THE STANDARD MSG FACILITY.        00890000
*                                                                       00900000
*    UNLIKE THE ASSEMBLER $MSG MACRO,  DEFAULT VALUES MAY NOT           00910000
*    BE OVERRIDEN ON THE MSG FUNCTION CALL.  THEREFORE THIS             00920000
*    FUNCTION (MSGDFT) IS PROVIDED TO BUILD THE $MSG PARAMETER          00930000
*    LIST.  TO OVERRIDE MSG PARAMETERS,  SIMPLY REISSUE THE             00940000
*    MSGDFT SERVICE WITH THE NEW PARAMETER VALUES.  SEVERAL OF          00950000
*    THE PARAMETERS PASSED TO THIS SERVICE ALLOW DEFAULT VALUE          00960000
*    REFERENCES BY USING THE "MSGDEFAULT" VALUE.  REFER TO THE          00970000
*    ENTRY PARAMETER LIST TO DETERMINE WHICH OPERANDS MAY               00980000
*    ASSUME A DEFAULT VALUE, AND IF THE DEFAULT IS A MESSAGE            00990000
*    INTERNAL DEFAULT OR A DEFAULT VALUE OBTAINED FROM THE              01000000
*    ICVT.                                                              01010000
*                                                                       01020000
*                                                                       01030000
* ENTRY:    R1 CONTAINS ADDR OF FOLLOWING PARAMETER LIST                01040000
*              MAPPED BY $MDFTPL                                        01050000
*                                                                       01060000
*               +00  - ADDR OF MESSAGE HANDLE ($MREQB)                  01070000
*               +04  - ADDR OF PREFIX    STRING (0 FOR CVT DEFAULT)     01080000
*               +08  - ADDR OF COMPONENT STRING                         01090000
*               +0C  - ADDR OF MESSAGE TABLE    (0 FOR CVT DEFAULT)     01100000
*               +10  - DESTINATION MASK         (0 FOR MSG DEFAULT)     01110000
*               +14  - CONSOLE ID               (0 FOR CVT DEFAULT)     01120000
*               +18  - MSG CONSTRUCTION AREA    (0 FOR MSG DEFAULT)     01130000
*               +1C  - MSG CONSTRUCTION AREALEN (0 FOR MSG DEFAULT)     01140000
*               +20  - SUPPRESS MESSAGE ID IF TRUE                      01150000
*                                                                       01160000
* EXIT:     R15 CONTAINS RETURN VALUS AS FOLLOWS:                       01170000
*                                                                       01180000
*               RC00 - DEFAULT VALUES ASSIGNED                          01190000
*               RC04 - INVALID MESSAGE HANDLE                           01200000
*                                                                       01210000
**<DOC-OFF>*****************************************************        01220000
                                                                        01230000
IMSGCFNC CSECT ,                                                        01240000
MSGDFT   CENTRY DSA=DSALEN                                              01250000
         USING DSA,R13            ADDRESSABILITY                        01260000
                                                                        01270000
         LR    R8,R1              ADDRESS OF PASSED PARMS               01280000
         USING $MDFTPL,R8         ADDRESSABILITY                        01290000
                                                                        01300000
*---------------------------------------------------------------        01310000
*  RESTORE STANDARD ENVIRONMENT                                         01320000
*---------------------------------------------------------------        01330000
         @RESTENV ,                                                     01340000
         USING ICVT,R11           ADDRESSABILITY                        01350000
         USING ITASK,R10          ADDRESSABILITY                        01360000
                                                                        01370000
         ICM   R7,15,$MDFHNDL     ADDR OF MESSAGE HANDLE                01380000
         BZ    MDF_RC04           NONE, ERROR                           01390000
         USING $MREQB,R7          ADDRESSABILITY                        01400000
                                                                        01410000
         XC    $MREQB($MREQBL2),$MREQB  INITIALIZE MSG REQ BLOCK        01420000
         MVI   $MRBVER,$MRBVERX         HIGHEST SERVICE LEVEL           01430000
                                                                        01440000
         EJECT ,                                                        01450000
*---------------------------------------------------------------        01460000
* MESSAGE PREFIX STRING                                                 01470000
*---------------------------------------------------------------        01480000
MDF_PFX  DS    0H                                                       01490000
         ICM   R1,15,$MDFPFX      ADDRESS OF PREFIX STRING              01500000
         BZ    DFT_PFX            ZERO, USE ICVT DEFAULT PREFIX         01510000
                                                                        01520000
         ST    R1,$MRBPFXA        SAVE IN MESSAGE REQ BLOCK             01530000
         ST    R1,PARMS           ADDRESS OF STRING                     01540000
                                                                        01550000
         LA    R1,PARMS           ADDRESS OF PLIST                      01560000
         L     R15,=V(STRLEN)     ADDRESS OF STRLEN RTN                 01570000
         BALR  R14,R15            CALC LENGTH OF PREFIX STRING          01580000
         ST    R15,$MRBPFXL       SAVE IN MESSAGE REQ BLOCK             01590000
         B     MDF_CMP            PROCESS COMPONENT                     01600000
                                                                        01610000
DFT_PFX  DS    0H                                                       01620000
         LA    R1,ICTPID          ADDRESS OF MESSAGE PREFIX             01630000
         ST    R1,$MRBPFXA        SAVE IN MESSAGE REQ BLOCK             01640000
         LA    R1,L'ICTPID        LENGTH  OF MESSAGE PREFIX             01650000
         ST    R1,$MRBPFXL        SAVE IN MESSAGE REQ BLOCK             01660000
                                                                        01670000
*---------------------------------------------------------------        01680000
* MESSAGE COMPONENT STRING                                              01690000
*---------------------------------------------------------------        01700000
MDF_CMP  DS    0H                                                       01710000
         ICM   R1,15,$MDFCMP      ADDRESS OF COMMONENT STRING           01720000
         BZ    MDF_MSGT           NONE, CONTINUE                        01730000
                                                                        01740000
         ST    R1,$MRBCMPA        SAVE IN MESSAGE REQ BLOCK             01750000
         ST    R1,PARMS           ADDRESS OF STRING                     01760000
                                                                        01770000
         LA    R1,PARMS           ADDRESS OF PLIST                      01780000
         L     R15,=V(STRLEN)     ADDRESS OF STRLEN RTN                 01790000
         BALR  R14,R15            CALC LENGTH OF PREFIX STRING          01800000
         ST    R15,$MRBCMPL       SAVE IN MESSAGE REQ BLOCK             01810000
                                                                        01820000
*---------------------------------------------------------------        01830000
* MESSAGE TABLE ADDRESS                                                 01840000
*---------------------------------------------------------------        01850000
MDF_MSGT DS    0H                                                       01860000
         ICM   R1,15,$MDFMSGT     ADDRESS OF MESSAGE TABLE              01870000
         BNZ   *+8                MESSAGE TABLE SUPPLIED                01880000
         L     R1,#MSGS           USE DEFAULT MESSAGE TABLE             01890000
         ST    R1,$MRBTABL        SAVE IN MESSAGE REQ BLOCK             01900000
                                                                        01910000
*---------------------------------------------------------------        01920000
* MESSAGE DESTINATION MASK                                              01930000
*---------------------------------------------------------------        01940000
MDF_DEST DS    0H                                                       01950000
         L     R1,$MDFDEST        MESSAGE DESTINATION MASK              01960000
         ST    R1,$MRBDEST        SAVE IN MESSAGE REQ BLOCK             01970000
                                                                        01980000
*---------------------------------------------------------------        01990000
* ADDITIONAL DESTINATION MASK ADDRESS                                   02000000
*---------------------------------------------------------------        02010000
MDF_DADD DS    0H                                                       02020000
         ICM   R1,15,$MDFDADD     DESTINSTION CONSOLE ID                02030000
         BZ    MDF_CNID           NONE, USE STARTING CONSOLE            02040000
         ST    R1,$MRBADDS        SAVE IN MESSAGE REQ BLOCK             02050000
                                                                        02060000
*---------------------------------------------------------------        02070000
* DESTINATION CONSOLE ID                                                02080000
*---------------------------------------------------------------        02090000
MDF_CNID DS    0H                                                       02100000
         ICM   R1,15,$MDFCNID     DESTINSTION CONSOLE ID                02110000
         BZ    DFT_CNID           NONE, USE STARTING CONSOLE            02120000
         ST    R1,$MRBCNID        SAVE IN MESSAGE REQ BLOCK             02130000
         B     MDF_BUFF           PROCESS BUFFER ADDRESS                02140000
                                                                        02150000
DFT_CNID DS    0H                                                       02160000
         L     R1,ICTCONID        USE STARTING CONSOLE ID               02170000
         ST    R1,$MRBCNID        SAVE IN MESSAGE REQ BLOCK             02180000
                                                                        02190000
*---------------------------------------------------------------        02200000
* MCS CONSOLE NAD MCS COMMAND REPONSE TOKEN                             02210000
*---------------------------------------------------------------        02220000
MDF_MCS  DS    0H                                                       02230000
         ICM   R1,15,$MDFCNAM     DESTINSTION CONSOLE ID                02240000
         BZ    *+8                NONE, USE STARTING CONSOLE            02250000
         ST    R1,$MRBCNAM        SAVE IN MESSAGE REQ BLOCK             02260000
         ICM   R1,15,$MDFCART     DESTINSTION CONSOLE ID                02270000
         BZ    MDF_BUFF           NONE, USE STARTING CONSOLE            02280000
         ST    R1,$MRBCART        SAVE IN MESSAGE REQ BLOCK             02290000
*---------------------------------------------------------------        02300000
* MESSAGE BUFFER ADDRESS/LENGTH                                         02310000
*---------------------------------------------------------------        02320000
MDF_BUFF DS    0H                                                       02330000
         MVC   $MRBBUFA,$MDFBUFA  ADDRESS OF MESSAGE BUFFER             02340000
         MVC   $MRBBUFL,$MDFBUFL  LENGTH  OF MESSAGE BUFFER             02350000
                                                                        02360000
*---------------------------------------------------------------        02370000
* MESSAGE STORAGE QUEUE HEADER                                          02380000
*---------------------------------------------------------------        02390000
MDF_MSGQ DS    0H                                                       02400000
         ICM   R1,15,$MDFMSGQ     MESSAGE QUEUE ADDRESSS                02410000
         BZ    *+8                NONE, CHECK STORAGE QUEUE HEADER      02420000
         ST    R1,$MRBMQA                                               02430000
         ICM   R1,15,$MDFSTGH     STORAGE QUEUE HEADER                  02440000
         BZ    MDF_SUPR           NONE, NEXT PARAMETER                  02450000
         ST    R1,$MRBSTGQ                                              02460000
*---------------------------------------------------------------        02470000
* MESSAGE ID SUPPRESSION                                                02480000
*---------------------------------------------------------------        02490000
MDF_SUPR DS    0H                                                       02500000
         MVC   $MRBMIDS,$MDFSUPR+3   MESSAGE ID SUPPRESSION             02510000
                                                                        02520000
         EJECT ,                                                        02530000
*---------------------------------------------------------------        02540000
*  RETURN                                                               02550000
*---------------------------------------------------------------        02560000
MDF_RC00 DS    0H                                                       02570000
         LA    R15,RC00           NORMAL COMPLETION                     02580000
         B     MDF_EXIT           RETURN                                02590000
                                                                        02600000
MDF_RC04 DS    0H                                                       02610000
         LA    R15,RC04           INVALID MESSAGE HANDLE                02620000
         B     MDF_EXIT           RETURN                                02630000
                                                                        02640000
MDF_EXIT DS    0H                                                       02650000
         CEXIT RC=(R15)           RETURN                                02660000
         DROP  R7                 $MREQB                                02670000
                                                                        02680000
         EJECT ,                                                        02690000
**<DOC-ON>******************************************************        02700000
*                                                                       02710000
* FUNCTION: MSG  - REQUEST MESSAGE SERVICES                             02720000
*                                                                       02730000
* DESCRIPTION:                                                          02740000
*                                                                       02750000
*   THIS ROUTINE PROVIDES AN INTERFACE TO THE MESSAGE SERVICE           02760000
*   FACILITY.  A MSGHNDL INITIALIZED BY THE MSGDFT SERVICE IS           02770000
*   REQUIRED AS INPUT TO THIS FUNCTION.  THE MESSAGE NUMBER OF          02780000
*   THE MESSAGE TO BE ISSUED IS ALSO REQUIRED.  IN ADDITION,            02790000
*   PAIRS OF SUBSTUTION VALUES/LENGTH MAY ALSO BE PROVIDED.  IF         02800000
*   SUB ELEMENT PAIRS ARE PROVIDED ON THIS REQUEST,  ANY                02810000
*   PREVIOUSLY SPECIFIED SUBSTITUTION VALUES ARE IGNORED.  THE          02820000
*   MADDINT AND MADDSTR (#DEFINE) MACROS MAY ALSO BE USED TO ADD        02830000
*   SUBSTITUTION ELEMENTS TO THE LIST.  AFTER THE MESSAGE               02840000
*   SERVICE REQUEST,  THE SUBSTITUTION LIST IS RESET FOR                02850000
*   SUBSEQUENT CALLS TO THE MESSAGE SERVICE.                            02860000
*                                                                       02870000
* ENTRY:    R1 CONTAINS ADDR OF THE PARAMETER LIST AS FOLLOWS:          02880000
*                                                                       02890000
*               +00  - ADDR OF MESSAGE HANDLE                           02900000
*               +04  - MESSAGE NUMBER                                   02910000
*               +08  - NUMBER OF MESSAGE PAIRS                          02920000
*               +0C  - FIELD SUBSTITION LIST  (ADDRESS,LENGTH)          02930000
*                      IF SPECIFIED VALUE IS NOT AN ADDRESS             02940000
*                      THEN A ZERO LENGTH SHOULD BE PROVIDED            02950000
*                      TO INDICATE THE VALUE IN SELF CONTAINED          02960000
*                      WITHIN THE PARAMETER LIST.                       02970000
*                                                                       02980000
* EXIT:     R15 CONTAINS RETURN VALUS AS FOLLOWS:                       02990000
*                                                                       03000000
*               RC00 - DEFAULT VALUES ASSIGNED                          03010000
*               RC04 - INVALID MESSAGE HANDLE                           03020000
*               RC08 - INVALID FIELDS LIST                              03030000
*                                                                       03040000
**<DOC-OFF>*****************************************************        03050000
                                                                        03060000
MSG      CENTRY DSA=DSALEN                                              03070000
         USING DSA,R13            ADDRESSABILITY                        03080000
                                                                        03090000
         LR    R8,R1              ADDRESS OF PASSED PARMS               03100000
                                                                        03110000
*---------------------------------------------------------------        03120000
*  RESTORE STANDARD ENVIRONMENT                                         03130000
*---------------------------------------------------------------        03140000
         @RESTENV ,                                                     03150000
         USING ICVT,R11           ADDRESSABILITY                        03160000
         USING ITASK,R10          ADDRESSABILITY                        03170000
                                                                        03180000
         ICM   R7,15,0(R8)        OBTAIN PASSED PARAMETERS              03190000
         BZ    MSG_RC04           NONE, ERROR                           03200000
         USING $MREQB,R7          ADDRESSABILITY                        03210000
                                                                        03220000
         EJECT ,                                                        03230000
*---------------------------------------------------------------        03240000
* MESSAGE NUMBER                                                        03250000
*---------------------------------------------------------------        03260000
         MVC   $MRBMSG#,4(R8)     MESSAGE NUMBER                        03270000
                                                                        03280000
*---------------------------------------------------------------        03290000
* PROCESS MESSAGE FIELDS LIST                                           03300000
*---------------------------------------------------------------        03310000
         ICM   R2,15,8(R8)        GET COUNT OF MESSAGE FIELDS           03320000
         BZ    MSG_CALL           NONE PASSED,  CALL MSG SERV           03330000
         CH    R2,=AL2(#MAXFLDS)  MAXIMUM # OF SUB ELEMS                03340000
         BNL   MSG_RC08           YES, INVALID REQUEST                  03350000
         ST    R2,$MRBSEL#        SET COUNT OF MESSAGE ELEMENTS         03360000
         SR    R3,R3              RESET COUNTER                         03370000
         LA    R8,12(,R8)         ORIGIN OF FIELDS LIST                 03380000
                                                                        03390000
         SR    R1,R1                                                    03400000
         IC    R1,$MRBVER         GET VERSION NUMBER                    03410000
         SLL   R1,2                                                     03420000
         L     R1,VERTAB(R1)      OFFSET TO 1ST SEL ENTRY               03430000
         LA    R5,$MREQB(R1)                                            03440000
MSG_FLDS DS    0H                                                       03450000
         LR    R4,R3              CURRENT COUNT OF SELS                 03460000
         SLL   R4,3               CALC INDEX TO ENTRY                   03470000
         LA    R4,0(R5,R4)        ADDRESS OF SEL ENTRY                  03480000
         L     R1,0(,R8)          SUB ELEMENT                           03490000
         ST    R1,0(,R4)          SAVE IN MESSAGE REQ BLOCK             03500000
         L     R1,4(,R8)          SUB ELEMENT LENGTH                    03510000
         ST    R1,4(,R4)          SAVE IN MESSAGE REQ BLOCK             03520000
                                                                        03530000
         LA    R3,1(,R3)          INCREMENT FIELDS COUNTER              03540000
         LA    R8,8(,R8)          ADDRESS OF NEXT LIST ENTRIES          03550000
         CR    R2,R3              END OF SUB ELEM LIST                  03560000
         BH    MSG_FLDS           NO, PROCESS NEXT ENTRY                03570000
                                                                        03580000
         EJECT ,                                                        03590000
*---------------------------------------------------------------        03600000
* CALL MESSAGE SERVICE                                                  03610000
*---------------------------------------------------------------        03620000
MSG_CALL DS    0H                                                       03630000
         @CALL IMSGSERV,          ISSUE MESSAGE                        +03640000
               WKA=0,                                                  +03650000
               CTYPE=CVT,                                              +03660000
               MF=(E,$MREQB)                                            03670000
                                                                        03680000
         XC    $MRBSEL#,$MRBSEL#  RESET SUB ELEM LIST FOR NEXT MSG      03690000
                                                                        03700000
         LTR   R15,R15            MESSAGE SUCCESSFUL?                   03710000
         BNZ   MSG_RC12                                                 03720000
                                                                        03730000
         EJECT ,                                                        03740000
*---------------------------------------------------------------        03750000
* RETURN                                                                03760000
*---------------------------------------------------------------        03770000
                                                                        03780000
MSG_RC00 DS    0H                                                       03790000
         LA    R15,RC00           NORMAL COMPLETION                     03800000
         B     MSG_EXIT           RETURN                                03810000
                                                                        03820000
MSG_RC04 DS    0H                                                       03830000
         LA    R15,RC04           INVALID MESSAGE HANDLE                03840000
         B     MSG_EXIT           RETURN                                03850000
                                                                        03860000
MSG_RC08 DS    0H                                                       03870000
         LA    R15,RC08           INVALID FIELDS LIST                   03880000
         B     MSG_EXIT           RETURN                                03890000
                                                                        03900000
MSG_RC12 DS    0H                                                       03910000
         LA    R15,RC12           MESSAGE PROCESSING ERROR              03920000
         B     MSG_EXIT           RETURN                                03930000
                                                                        03940000
MSG_EXIT DS    0H                                                       03950000
         CEXIT RC=(R15)           RETURN                                03960000
         DROP  R7                 $MREQB                                03970000
                                                                        03980000
         EJECT ,                                                        03990000
**<DOC-ON>******************************************************        04000000
*                                                                       04010000
* FUNCTION: MSGATTR - RETURN MESSAGE CLASS ATTRIBUTES                   04020000
*                                                                       04030000
* DESCRIPTION:                                                          04040000
*                                                                       04050000
*   THIS ROUTINE WILL RETURN THE MESSAGE CLASS ATTIBUTES TO             04060000
*                                                                       04070000
* ENTRY:    R1 CONTAINS ADDR OF THE PARAMETER LIST AS FOLLOWS:          04080000
*                                                                       04090000
*               +00  - ADDR OF MESSAGE CLASS                            04100000
*                                                                       04110000
* EXIT:     R15 CONTAINS RETURN VALUS AS FOLLOWS:                       04120000
*                                                                       04130000
*               RC00 - MESSAGE CLASS IS ACTIVE                          04140000
*               RC04 - MESSAGE CLASS IS INACTIVE                        04150000
*                                                                       04160000
**<DOC-OFF>*****************************************************        04170000
                                                                        04180000
MSGATTR  CENTRY DSA=DSALEN                                              04190000
         USING DSA,R13            ADDRESSABILITY                        04200000
                                                                        04210000
         L     R2,0(,R1)          ADDRESS OF MESSAGE CLASS              04220000
                                                                        04230000
*---------------------------------------------------------------        04240000
*  RESTORE STANDARD ENVIRONMENT                                         04250000
*---------------------------------------------------------------        04260000
         @RESTENV ,                                                     04270000
         USING ICVT,R11           ADDRESSABILITY                        04280000
         USING ITASK,R10          ADDRESSABILITY                        04290000
                                                                        04300000
         $MSGATTR (R2)            GET MESSAGE CLASS ATTRIBUTES          04310000
                                                                        04320000
         CEXIT RC=(R15)           RETURN                                04330000
                                                                        04340000
         EJECT ,                                                        04350000
*---------------------------------------------------------------        04360000
*  LITERALS AND CONSTANTS                                               04370000
*---------------------------------------------------------------        04380000
                                                                        04390000
VERTAB   DC    A($MREQBL0,$MREQBL1,$MREQBL2)                            04400000
         LTORG ,                                                        04410000
                                                                        04420000
         PRINT NOGEN                                                    04430000
         ICVT  ,                                                        04440000
         ITASK ,                                                        04450000
         IHAPSA ,                                                       04460000
         IKJTCB ,                                                       04470000
         CVT   DSECT=YES,LIST=NO                                        04480000
         PRINT GEN                                                      04490000
                                                                        04500000
         END   ,                                                        04510000
