IPSBVCLN TITLE '- RESET SEMANTIC ANALYSIS FLAGS'                        00010000
***************************************************************         00020000
*                                                                       00030000
* ROUTINE: IPSBVCLN - RESET THE FLAGS IN SEMANTIC ANALYSIS BLOCK        00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
* ON ENTRY:                                                             00080000
*                                                                       00090000
*    R1  SEMANTIC ANALYSIS (SQLSEMAL)                                   00100000
*                                                                       00110000
*                                                                       00120000
* ON EXIT:                                                              00130000
*                                                                       00140000
*       RC00 - REQUEST COMPLETED WITHOUT ERROR                          00150000
*                                                                       00160000
***************************************************************         00170000
                                                                        00180000
         EJECT ,                                                        00190000
***************************************************************         00200000
*                                                                       00210000
* MAINTENANCE :                                                         00220000
*                                                                       00230000
*    11/29/94  Su-fen Wu          Par# 157241                    157241 00240000
*              Reset the SBPVTYPE flag for both $HOS and $DFT    157241 00250000
*                                                                       00260000
***************************************************************         00270000
                                                                        00280000
         EJECT ,                                                        00290000
WORKAREA #WORK                                                          00300000
                                                                        00310000
WORKLEN  #ENDWORK                                                       00320000
                                                                        00330000
         EJECT ,                                                        00340000
         SQLSEMAL ,                                                     00350000
                                                                        00360000
         EJECT ,                                                        00370000
         EQUS ,                                                         00380000
                                                                        00390000
         EJECT ,                                                        00400000
IPSBVCLN #ENTER PREG=R6                                                 00410000
                                                                        00420000
         USING SQSEMAL,R6                                               00430000
                                                                        00440000
***************************************************************         00450000
                                                                        00460000
         LA    R5,SQSACOLS                                              00470000
         USING SQCOLREF,R5        COLUMN ENTRY FORMAT                   00480000
                                                                        00490000
SQCOLOOP DS    0H                                                       00500000
         ICM   R5,15,SQCOLINK     ADVANCE TO NEXT COLUMN REFERENCE      00510000
         BNZ   SQCOLOOP           N/A                                   00520000
         DROP  R5                                                       00530000
                                                                        00540000
HVPROC   DS    0H                                                       00550000
         SR    R2,R2                                                    00560000
         CLI   SQSQUERY,SQSQ_SEL      SELECT STATEMENT                  00570000
         BE    $SELECT                                                  00580000
         CLI   SQSQUERY,SQSQ_INS      INSERT STATEMENT                  00590000
         BE    $INSERT                                                  00600000
         CLI   SQSQUERY,SQSQ_UPD      UPDATE STATEMENT                  00610000
         BE    $UPDATE                                                  00620000
         CLI   SQSQUERY,SQSQ_DEL      DELETE STATEMENT                  00630000
         BE    $DELETE                                                  00640000
         B     BPEXIT                                                   00650000
                                                                        00660000
$SELECT  DS    0H                                                       00670000
         ICM   R5,15,SQSEXTRE         1ST BASIC PREDICATE               00680000
         B     BPLOOP                                                   00690000
                                                                        00700000
$INSERT  DS    0H                                                       00710000
         ICM   R5,15,SQSAVALS         VALUE LIST                        00720000
         B     BPLOOP                                                   00730000
                                                                        00740000
$UPDATE  DS    0H                                                       00750000
         ICM   R5,15,SQSASETS         1ST BASIC PREDICATE               00760000
         B     BPLOOP                                                   00770000
                                                                        00780000
$DELETE  DS    0H                                                       00790000
         ICM   R5,15,SQSEXTRE         1ST BASIC PREDICATE               00800000
         B     BPLOOP                                                   00810000
                                                                        00820000
*--------------------------------------------------------------         00830000
*   STATEMENT SCAN                                                      00840000
*--------------------------------------------------------------         00850000
PFX      USING PREDENT,R5             BASIC PREDICATE FORMAT            00860000
BPT      USING SBPTERM,R5             BASIC PREDICATE FORMAT            00870000
                                                                        00880000
BPLOOP   DS    0H                                                       00890000
         BZ    UPDBP                  BREAK THE LOOP IF NO MORE         00900000
                                                                        00910000
         CLI   PFX.PREDTYPE,PRED$BPE                                    00920000
         BE    RESET                                                    00930000
                                                                        00940000
         CLI   PFX.PREDTYPE,PRED$SET  PREDICATE FOR 'SET' CLAUSE        00950000
         BNE   NEXTBP                                                   00960000
                                                                        00970000
RESET    TM    BPT.SBPVTYPE,SBPV$HOS                             157241 00980000
         BZ    NEXTBP                                            157241 00990000
         NI    BPT.SBPVTYPE,X'FF'-SBPV$HOV-SBPV$DFT RESET FLAG   157241 01000000
                                                                        01010000
NEXTBP   DS    0H                                                       01020000
         ICM   R5,15,BPT.SBPLINK      ADVANCE TO NEXT PREDICATE         01030000
         B     BPLOOP                 LOOPING                           01040000
                                                                        01050000
UPDBP    DS    0H                                                       01060000
         CLI   SQSQUERY,SQSQ_UPD      'UPDATE' STATEMENT ?              01070000
         BNE   ENDLOOP                                                  01080000
                                                                        01090000
         LTR   R2,R2                                                    01100000
         BNZ   ENDLOOP                                                  01110000
         LA    R2,1(R2)               INCREMENT COUNT                   01120000
         ICM   R5,15,SQSEXTRE         BASIC PREDICATE FOR WHERE         01130000
         B     BPLOOP                                     CLAUSE        01140000
                                                                        01150000
ENDLOOP  DS    0H                                                       01160000
         B     BPEXIT                                                   01170000
                                                                        01180000
*--------------------------------------------------------------         01190000
*   POST COMPLETION CODE AND EXIT                                       01200000
*--------------------------------------------------------------         01210000
BPEXIT   DS    0H                     SET RC = 0                        01220000
         SR    R15,R15                                                  01230000
                                                                        01240000
EXIT     DS    0H                                                       01250000
         #EXIT                                                          01260000
                                                                        01270000
         DROP  R6                                                       01280000
         DROP  PFX,BPT                                                  01290000
                                                                        01300000
         EJECT                                                          01310000
         LTORG                                                          01320000
                                                                        01330000
         PRINT NOGEN                                                    01340000
         ICVT ,                                                         01350000
         EJECT ,                                                        01360000
         END ,                                                          01370000
