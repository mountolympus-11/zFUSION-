IL62TSNS TITLE 'INTEGRATOR LU62 SERVICE: CONVERT SENSE TO RETURN CODE'  00010000
                                                                        00020000
         PRINT NOGEN                                                    00030000
         CMINCL ,                 INTEGRATOR CPI-C DEFINITIONS          00040000
         L62INCL ,                INTEGRATOR LU6.2 DEFINITIONS          00050000
         PRINT GEN                                                      00060000
                                                                        00070000
**<DOC-ON>************************************************************* 00080000
*                                                                       00090000
* ROUTINE: IL62TSNS - INTEGRATOR LU62 SERVICE: CONVERT SENSE TO RET CD  00100000
*                                                                       00110000
* DESCRIPTION:                                                          00120000
*                                                                       00130000
* ON ENTRY:                                                             00140000
*                                                                       00150000
*    R15 = ENTRY POINT ADDRESS                                          00160000
*    R14 = RETURN ADDRESS                                               00170000
*    R13 = AVAILABLE SAVE AREA                                          00180000
*    R11 = ICVT ADDRESS                                                 00190000
*    R10 = ITASK ADDRESS                                                00200000
*    R01 = ADDRESS OF SENSE OR ADDRESS OF LU6.2/CPIC RETURN CODE        00210000
*          (HI BIT IS ON IF IT'S A RETURN CODE ADDRESS)                 00220000
*                                                                       00230000
* ON EXIT:                                                              00240000
*                                                                       00250000
*    R15 = 0                                                            00260000
*    R01 = ADDRESS OF SENSE OR ADDRESS OF LU6.2/CPIC RETURN CODE        00270000
*    R00 = CORRESPONDING CPIC RETURN CODE (IF SENSE INPUT)              00280000
*        = CORRESPONDING LU6.2 SENSE CODE (IF RETURN CODE INPUT)        00290000
*                                                                       00300000
*    ALL OTHER REGISTERS ARE RESTORED                                   00310000
*                                                                       00320000
**<DOC-OFF>************************************************************ 00330000
         EJECT ,                                                        00340000
*********************************************************************** 00350000
*                                                                       00360000
* MAINTENANCE:                                                          00370000
*                                                                       00380000
*   08/01/94 RANDY WITEK                                                00390000
*                                                                       00400000
*********************************************************************** 00410000
         EQUS  ,                  GENERAL EQUATES                       00420000
RICVT    EQU   R11                                                      00430000
RITASK   EQU   R10                                                      00440000
RPARM    EQU   R9                                                       00450000
         USING ICVT,RICVT         ESTABLISH ADDRESSABILITY              00460000
         USING ITASK,RITASK       ESTABLISH ADDRESSABILITY              00470000
                                                                        00480000
IL62TSNS #ENTER BASE=R12,         R12 IS BASE REGISTER                 +00490000
               AMODE=31,                                               +00500000
               RMODE=ANY,                                              +00510000
               PREG=(RPARM),      R1 --> RPARM                         +00520000
               RESTENV=NO,        ICVT AND ITASK POINTERS ARE OK       +00530000
               SAVE=NO,           DON'T ALLOCATE A SAVE AREA           +00540000
               WAPASS=NO,         NO WORK AREA PASSED IN R0            +00550000
               LINKAGE=STD        CALLED BY BAS/BASR                    00560000
                                                                        00570000
*---------------------------------------------------------------------- 00580000
* IS THIS A SENSE LOOKUP OR A RETURN CODE LOOKUP?                       00590000
*---------------------------------------------------------------------- 00600000
                                                                        00610000
         LTR   RPARM,RPARM        HI BIT ON IF IT'S A RETURN CODE ADDR  00620000
         BM    RCLOOKUP                                                 00630000
                                                                        00640000
*---------------------------------------------------------------------- 00650000
* SEARCH TABLE FOR GIVEN SENSE                                          00660000
*---------------------------------------------------------------------- 00670000
                                                                        00680000
         LA    R0,CM_RESOURCE_FAILURE_NO_RETRY                          00690000
         LR    R1,RPARM           SET TO PASS R1 BACK                   00700000
                                                                        00710000
         LA    R4,SENSETBL        ADDRESS OF JUMP TABLE                 00720000
         LA    R2,L'SENSEENT      LENGTH OF AN ENTRY                    00730000
         LA    R3,SENSELST        ADDRESS OF LAST ENTRY                 00740000
                                                                        00750000
SENSERUN DS    0H                                                       00760000
                                                                        00770000
         CLC   0(4,RPARM),0(R4)   DOES ENTRY MATCH GIVEN SENSE?         00780000
         BE    SENSEGO            BRANCH IF YES                         00790000
         BXLE  R4,R2,SENSERUN     CHECK ALL TABLE ENTRIES               00800000
         B     RETURN                                                   00810000
                                                                        00820000
SENSEGO  DS    0H                                                       00830000
                                                                        00840000
         L     R0,4(,R4)          TAKE THE ASSOCIATED RETURN CODE       00850000
         B     RETURN             AND RETURN                            00860000
                                                                        00870000
*---------------------------------------------------------------------- 00880000
* SEARCH TABLE FOR GIVEN RETURN CODE                                    00890000
*---------------------------------------------------------------------- 00900000
                                                                        00910000
RCLOOKUP DS    0H                                                       00920000
                                                                        00930000
         SR    R0,R0              SET DEFAULT TO NO SENSE               00940000
         LR    R1,RPARM           SET TO PASS R1 BACK                   00950000
                                                                        00960000
         LA    R4,SENSETBL        ADDRESS OF JUMP TABLE                 00970000
         LA    R2,L'SENSEENT      LENGTH OF AN ENTRY                    00980000
         LA    R3,SENSELST        ADDRESS OF LAST ENTRY                 00990000
                                                                        01000000
RCRUN    DS    0H                                                       01010000
                                                                        01020000
         CLC   0(4,RPARM),4(R4)   DOES ENTRY MATCH GIVEN RC?            01030000
         BE    RCGO               BRANCH IF YES                         01040000
         BXLE  R4,R2,RCRUN        CHECK ALL TABLE ENTRIES               01050000
         B     RETURN                                                   01060000
                                                                        01070000
RCGO     DS    0H                                                       01080000
                                                                        01090000
         L     R0,0(,R4)          TAKE THE ASSOCIATED SENSE CODE        01100000
         B     RETURN             AND RETURN                            01110000
                                                                        01120000
*---------------------------------------------------------------------- 01130000
* RETURN TO CALLER                                                      01140000
*---------------------------------------------------------------------- 01150000
                                                                        01160000
RETURN   DS    0H                                                       01170000
                                                                        01180000
         SR    R15,R15            CLEAR R15                             01190000
                                                                        01200000
         #EXIT R1=YES             RETURN W/R15,R0,R1                    01210000
                                                                        01220000
*---------------------------------------------------------------------- 01230000
* SENSE CODE TABLE                                                      01240000
*---------------------------------------------------------------------- 01250000
                                                                        01260000
SENSETBL DS    0F                                                       01270000
         DC    XL4'1008600B',A(CM_RESOURCE_FAILURE_NO_RETRY)            01280000
SENSEENT EQU   SENSETBL,*-SENSETBL                                      01290000
         DC    XL4'10086021',A(CM_TPN_NOT_RECOGNIZED)                   01300000
         DC    XL4'10086031',A(CM_ALLOCATE_FAILURE_NO_RETRY) *** PIP    01310000
         DC    XL4'10086032',A(CM_PIP_NOT_SPECIFIED_CORRECTLY)          01320000
         DC    XL4'10086034',A(CM_CONVERSATION_TYPE_MISMATCH)           01330000
         DC    XL4'10086041',A(CM_SYNC_LVL_NOT_SUPPORTED_PGM)           01340000
         DC    XL4'080F6051',A(CM_SECURITY_NOT_VALID)                   01350000
         DC    XL4'08240000',A(CM_RESOURCE_FAILURE_NO_RETRY) *** B'D O  01360000
         DC    XL4'084B6031',A(CM_TP_NOT_AVAILABLE_RETRY)               01370000
         DC    XL4'084C0000',A(CM_TP_NOT_AVAILABLE_NO_RETRY)            01380000
         DC    XL4'08640000',A(CM_DEALLOCATED_ABEND)                    01390000
         DC    XL4'08640001',A(CM_DEALLOCATED_ABEND_SVC)                01400000
         DC    XL4'08640002',A(CM_DEALLOCATED_ABEND_TIMER)              01410000
         DC    XL4'08890000',A(CM_PROGRAM_ERROR_NO_TRUNC) OR _PURGING   01420000
         DC    XL4'08890001',A(CM_PROGRAM_ERROR_TRUNC)                  01430000
         DC    XL4'08890100',A(CM_SVC_ERROR_NO_TRUNC)     OR _PURGING   01440000
         DC    XL4'08890101',A(CM_SVC_ERROR_TRUNC)                      01450000
SENSELST EQU   *-L'SENSEENT                                             01460000
                                                                        01470000
         LTORG ,                                                        01480000
         PRINT NOGEN                                                    01490000
         IHAPSA ,                 MVS PREFIXED SAVE AREA                01500000
         ICVT  ,                  INTEGRATOR CVT                        01510000
         IVTAMCVT ,               INTEGRATOR VTAM CVT                   01520000
         ITASK ,                  INTEGRATOR TASK BLOCK                 01530000
         IPCB ,                   INTEGRATOR PROCESS BLOCK              01540000
         END   ,                                                        01550000
