         TITLE 'ICONCSMY - CONSTRUCT COMMAND CONTENT SUMMARY'           00010000
***************************************************************         00020000
*                                                                       00030000
* MAPPING: CSMYPARM - ICONCSMY PARAMETER LIST                           00040000
*                                                                       00050000
***************************************************************         00060000
CSMYPARM DSECT                                                          00070000
CSMYKTAB DS     A            ADDR OF KEYWORD TABLE                      00080000
CSMYOPL  DS     A            ADDR OF OPERAND LIST (OPLIST)              00090000
CSMYCCS  DS     A            ADDR OF CCSMRY CONSTRUCTION AREA           00100000
CSMYCMD  DS     A            ADDR OF COMMAND LINE USED TO BUILD OPLIST  00110000
                                                                        00120000
         EJECT                                                          00130000
         KEYTAB DSECT=YES    COMMAND KEYWORD TABLE FORMATS              00140000
         EJECT                                                          00150000
         OPLIST ,            COMMAND KEYWORD & VALUES INSTANCES         00160000
         EJECT                                                          00170000
         CCSUMRY ,           COMMAND CONTENT SUMMARY BLOCK              00180000
         EJECT                                                          00190000
         EQUS  ,                                                        00200000
         EJECT                                                          00210000
**<DOC-ON>*****************************************************         00220000
*                                                                       00230000
* ROUTINE: ICONCSMY - CONSTRUCT COMMAND CONTENT SUMMARY                 00240000
*                                                                       00250000
* DESCRIPTION:                                                          00260000
*                                                                       00270000
*    THIS ROUTINE CREATES A COMMAND CONTENT SUMMARY (CCSUMRY)           00280000
*    BLOCK FROM AN OPERAND KEYWORD TABLE (KEYTAB) AND THE               00290000
*    PARALLEL OPERAND LIST (OPLIST) ARRAY.  COMMAND SUMMARY             00300000
*    ENTRIES ARE CREATED FOR EACH SPECIFIED OPERAND.  THE               00310000
*    COMMAND CONTENT SUMMARY BLOCK IS MORE SUITABLE FOR                 00320000
*    TRANSMISSION TO COMMAND PROCESSING ROUTINES BECAUSE IT             00330000
*    DESCRIBES ONLY THOSE OPERANDS AND VALUES DESIGNATED ON             00340000
*    THE SOURCE COMMAND LINE.                                           00350000
*                                                                       00360000
* ON ENTRY:                                                             00370000
*                                                                       00380000
*    R1  CONTAINS THE ADDRESS OF A PARAMETER LIST DESCRIBED             00390000
*        BY THE CSMYPARM MAPPING                                        00400000
*                                                                       00410000
* ON EXIT:                                                              00420000
*                                                                       00430000
*    R15 CONTAINS ZERO                                                  00440000
*                                                                       00450000
**<DOC-OFF>****************************************************         00460000
                                                                        00470000
***************************************************************         00480000
*                                                                       00490000
* MAINTENANCE:                                                          00500000
*                                                                       00510000
*    05/12/93 R. TURGEON                                                00520000
*             INITIAL VERSION                                           00530000
*                                                                       00540000
***************************************************************         00550000
                                                                        00560000
         EJECT ,                                                        00570000
ICONCSMY #ENTER SAVE=NO                                                 00580000
                                                                        00590000
         USING ICVT,R11                                                 00600000
         USING ITASK,R10                                                00610000
                                                                        00620000
*--------------------------------------------------------------         00630000
*   FETCH PASSED PARAMETERS                                             00640000
*--------------------------------------------------------------         00650000
         USING CSMYPARM,R1        PARAMTER LIST                         00660000
         L     R4,CSMYKTAB        KEYWORD TABLE HEADER                  00670000
         USING KEYTAB,R4          READY FOR KEYTAB SCAN                 00680000
         L     R6,CSMYOPL         OPERAND LIST                          00690000
         USING OPLIST,R6          READY FOR PARALLEL SCAN               00700000
         L     R8,CSMYCCS         COMMAND CONTENT SUMMARY ORIGIN        00710000
         USING CCSUMRY,R8         START AT THE TOP                      00720000
         L     R3,CSMYCMD         COMMAND LINE ORIGIN FOR OFFSET CALC   00730000
                                                                        00740000
*--------------------------------------------------------------         00750000
*   PARALLEL SCAN OF KEYTAB AND OPLIST, COPY SPECIFIED OPERANDS         00760000
*--------------------------------------------------------------         00770000
CSCNTOP  DS    0H                                                       00780000
         CLI   KEYTKWD,0          END OF KEYTAB / OPLIST ?              00790000
         BE    CSCNFIN            SKIP IF SO                            00800000
         CLI   OPLSPEC,0          OPERAND SPECIFIED?                    00810000
         BE    CSCNADV            SKIP IF NOT                           00820000
                                                                        00830000
         MVC   CCSNAME,KEYTKWD    KEYWORD                               00840000
         MVC   CCSID,KEYTID       KEYWORD ID                            00850000
         LH    R2,OPLCOUNT        # ASSOCIATED VALUES                   00860000
         STH   R2,CCSVALCT        ONLY SPECIFIED VALUES ARE COPIED      00870000
                                                                        00880000
         LA    R7,OPLVALS         PREPARE FOR OPLIST VALUE SCAN         00890000
         USING OPLVALS,R7         TIGHTEN ADDRESSING                    00900000
         LA    R9,CCSVALS         VALUES PLACED IN CCSMRY SLOTS         00910000
         USING CCSVALS,R9         ADDRESSING SIMILARLY TIGHTENED        00920000
         LTR   R2,R2              VALUES PRESENT?                       00930000
         BNP   CSCNACPT           DONE HERE IF NOT                      00940000
                                                                        00950000
CSCNVALS DS    0H                                                       00960000
         MVC   CCSVLEN,OPLVLEN    LENGTH OF VALUE STRING                00970000
         L     R0,OPLVPTR         ORIGIN OF VALUE                       00980000
         SR    R0,R3              CONVERT VALUE PTR TO OFFSET           00990000
         ST    R0,CCSVDISP        SAVE PORTABLE PTR                     01000000
         LA    R7,OPLVSLN(,R7)    ADVANCE TO NEXT VALUE                 01010000
         LA    R9,CCSVSLN(,R9)    AND TARGET SLOT IN CMD SUMMARY        01020000
         BCT   R2,CSCNVALS        PROCESS ALL VALUES                    01030000
                                                                        01040000
CSCNACPT DS    0H                                                       01050000
         LR    R8,R9              INIT NEW CCSUMRY ENTRY                01060000
                                                                        01070000
*--------------------------------------------------------------         01080000
*   ADVANCE TO NEXT KEYWORD AND CORRESPONDING OPLIST ENTRIES            01090000
*--------------------------------------------------------------         01100000
CSCNADV  DS    0H                                                       01110000
         LA    R4,KEYTLN(,R4)     NEXT KEYTAB ENTRY (FIXED LENGTH)      01120000
         LA    R6,OPLISTLN(,R6)   NEXT OPLIST ENTRY (FIXED LENGTH)      01130000
         B     CSCNTOP            PROCESS ALL OPERANDS & VALUES         01140000
                                                                        01150000
CSCNFIN  DS    0H                                                       01160000
         LA    R15,RC00           COMPLETE                              01170000
         #EXIT ,                  DONE                                  01180000
                                                                        01190000
         EJECT ,                                                        01200000
***************************************************************         01210000
*                                                                       01220000
*   LOCAL READ/ONLY DATA AREAS, ETC.                                    01230000
*                                                                       01240000
***************************************************************         01250000
         LTORG ,                                                        01260000
                                                                        01270000
         PRINT NOGEN                                                    01280000
         ICVT  ,                                                        01290000
         ITASK ,                                                        01300000
         END   ,                                                        01310000
