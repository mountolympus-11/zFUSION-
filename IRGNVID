IRGNVID  TITLE 'IRGNVID - DETERMINE SUITABILITY OF ID REGION'           00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: IRGNVID - DETERMINE SUITABILITY OF ID REGION                 00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS USED TO VERIFY THAT A (NAVIGATIONAL)               00080000
*    IDENTIFICIATION REGION IS DEFINED USING SOME CONTEXTUAL            00090000
*    REFERENCE TO OBJECTS FOUND ON THE IMAGE.  A WARNING                00100000
*    MESSAGE IS ISSUED IF THE REGION IS (CLEARLY) DEFINED               00110000
*    ONLY BY REFERENCE TO SCREEN COORDINATES.                           00120000
*                                                                       00130000
*                                                                       00140000
* METHOD:                                                               00150000
*                                                                       00160000
*    BEGIN PARENTAGE SCAN WITH CURRENT REGION                           00170000
*                                                                       00180000
*    FOR EACH REGION IN PARENTAGE PATH                                  00190000
*        IF CURRENT REGION IS 'OBJECT LOCATOR' TYPE                     00200000
*           RETURN (RC00)                                               00210000
*                                                                       00220000
*        IF CURRENT REGION IS 'REMAINING AREA' AND                      00230000
*           SOME CURRENT REGION PEER IS 'OBJECT LOCATOR'                00240000
*                                                                       00250000
*           RETURN (RC00)                                               00260000
*                                                                       00270000
*        SET CURRENT REGION TO PARENT OF CURRENT                        00280000
*    END FOR                                                            00290000
*                                                                       00300000
*    ISSUE MSG("QUESTIONABLE DEFINITION",RC04)                          00310000
*                                                                       00320000
*                                                                       00330000
* ON ENTRY:                                                             00340000
*                                                                       00350000
*    R1  CONTAINS THE ADDRESS OF A PARAMETER LIST DESCRIBED BY          00360000
*        THE VIDLIST MAPPING EXPANDED BELOW                             00370000
*                                                                       00380000
*                                                                       00390000
* ON EXIT:                                                              00400000
*                                                                       00410000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00420000
*                                                                       00430000
*        RC00 - REGION IS CONTEXTUALLY DEFINED                          00440000
*                                                                       00450000
*        RC04 - REGION IS DEFINED WITHOUT CONTEXTUAL REFERENCES         00460000
*                                                                       00470000
**<DOC-OFF>****************************************************         00480000
                                                                        00490000
         EJECT ,                                                        00500000
***************************************************************         00510000
*                                                                       00520000
* MAINTENANCE:                                                          00530000
*                                                                       00540000
*   03/28/94  R. TURGEON                                                00550000
*             INITIAL VERSION                                           00560000
*                                                                       00570000
***************************************************************         00580000
                                                                        00590000
         EJECT                                                          00600000
         #WORK ,                                                        00610000
                                                                        00620000
REGIONAM DS    CL16               NAME OF CANDIDATE REGION              00630000
                                                                        00640000
RETC     DS    F                  COMPLETION CODE RETURNED TO CALLER    00650000
MSGMFL   $MSG  FIELDS=(,,,,),MF=L                                       00660000
                                                                        00670000
         #ENDWORK ,                                                     00680000
                                                                        00690000
         EJECT                                                          00700000
         VIDLIST ,                ENTRANCE LIST                         00710000
                                                                        00720000
         EJECT                                                          00730000
         ICATALOG REGION          SYSREGION ENTRY FORMAT                00740000
                                                                        00750000
         EJECT                                                          00760000
         REGION ,                 REGION DEFINITIONS                    00770000
                                                                        00780000
         EJECT                                                          00790000
         EQUS  ,                  GENERAL EQUATES                       00800000
                                                                        00810000
         $MSGDFT PREFIX=ICTPID,COMPID='NAV',TABLE=*#MSGS,              X00820000
               CONID=*ICTCONID,CONNAME=ICTCONNM,                       X00830000
               DEST=$IMSGQ,                                            X00840000
               MSGQA=*VIDMSGQ,STGQH=*VIDSTGQ,                          X00850000
               PRINT=NOGEN,MF=(E,MSGMFL)                                00860000
                                                                        00870000
         EJECT                                                          00880000
IRGNVID  #ENTER IRGNVID,PREG=(R8)                                       00890000
                                                                        00900000
         USING ITASK,R10          STDENV                                00910000
         USING VIDLIST,R8         LIFE OF FUNCTION ADDRESSABILITY       00920000
                                                                        00930000
***************************************************************         00940000
*                                                                       00950000
*   IDENTIFY IMAGE AND SCREEN SET NAMES                                 00960000
*                                                                       00970000
***************************************************************         00980000
         L     R7,VIDRGN          CURRENT REGION                        00990000
         USING RGNTRY,R7          REGION DEFINITION ENTRIES             01000000
         ICM   R6,15,RGNSRGN      LOCATE REGION DEFINITION              01010000
         USING SYSRGN,R6          SYSREGION CATALOG ENTRIES             01020000
         BZ    *+10               UNUSUAL ERROR                         01030000
         MVC   REGIONAM,SRNAME    RETAIN REGION NAME FOR MSG            01040000
                                                                        01050000
         EJECT ,                                                        01060000
***************************************************************         01070000
*                                                                       01080000
*   VALIDATE REGION DEFINITION                                          01090000
*                                                                       01100000
***************************************************************         01110000
RDNEXT   DS    0H                                                       01120000
         ICM   R6,15,RGNSRGN      LOCATE REGION DEFINITION              01130000
         BZ    RDADV              NO FORMAL DEFINITION                  01140000
                                                                        01150000
         ICM   R5,15,SRLMETH+4    LOCATION METHOD OR ZERO IF UNCLAIMED  01160000
         BZ    RDREMAIN           ELSEWHERE IF UNCLAIMED                01170000
         AR    R5,R6              CONVERT OFFSET TO ADDRESS             01180000
         USING RMHDR,R5           METHOD DESCRIPTOR FORMAT              01190000
         CLI   RMHTYPE,RM2$TYP2   OBJECT LOCATOR?                       01200000
         BE    RDVFIN             SATISFACTORY DEFINITION IF SO         01210000
         B     RDADV              WALK UP PARENTAGE CHAIN OTHERWISE     01220000
                                                                        01230000
*--------------------------------------------------------------         01240000
*   'REMAINING AREA' DEFINITION                                         01250000
*--------------------------------------------------------------         01260000
RDREMAIN DS    0H                                                       01270000
         ICM   R4,15,RGNPAR       LOCATE PARENT                         01280000
         BZ    RDADV              TOP OF RGN DEF TREE                   01290000
AUX      USING RGNTRY,R4          SCAN PEER CHAIN                       01300000
                                                                        01310000
         L     R4,AUX.RGNSUB      ORIGIN OF LOWER LEVEL REGION LIST     01320000
                                                                        01330000
RDRESCAN DS    0H                                                       01340000
         ICM   R6,15,AUX.RGNSRGN  LOCATE REGION DEFINITION              01350000
         BZ    RDADV              UNUSUAL, NO FORMAL DEFINITION         01360000
                                                                        01370000
         ICM   R5,15,SRLMETH+4    LOCATION METHOD OR ZERO               01380000
         BZ    RDADV              WANT EXPLICIT METHOD                  01390000
         AR    R5,R6              CONVERT OFFSET TO ADDRESS             01400000
         CLI   RMHTYPE,RM2$TYP2   OBJECT LOCATOR?                       01410000
         BE    RDVFIN             SATISFACTORY DEFINITION IF SO         01420000
         ICM   R4,15,AUX.RGNPEER  ADVANCE TO PEER REGION                01430000
         BNZ   RDRESCAN           TRY AGAIN                             01440000
         DROP  R5,AUX             RMHDR, AUX RGNTRY                     01450000
                                                                        01460000
*--------------------------------------------------------------         01470000
*   WALK UP PARENT CHAIN AND TRY AGAIN                                  01480000
*--------------------------------------------------------------         01490000
RDADV    DS    0H                                                       01500000
         ICM   R7,15,RGNPAR       PARENT REGION DEFINED?                01510000
         BNZ   RDNEXT             TRY AGAIN IF SO                       01520000
                                                                        01530000
         $MSG  030,FIELDS=((*VIDSSET,16),REGIONAM)                      01540000
                                                                        01550000
         LA    R15,RC04           INDICATE WARNING NOTED                01560000
         B     RDRET                                                    01570000
                                                                        01580000
*--------------------------------------------------------------         01590000
*   RETURN COMPLETION STATUS TO CALLER                                  01600000
*--------------------------------------------------------------         01610000
RDVFIN   DS    0H                                                       01620000
         LA    R15,RC00           NO WARNINGS/ERRORS NOTED              01630000
                                                                        01640000
RDRET    DS    0H                                                       01650000
         #EXIT ,                                                        01660000
                                                                        01670000
         EJECT ,                                                        01680000
***************************************************************         01690000
*                                                                       01700000
*   LOCAL READ ONLY DATA AREAS, ETC.                                    01710000
*                                                                       01720000
***************************************************************         01730000
         LTORG ,                                                        01740000
                                                                        01750000
         PRINT OFF                                                      01760000
         ICVT  ,                                                        01770000
         ITASK ,                                                        01780000
         END   ,                                                        01790000
