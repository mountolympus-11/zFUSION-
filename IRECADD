IRECADD  TITLE '- RECORD STATE TRANSITION'                              00010000
***************************************************************         00020000
*                                                                       00030000
* ROUTINE: IRECADD - RECORD STATE TRANSITION                            00040000
*                                                                       00050000
* GENERAL INFORMATION:                                                  00060000
*                                                                       00070000
*    IRECADD IS INVOKED TO RECORD A STATE-TO-STATE TRANSITION           00080000
*    REPRESENTED BY THE CURRENT SESSIMAG STRUCTURE IN THE               00090000
*    CANDIDATE (TEMPORARY) RECORDING TABLE.  A STANDARD                 00100000
*    TRANSITION CONSISTS OF A STATE (S0) WHICH REPRESENTS A             00110000
*    DISPLAY PREVIOUSLY DELIVERED TO THE TERMINAL, A STORED             00120000
*    KEYSTROKE SEQUENCE (SKS) AND A TERMINATING AID KEY, AND A          00130000
*    RESULT STATE (S1) WRITTEN BY THE APPLICATION, PRESUMABLY           00140000
*    IN RESPONSE TO THE USER'S INPUT.                                   00150000
*                                                                       00160000
*    THE INITIAL TRANSITION TO THE HOST APPL AT LOGON TIME IS           00170000
*    DEPICTED AS VTAM->S1, AND THE TRANSITION FROM THE APPL AT          00180000
*    LOGOFF TIME (OR OTHER SESSION TERMINATION EVENT) IS                00190000
*    DEPICTED BY S0->VTAM.  ALL OTHER TRANSITIONS ARE GENERICALLY       00200000
*    DESCRIBED AS S0->S1.                                               00210000
*                                                                       00220000
*    THE MODEL EMBRACED BY SESSION RECORDING IS THAT A TERMINAL         00230000
*    DATA ENTRY EVENT PERFORMED BY THE USER YIELDS A STABLE             00240000
*    RESULT STATE, WITH DIRECTION REVERTING TO THE TERMINAL             00250000
*    USER IN PREPARATION FOR THE NEXT STATE TRANSITION.                 00260000
*                                                                       00270000
*    THE ACTUAL BEHAVIOR OF THE APPLICATION MAY DIFFER                  00280000
*    CONSIDERABLY FROM THIS MODEL.  SOME APPLICATIONS, FOR              00290000
*    EXAMPLE, MAY PRESENT SEVERAL IMAGES BEFORE CHANGE OF               00300000
*    DIRECTION IS PROVIDED (TSO LINE MODE, ETC).                        00310000
*                                                                       00320000
*                                                                       00330000
* DESCRIPTION:                                                          00340000
*                                                                       00350000
*    AT THE TIME OF THE CALL, THE SESSIMAG BLOCK CONTAINS               00360000
*    INFORMATION DESCRIBING S0 - THE LAST IMAGE DELIVERED TO            00370000
*    THE REMOTE, AND S1 THE LAST IMAGE PRESENTED IN RESPONSE            00380000
*    BY THE HOST APPLICATION.  NORMALLY, A RECORD-ADD REQUEST           00390000
*    SHOULD NOT BE MADE UNTIL ALL HOST RESPONSES HAVE BEEN              00400000
*    RECEIVED.                                                          00410000
*                                                                       00420000
*    THE STATE TRANSITION IS REPRESENTED BY A SYSNAVIGATION             00430000
*    RECORD THAT RELATES AT MOST TWO SYSIMAGE ENTRIES VIA               00440000
*    A SYSSKS ENTRY.  THE SYSSKS ENTRY, IF DEFINED, IS ANCHORED         00450000
*    IN SEISKSA.  S0 AND S1 IMAGE MUST BE MANAGED BY THE CALLER         00460000
*    IN THE RESPECTIVE SEIS0- AND SEIS1- SESSIMAG SECTIONS.             00470000
*                                                                       00480000
*    THE RECORDING FACILITY OPERATES AS AN EXIT FROM THE HOST           00490000
*    SIDE OF THE 3270 EMULATOR.  ONLY SESSIMAG FIELDS OWNED BY          00500000
*    THE RECORDING FUNCTIONS ARE MODIFIED BY THIS LOGIC.                00510000
*                                                                       00520000
*                                                                       00530000
* NOTES:                                                                00540000
*                                                                       00550000
*    SYSNAVIGATION ROWS CONTAIN THE TOKEN '*ERROR*' IF                  00560000
*    THE ASSOCIATED STATE IS NOT UNDERSTOOD. THIS CONVENTION            00570000
*    IS INTENDED FOR DEBUGGING ONLY.                                    00580000
*                                                                       00590000
*    THE SKS ANCHORED IN SESSIMAG.SEISKSA IS RELEASED AFTER             00600000
*    THE SYSSKS ROW IS RECORDED.                                        00610000
*                                                                       00620000
*                                                                       00630000
* ON ENTRY:                                                             00640000
*                                                                       00650000
*    R1  CONTAINS THE ADDRESS OF THE SESSIMAG DEFINING THE              00660000
*        CURRENT SESSION                                                00670000
*                                                                       00680000
*                                                                       00690000
* ON EXIT:                                                              00700000
*                                                                       00710000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES. REASON             00720000
*        CODES, WHEN DEFINED, ARE RETURNED IN R0.                       00730000
*                                                                       00740000
*           RC00 - RECORDING ENTRIES GENERATED                          00750000
*                                                                       00760000
*           RC04 - TRANSITION NOT MEANINGFUL IN CONTEXT. THIS           00770000
*                  STATUS IS RETURNED IF THE FIRST REQUEST              00780000
*                  RECEIVED IS TO VTAM OR RECORDING STOPPED             00790000
*                  TRANSITION.                                          00800000
*                                                                       00810000
*           RC08 - INVALID REQUEST, RECORDING NOT ACTIVE                00820000
*                                                                       00830000
***************************************************************         00840000
         EJECT ,                                                        00850000
                                                                        00860000
         #WORK ,                                                        00870000
                                                                        00880000
S1IMGROW DS    A                  S1 SYSIMAGE ROW BUFFER                00890000
                                                                        00900000
$SYSNAV  DS    0D,XL(TRECAUXL+SNAVLN)                                   00910000
                                                                        00920000
STATREGS DS    3F                 R15-R1 COMPLETION STATUS              00930000
REGSAVE  DS    16F                LOCAL REGISTER SAVEAREA               00940000
WK256    DS    XL256              GENERAL PURPOSE WORKAREA              00950000
                                                                        00960000
         #ENDWORK ,                                                     00970000
                                                                        00980000
         EJECT                                                          00990000
         ICATALOG NAVIGATION,IMAGE,SKS                                  01000000
                                                                        01010000
         EJECT                                                          01020000
         SESSIMAG ,               EMULATOR SESS / RECORDING AREA        01030000
                                                                        01040000
         EJECT                                                          01050000
         IPROJ ,                  PROJECT CONTROL BLOCK                 01060000
                                                                        01070000
         EJECT                                                          01080000
         TRECAUX ,                TEMP TABLE FOR CANDIDATE RECORDINGS   01090000
                                                                        01100000
         EJECT                                                          01110000
         ABCODES ,                                                      01120000
         EQUS  ,                                                        01130000
                                                                        01140000
         TBSERVIS ADD,PRINT=NOGEN                                       01150000
                                                                        01160000
         EJECT                                                          01170000
IRECADD  #ENTER PREG=R8                                                 01180000
                                                                        01190000
         USING ICVT,R11           STDENV                                01200000
         USING ITASK,R10                                                01210000
         USING IPCB,R9            PROCESS MODE                          01220000
         L     R9,TSKPCBC                                               01230000
                                                                        01240000
*--------------------------------------------------------------         01250000
*   FETCH PARAMETERS, VALIDATE REQUEST SEQUENCE                         01260000
*--------------------------------------------------------------         01270000
         USING SESSIMAG,R8        LIFE OF FUNCTION                      01280000
         TM    SEIRECFL,SEIR_ACT  RECORDING ACTIVE?                     01290000
         BNO   ERR_SEQ            REJECT REQUEST IF NOT                 01300000
                                                                        01310000
         EJECT ,                                                        01320000
***************************************************************         01330000
*                                                                       01340000
*    GENERATE SYSSKS FOR STORED KEYSTROKE SEQUENCE IF DEFINED           01350000
*                                                                       01360000
***************************************************************         01370000
         ICM   R4,15,SEISKSA      SKS ROW PENDING WRITE?                01380000
         BZ    NOSKS              SKIP IF NOT                           01390000
         TM    SEIRECFL,SEIR_P+SEIR_S   RECORDING STARTING/STOPPING?    01400000
         BNZ   NOS1               NO SKS CAPTURE IF SO                  01410000
                                                                        01420000
         USING TRECAUX,R4         STORED IN INTERMEDIATE FORMAT         01430000
         LA    R5,TRECAUX+TRECAUXL                                      01440000
         USING SYSSKS,R5          MAP CATALOG FORMATTED ROW             01450000
                                                                        01460000
         MVC   TRECTYPE,=CL4'SSKS'                                      01470000
         ST    R5,TRECVARX+4      ENTIRE SYSSKS CAST AS VARX            01480000
         LA    R2,SSKSLN          FIXED LENGTH OF SYSSKS                01490000
         ST    R2,SSKSCRPT+4      CARRY SYSSKS SCRIPT ADDR AS OFFSET    01500000
         A     R2,SSKSCRPT+0      PLUS LENGTH OF SCRIPT                 01510000
         ST    R2,TRECVARX+0      IS TOTAL LENGTH OF SYSSKS VARX        01520000
                                                                        01530000
         LA    R1,TRECAUX         ROW COMPLETE                          01540000
         BAS   R14,POSTREC        ADD TO CANDIDATE RECORDING            01550000
         DROP  R4,R5              TRECAUX, SYSIAMGE                     01560000
                                                                        01570000
NOSKS    DS    0H                                                       01580000
                                                                        01590000
         EJECT ,                                                        01600000
***************************************************************         01610000
*                                                                       01620000
*    GENERATE SYSIMAGE ENTRY FOR LAST IMAGE PROVIDED TO THE             01630000
*    EMULATOR.  THIS IMAGE IS REGARDED AS THE "STABLE STATE"            01640000
*    DISCUSSED IN THE PROLOG.                                           01650000
*                                                                       01660000
***************************************************************         01670000
         TM    SEIS1ATR,SEIA_CLR+SEIA_RSP   ANYTHING TO RECORD?         01680000
         BNZ   NOS1               NO IMAGE CAPTURE OTHERWISE            01690000
         TM    SEISTATE,SEIS_TUS  TRANSITION TO VTAM?                   01700000
         BO    NOS1               NO IMAGE CAPTURE IF SO                01710000
         TM    SEIRECFL,SEIR_P    RECORDING STOPPED?                    01720000
         BO    NOS1               NO IMAGE CAPTURE IF SO                01730000
         ICM   R1,15,SEIS1SIZ     S1 IMAGE POSTED?                      01740000
         BZ    NOS1               SKIP IF NOT                           01750000
                                                                        01760000
         LH    R2,SEIS1ROW        # ROWS AS FWORD                       01770000
         LH    R3,SEIS1COL        # COLS AS FWORD                       01780000
                                                                        01790000
         @CALL IRECIMGO,((R2),(R3),*SEISICSR,*SEIS1IMG,TRECAUXL),      X01800000
               CTYPE=CVT,MF=(E,MFE_LIST)                                01810000
                                                                        01820000
         ST    R1,S1IMGROW        S1 SYSIMAGE ROW BUFFER                01830000
         LR    R4,R1              ADDRESSABILITY TO ENTRY               01840000
         USING TRECAUX,R4         ROW PREFIX FORMAT                     01850000
         LR    R5,R0              SYSIMAGE ENTRY ORIGIN                 01860000
         USING SYSIMAGE,R5        MAPPED                                01870000
                                                                        01880000
         MVC   TRECTYPE,=CL4'SIMG'                                      01890000
         ST    R5,TRECVARX+4      ENTIRE SYSIMAGE CAST AS VARX          01900000
         LA    R2,SIMGLN          FIXED LENGTH OF SYSIMAGE              01910000
         ST    R2,SIMGBUFR+4      CARRY VARX SCRIPT ADDR AS OFFSET      01920000
         A     R2,SIMGBUFR+0      PLUS LENGTH OF SCREEN REPRESENTATION  01930000
         ST    R2,TRECVARX+0      IS TOTAL LENGTH OF SYSIMAGE VARX      01940000
                                                                        01950000
         LA    R1,TRECAUX         ROW COMPLETE                          01960000
         BAS   R14,POSTREC        ADD TO CANDIDATE RECORDING            01970000
         DROP  R4,R5              TRECAUX, SYSIAMGE                     01980000
                                                                        01990000
NOS1     DS    0H                                                       02000000
                                                                        02010000
         EJECT ,                                                        02020000
***************************************************************         02030000
*                                                                       02040000
*    GENERATE INTERMEDIATE SYSNAVIGATION ENTRY                          02050000
*                                                                       02060000
***************************************************************         02070000
         LA    R4,$SYSNAV         SYSNAVIGATION CONSTRUCTION AREA       02080000
         USING TRECAUX,R4         STORED IN INTERMEDIATE FORMAT         02090000
         LA    R5,TRECAUX+TRECAUXL                                      02100000
         USING SNAVSECT,R5        MAP CATALOG FORMATTED ROW             02110000
         XC    SNAVSECT(SNAVLN),SNAVSECT                                02120000
                                                                        02130000
         MVC   TRECTYPE,=CL4'SNAV'                                      02140000
         ST    R5,TRECVARX+4      ENTIRE SYSSKS CAST AS VARX            02150000
         LA    R2,SNAVLN          FIXED LENGTH OF SYSNAVIGATION         02160000
         ST    R2,TRECVARX+0      IS TOTAL LENGTH OF OUTER VARX         02170000
                                                                        02180000
         EJECT                                                          02190000
***************************************************************         02200000
*                                                                       02210000
*   CONSTRUCT SYSNAVIGATION ROW PROPER                                  02220000
*                                                                       02230000
***************************************************************         02240000
         MVC   SNAVSREC,SEIRECNM  RECORDING NAME                        02250000
         MVI   SNAVSSET,C' '      CLEAR SCREEN SET NAME                 02260000
         MVC   SNAVSSET+1(L'SNAVSSET-1),SNAVSSET                        02270000
                                                                        02280000
         TM    SEIRECFL,SEIR_P+SEIR_S   RECORDING STARTING/STOPPING?    02290000
         BNZ   NOXITION           NO TRANSITIONAL INFO APPLIES          02300000
                                                                        02310000
         MVC   SNAVAID,SEISIAID   AID KEY INITIATING TRANSITION         02320000
         MVC   SNAVCSRP,SEISICSR  CURSOR POSITION AT AID TIME           02330000
         TM    SEISTATE,SEIS_USO  STN MODEL VIOLATION FLAGGED?          02340000
         BNO   NOXITION           SKIP IF NOT                           02350000
         OI    SNAVFLG1,SNV1USO   RETAIN ERROR INDICATION IN RECORDING  02360000
         MVC   SNAVUSO#,SEISUSO#  NUMBER OF APPL IMAGES DISCARDED       02370000
                                                                        02380000
NOXITION DS    0H                                                       02390000
                                                                        02400000
*--------------------------------------------------------------         02410000
*   SYSNAVIGATION S0 REPRESENTS LAST IMAGE PROVIDED TO PC               02420000
*--------------------------------------------------------------         02430000
         MVC   SNAVFLG0,SEIS0ATR  IMAGE ATTRIBUTES                      02440000
                                                                        02450000
         TM    SEISTATE,SEIS_FUS  TRANSITIONING FROM VTAM INTO APPL?    02460000
         BNO   NVTMS0             ELSEWHERE IF NOT                      02470000
         MVC   SNAVLSCR,@VTAM     ELSE SPECIAL STATE TAG                02480000
         OI    SNAVFLG0,SNV0USS   TRANSITION IS FROM USS                02490000
         B     ENAV0              S0 POST COMPLETE                      02500000
                                                                        02510000
NVTMS0   DS    0H                                                       02520000
         TM    SEIRECFL,SEIR_S    RECORDING JUST STARTING?              02530000
         BNO   NRECS0             SKIP IF NOT                           02540000
         MVC   SNAVLSCR,@STARTED  SPECIAL TAG IF SO                     02550000
         B     ENAV0              S0 POST COMPLETE                      02560000
                                                                        02570000
NRECS0   DS    0H                                                       02580000
         TM    SEIS0ATR,SEIA_RSP  INPUT A DELTA AGAINST APPL OUTPUT?    02590000
         BNO   STDS0              SKIP IF SO                            02600000
         OI    SNAVFLG0,SNV0RSP   APPL HAS NOT SENT TO THE VDEVICE      02610000
                                                                        02620000
STDS0    DS    0H                                                       02630000
         L     R1,SEIMAGES        EXTERNAL IDENTIFIER FOR THIS IMAGE    02640000
         STH   R1,SNAVLNO#        IDENTIFIES SYSIMAGE LATER             02650000
                                                                        02660000
ENAV0    DS    0H                                                       02670000
                                                                        02680000
*--------------------------------------------------------------         02690000
*   SYSNAVIGATION S1 REPRESENTS HOST RESPONSE / ACCEPTANCE              02700000
*--------------------------------------------------------------         02710000
         TM    SEIRECFL,SEIR_P    RECORDING STOPPED?                    02720000
         BNO   NONPS1             ELSEWHERE IF NOT                      02730000
         MVC   SNAVRSCR,@STOPPED  ELSE SPECIAL STATE TAG                02740000
         OI    SNAVFLG1,SNV1END   RECORDING STOPPED                     02750000
         B     ENAV1                                                    02760000
                                                                        02770000
NONPS1   DS    0H                                                       02780000
         TM    SEISTATE,SEIS_ERR  TERMINATION DUE TO SESS MGMT ERROR?   02790000
         BNO   NONPS2             ELSEWHERE IF NOT                      02800000
         MVC   SNAVRSCR,@FAILED   ELSE SPECIAL STATE TAG                02810000
         OI    SNAVFLG1,SNV1END   RECORDING STOPPED                     02820000
         B     ENAV1                                                    02830000
                                                                        02840000
NONPS2   DS    0H                                                       02850000
         MVC   SNAVFLG1,SEIS1ATR  IMAGE ATTRIBUTES                      02860000
         TM    SEISTATE,SEIS_TUS  TRANSITIONING FROM APPL INTO VTAM?    02870000
         BNO   NVTMS1             ELSEWHERE IF NOT                      02880000
         MVC   SNAVRSCR,@VTAM     ELSE SPECIAL STATE TAG                02890000
         OI    SNAVFLG1,SNV1USS   TRANSITIONING TO USS                  02900000
         B     ENAV1                                                    02910000
                                                                        02920000
NVTMS1   DS    0H                                                       02930000
         TM    SEIS1ATR,SEIA_RSP  INPUT A DELTA AGAINST APPL OUTPUT?    02940000
         BNO   STDS1              SKIP IF SO                            02950000
         OI    SNAVFLG1,SNV1RSP   APPL HAS NOT SENT TO THE VDEVICE      02960000
                                                                        02970000
STDS1    DS    0H                                                       02980000
         L     R1,SEIMAGES        EXTERNAL IDENTIFIER FOR THIS IMAGE    02990000
         LA    R1,1(,R1)          UPDATE PLACEHOLDER ACCORDINGLY        03000000
         ST    R1,SEIMAGES        SAVE UPDATED IDENTIFIER               03010000
         STH   R1,SNAVRNO#        IMAGE IDENTIFIER                      03020000
                                                                        03030000
ENAV1    DS    0H                                                       03040000
                                                                        03050000
*--------------------------------------------------------------         03060000
*   WRITE COMPLETED SYSNAVIGATION ROW                                   03070000
*--------------------------------------------------------------         03080000
         ICM   R0,15,SEIAUX#      FIRST SYSNAV ENTRY?                   03090000
         BNZ   NAVPOST            SKIP IF NOT                           03100000
         TM    SNAVFLG1,SNV1USS   TRANSITION TO USS?                    03110000
         BO    ERR_INFO           REJECT IF SO                          03120000
         TM    SEIRECFL,SEIR_P    RECORDING STOPPED?                    03130000
         BO    ERR_INFO           REJECT IF SO                          03140000
                                                                        03150000
NAVPOST  DS    0H                                                       03160000
         LA    R1,TRECAUX         ROW COMPLETE                          03170000
         BAS   R14,POSTREC        ADD TO CANDIDATE RECORDING            03180000
         DROP  R4,R5              TRECAUX, SYSIAMGE                     03190000
                                                                        03200000
         EJECT ,                                                        03210000
***************************************************************         03220000
*                                                                       03230000
*   RETURN COMPLETION STATUS TO REQUESTOR                               03240000
*                                                                       03250000
***************************************************************         03260000
         LA    R15,RC00           NORMAL COMPLETION                     03270000
         SR    R0,R0              REASON CODE NOT DEFINED               03280000
         SR    R1,R1              INFO CODE NOT DEFINED                 03290000
         B     CLEANUP            DONE                                  03300000
                                                                        03310000
ERR_INFO DS    0H                 ENTRY NOT MEANINGFUL IN CONTEXT       03320000
         LA    R15,RC04           USELESS RECORDING                     03330000
         SR    R0,R0              REASON CODE NOT DEFINED               03340000
         SR    R1,R1              INFO CODE NOT DEFINED                 03350000
         B     CLEANUP                                                  03360000
                                                                        03370000
ERR_SEQ  DS    0H                 RECORDING NOT ACTIVE                  03380000
         LA    R15,RC08           REQUEST IN ERROR                      03390000
         SR    R0,R0              REASON CODE NOT DEFINED               03400000
         SR    R1,R1              INFO CODE NOT DEFINED                 03410000
         B     CLEANUP                                                  03420000
                                                                        03430000
*--------------------------------------------------------------         03440000
*   RELEASE RECORDING DATA AREAS                                        03450000
*--------------------------------------------------------------         03460000
CLEANUP  DS    0H                                                       03470000
         STM   R0,R15,STATREGS    SAVE STATUS REGS                      03480000
                                                                        03490000
         ICM   R2,15,S1IMGROW     S0 SYSIMAGE ROW BUFFER ALLOCATED?     03500000
         BZ    NOS0ROW            SKIP IF NOT                           03510000
                                                                        03520000
         $RETSTOR (R2)                                                  03530000
                                                                        03540000
NOS0ROW  DS    0H                                                       03550000
                                                                        03560000
         ICM   R2,15,SEISKSA      SYSSKS ROW BUFFER ALLOCATED?          03570000
         BZ    NOSKSROW           SKIP IF NOT                           03580000
         LA    R0,SEISKSRS        LOCATE DEDICATED SKS WORKAREA         03590000
         CR    R2,R0              AUX STORAGE USED?                     03600000
         BE    NOSKSROW           SKIP IF NOT                           03610000
                                                                        03620000
         $RETSTOR (R2)                                                  03630000
                                                                        03640000
NOSKSROW DS    0H                                                       03650000
         XC    SEISKSA,SEISKSA    SKS NO LONGER PENDING                 03660000
         NI    SEIRECFL,FF-SEIR_S RECORDING IN PROGRESS                 03670000
                                                                        03680000
*--------------------------------------------------------------         03690000
*   RETURN COMPLETION STATUS TO CALLER                                  03700000
*--------------------------------------------------------------         03710000
EXIT     DS    0H                                                       03720000
         LM    R15,R1,STATREGS    RESTORE COMPLETION STATUS             03730000
                                                                        03740000
         #EXIT ,                                                        03750000
                                                                        03760000
         EJECT                                                          03770000
***************************************************************         03780000
*                                                                       03790000
*   CATASTROPHIC FAILURES                                               03800000
*                                                                       03810000
***************************************************************         03820000
ABN_TBSV DS    0H                 CATALOG / TABLE SERVICE FAILURE       03830000
                                                                        03840000
         $ABEND ABE_TBSERV,DUMP=YES,                                   X03850000
               TITLE='TABLE SERVICE FAILURE'                            03860000
                                                                        03870000
         EJECT                                                          03880000
***************************************************************         03890000
*                                                                       03900000
* ROUTINE: POSTREC - ADD CANDIDATE RECORDING ROW TO TEMP TABLE          03910000
*                                                                       03920000
* ON ENTRY:                                                             03930000
*                                                                       03940000
*    R1 - ADDR OF TABLE-READY ROW                                       03950000
*                                                                       03960000
***************************************************************         03970000
POSTREC  DS    0H                                                       03980000
         STM   R0,R15,REGSAVE     SAVE MAINLINE REGS                    03990000
         LR    R2,R1              TABLE READY ROW                       04000000
                                                                        04010000
         TBADD (R2),              ADD IMAGE TO CANDIDATE RECORDING     X04020000
               TTOKEN=SEIAUXTK,                                        X04030000
               MF=(E,MFE_LIST)                                          04040000
                                                                        04050000
         CH    R15,=AL2(RC08)     REQUEST COMPLETE?                     04060000
         BNL   ABN_TBSV           SERIOUS PROBLEM IF NOT                04070000
                                                                        04080000
         L     R1,SEIAUX#         # CANDIDATE RECORDING ROWS            04090000
         LA    R1,1(,R1)          ACCOUNT FOR THIS REQUEST              04100000
         ST    R1,SEIAUX#         SAVE UPDATED COUNT                    04110000
                                                                        04120000
         SR    R15,R15            RETURN CODES NOT DEFINED              04130000
         LM    R0,R14,REGSAVE     RESTORE MAINLINE REGS                 04140000
         BR    R14                RETURN                                04150000
                                                                        04160000
         EJECT                                                          04170000
***************************************************************         04180000
*                                                                       04190000
*   LOCAL READ-ONLY DATA AREAS                                          04200000
*                                                                       04210000
***************************************************************         04220000
@STARTED DC    CL16'*STARTED*'                                          04230000
@STOPPED DC    CL16'*STOPPED*'                                          04240000
@FAILED  DC    CL16'*FAILED*'                                           04250000
@VTAM    DC    CL16'*VTAM*'                                             04260000
                                                                        04270000
         LTORG ,                                                        04280000
                                                                        04290000
         EJECT                                                          04300000
         PRINT NOGEN                                                    04310000
         ICVT  ,                                                        04320000
         ITASK ,                                                        04330000
         IPCB  ,                                                        04340000
         END   ,                                                        04350000
