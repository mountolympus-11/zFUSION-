IIMGDIAG TITLE '- GENERATE DIAGNOSTIC MSGS FOR IMAGE (IIMG) ERRORS'     00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: IIMGDIAG - GENERATE DIAGNOSTIC MSGS FOR IMAGE ERRORS         00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE MAY BE USED TO DOCUMENT A PROBLEM ENCOUNTERED         00080000
*    BY THE IMAGE FUNCTIONS, IMGPREP AND IMGCMP IN PARTICULAR.          00090000
*    IT RETURNS A MESSAGE SEGMENT TEXT ORIGIN AND LENGTH.               00100000
*                                                                       00110000
* ON ENTRY:                                                             00120000
*                                                                       00130000
*    R1 CONTAINS THE REASON CODE ASSOCIATED WITH THE FAILING            00140000
*       IMAGE FUNCTION                                                  00150000
*                                                                       00160000
*                                                                       00170000
* ON EXIT:                                                              00180000
*                                                                       00190000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00200000
*                                                                       00210000
*       RC00 - STANDARD IMAGE FUNCTION RSNCODE WAS PRESENTED            00220000
*       RC04 - UNKNOWN IMAGE FUNCTION RSNCODE WAS PRESENTED             00230000
*                                                                       00240000
*    R1  - ADDR OF A MESSAGE TEXT SEGMENT (IN STATIC STORAGE)           00250000
*    R0  - MESSAGE TEXT SEGMENT LENGTH                                  00260000
*                                                                       00270000
**<DOC-OFF>****************************************************         00280000
                                                                        00290000
         EJECT                                                          00300000
         CMPINFO ,                IMAGE FUNCTION RETCODES (INFO ONLY)   00310000
                                                                        00320000
         EJECT                                                          00330000
         EQUS  ,                                                        00340000
                                                                        00350000
         EJECT ,                                                        00360000
IIMGDIAG #ENTER PREG=R8,SAVE=NO                                         00370000
                                                                        00380000
         USING ITASK,R10          PROCESS MODE                          00390000
                                                                        00400000
         EJECT                                                          00410000
*--------------------------------------------------------------         00420000
*   FETCH PASSED PARAMETERS, REQUESTOR MAY PROVIDE $MSGBUF AREA         00430000
*--------------------------------------------------------------         00440000
         LA    R15,RC04           ASSUME RSNCODE NOT DEFINED            00450000
         LA    R2,UNKNOWN         SELECT AN APPROPRIATE MSG             00460000
         LTR   R1,R1              ANALYZE IMAGE RSNCODE                 00470000
         BNP   RETMSG             UNKNOWN                               00480000
         C     R1,=A(CIRSHWM)     RSNCODE EXCEEDS HIGHEST DEFINED?      00490000
         BH    RETMSG             UNKNOWN                               00500000
                                                                        00510000
         MH    R1,=AL2($MSGLEN)   CONVERT RSN CODE TO MSG OFFSET        00520000
         LA    R2,$MSGTAB(R1)     ADDRESS OF MSG                        00530000
         LA    R15,RC00           INDICATE RSNCODE RECOGNIZED           00540000
                                                                        00550000
*--------------------------------------------------------------         00560000
*   RETURN APPROPRIATE MSG                                              00570000
*--------------------------------------------------------------         00580000
RETMSG   DS    0H                                                       00590000
         LR    R1,R2              RETURN MESSAGE TEXT                   00600000
         LA    R0,$MSGLEN         LENGTH OF ALL MESSAGES                00610000
                                                                        00620000
         #EXIT ,                  RETURN TO REQUESTOR                   00630000
                                                                        00640000
         EJECT ,                                                        00650000
***************************************************************         00660000
*                                                                       00670000
*   LOCAL READ ONLY DATA AREAS, ETC.                                    00680000
*                                                                       00690000
***************************************************************         00700000
$MSGTAB  DC    CL36'image function completed normally  '  RSN00         00710000
         DC    CL36'unable to acquire storage          '  RSN01         00720000
         DC    CL36'image missing REQUIRED regions     '  RSN02         00730000
         DC    CL36'image missing IDENTIFICATION region'  RSN03         00740000
         DC    CL36'cannot compare LINE MODE image(s)  '  RSN04         00750000
         DC    CL36'protected 3270 fields do not match '  RSN05         00760000
         DC    CL36'image sizes are not identical      '  RSN06         00770000
         DC    CL36'images are identical               '  RSN07         00780000
         DC    CL36'image(s) presented in non-std form '  RSN08         00790000
         DC    CL36'unreconcilable region definitions  '  RSN09         00800000
         DC    CL36'image is clear                     '  RSN10         00810000
         DC    CL36'unable to region-tile the image    '  RSN11         00820000
                                                                        00830000
UNKNOWN  DC    CL36'unknown image function completion  '                00840000
                                                                        00850000
$MSGLEN  EQU   L'$MSGTAB                                                00860000
                                                                        00870000
                                                                        00880000
*--------------------------------------------------------------         00890000
                                                                        00900000
         LTORG ,                                                        00910000
                                                                        00920000
         EJECT                                                          00930000
         PRINT NOGEN                                                    00940000
         ICVT  ,                                                        00950000
         ITASK ,                                                        00960000
         END   ,                                                        00970000
