IVTMSREQ TITLE 'INTEGRATOR - ISESS $SESS REQUEST PROCESSOR'             00010000
**<DOC-ON>************************************************************* 00020000
*                                                                       00030000
* ROUTINE: IVTMSREQ - ISESS $SESS REQUEST PROCESSOR                     00040000
*                                                                       00050000
* DESCRIPTION: THIS ROUTINE IS CALLED BY IVTMSESS TO PROCESS THE        00060000
*              $SESS REQUEST WORK ELEMENT.                              00070000
*                                                                       00080000
* ON ENTRY:                                                             00090000
*                                                                       00100000
*    R15 = ENTRY POINT ADDRESS                                          00110000
*    R14 = RETURN ADDRESS                                               00120000
*    R13 = AVAILABLE SAVE AREA                                          00130000
*    R11 = ICVT ADDRESS                                                 00140000
*    R10 = ITASK ADDRESS                                                00150000
*    R09 = IVTAMCVT ADDRESS                                             00160000
*    R08 = ISESS ADDRESS                                                00170000
*    R01 = ADDRESS OF $SESS REQUEST WORK ELEMENT (IWEXG)                00180000
*                                                                       00190000
* ON EXIT:                                                              00200000
*                                                                       00210000
*    R15 = 0                                                            00220000
*    R00 = 0                                                            00230000
*    R01 = 0                                                            00240000
*                                                                       00250000
*    ALL OTHER REGISTERS ARE RESTORED.                                  00260000
*                                                                       00270000
**<DOC-OFF>************************************************************ 00280000
                                                                        00290000
         EJECT ,                                                        00300000
*********************************************************************** 00310000
*                                                                       00320000
* MAINTENANCE:                                                          00330000
*                                                                       00340000
*   08/01/93 RANDY WITEK                                                00350000
*   07/01/94 RANDY WITEK - LU6.2 SUPPORT                                00360000
*   05/30/95 RANDY WITEK - FIX FORMATTED INDICATOR ON RESPONSES         00370000
*   06/01/95 RANDY WITEK - USE SDT=APPL FOR SLU SESSIONS                00380000
*                                                                       00390000
*********************************************************************** 00400000
                                                                        00410000
         EQUS  ,                  GENERAL EQUATES                       00420000
                                                                        00430000
RICVT    EQU   R11                                                      00440000
RITASK   EQU   R10                                                      00450000
RIVTAM   EQU   R9                                                       00460000
RISESS   EQU   R8                                                       00470000
RIACB    EQU   R7                                                       00480000
RSPLIST  EQU   R6                                                       00490000
RIRPL    EQU   R5                                                       00500000
RIWE     EQU   R4                                                       00510000
                                                                        00520000
         USING ICVT,RICVT         ESTABLISH ADDRESSABILITY              00530000
         USING ITASK,RITASK       ESTABLISH ADDRESSABILITY              00540000
         USING IVTAMCVT,RIVTAM    ESTABLISH ADDRESSABILITY              00550000
         USING ISESS,RISESS       ESTABLISH ADDRESSABILITY              00560000
         USING IACB,RIACB         ESTABLISH ADDRESSABILITY              00570000
         USING IRPL,RIRPL         ESTABLISH ADDRESSABILITY              00580000
         USING ISTDBIND,ISEBIND   ESTABLISH ADDRESSABILITY              00590000
         USING SPLIST,RSPLIST     ESTABLISH ADDRESSABILITY              00600000
         USING IWEVTAM,RIWE       ESTABLISH ADDRESSABILITY              00610000
                                                                        00620000
WORKAREA #WORK ,                  READ/WRITE WORKAREA                   00630000
WRK256   DS    XL256              GENERAL WORKAREA                      00640000
SUB0SAVE DS    18F                SUBROUTINE SAVE AREA                  00650000
RETR15   DS    F                                                        00660000
RETR0    DS    F                                                        00670000
RETR1    DS    F                                                        00680000
RETREGS  EQU   RETR15,*-RETR15    INCLUSIVE SYMBOL                      00690000
FLAG     DS    X                                                        00700000
FLGRQSND EQU   X'80'                                                    00710000
FLGRQRSP EQU   X'40'                                                    00720000
WORKLEN  #ENDWORK                 END OF WORKAREA                       00730000
                                                                        00740000
         $MSGDFT PREFIX=ICTPID,                                        +00750000
               COMPID='VTM',                                           +00760000
               TABLE=*#MSGS,                                           +00770000
               WORKA=0,                                                +00780000
               MF=(E,WRK256),                                          +00790000
               PRINT=NOGEN                                              00800000
                                                                        00810000
IVTMSREQ #ENTER BASE=R12,         ENTRY LINKAGE                        +00820000
               PREG=RIWE,                                              +00830000
               AMODE=31,                                               +00840000
               RMODE=ANY                                                00850000
                                                                        00860000
         L     RSPLIST,IWEXGLST   ADDRESS OF THE $SESS PARAMETER LIST   00870000
         L     RIACB,ISEACB@      SESSION ACB ADDRESS                   00880000
                                                                        00890000
*---------------------------------------------------------------------- 00900000
* LOOKUP $SESS FUNCTION IN TABLE AND JUMP TO PROCESSING ROUTINE         00910000
*---------------------------------------------------------------------- 00920000
                                                                        00930000
         LA    R1,FTABLE          BEGINNING OF TABLE                    00940000
         LA    R2,L'FTABNTRY      LENGTH OF AN ENTRY                    00950000
         LA    R3,FTABLAST        ADDRESS OF LAST ENTRY                 00960000
                                                                        00970000
FUNCLOOK DS    0H                                                       00980000
                                                                        00990000
         CLC   SPLFUNC,0(R1)      FOUND TABLE ENTRY?                    01000000
         BE    FUNCFIND           BRANCH IF YES                         01010000
         BXLE  R1,R2,FUNCLOOK     CHECK THE NEXT ENTRY                  01020000
         B     POSTFUNC           FUNCTION CODE ERROR                   01030000
                                                                        01040000
FTABLE   DS    0F                                                       01050000
         DC    A($SESS_RECEIVE,RECEIVE)                                 01060000
FTABNTRY EQU   FTABLE,*-FTABLE                                          01070000
         DC    A($SESS_SEND_DATA,SENDDATA)                              01080000
         DC    A($SESS_SEND_POSRESP,SENDPRSP)                           01090000
         DC    A($SESS_SEND_NEGRESP,SENDNRSP)                           01100000
         DC    A($SESS_SEND_SIGNAL,SENDSIG)                             01110000
         DC    A($SESS_SEND_BID,SENDBID)                                01120000
         DC    A($SESS_SEND_LUSTAT,SENDLUS)                             01130000
         DC    A($SESS_SEND_CANCEL,SENDCAN)                             01140000
         DC    A($SESS_SEND_RTR,SENDRTR)                                01150000
         DC    A($SESS_SEND_CHASE,SENDCHA)                              01160000
         DC    A($SESS_SEND_SDT,SENDSDT)                                01170000
         DC    A($SESS_SEND_CLEAR,SENDCLR)                              01180000
         DC    A($SESS_SEND_BIS,SENDBIS)                                01190000
         DC    A($SESS_SEND_SHUTD,SENDSHTD)                             01200000
         DC    A($SESS_SEND_SHUTC,SENDSHTC)                             01210000
         DC    A($SESS_SEND_RSHUTD,SENDRSHT)                            01220000
         DC    A($SESS_SEND_RELQ,SENDRELQ)                              01230000
         DC    A($SESS_SEND_QEC,SENDQEC)                                01240000
         DC    A($SESS_SEND_QC,SENDQC)                                  01250000
         DC    A($SESS_SEND_SBI,SENDSBI)                                01260000
         DC    A($SESS_SEND_STSN,SENDSTSN)                              01270000
         DC    A($SESS_SEND_RQR,SENDRQR)                                01280000
         DC    A($SESS_END_SESSION,ENDSESS)                             01290000
FTABLAST EQU   *-L'FTABNTRY                                             01300000
                                                                        01310000
FUNCFIND DS    0H                                                       01320000
                                                                        01330000
         L     R15,4(,R1)         PROCESSING ROUTINE ADDRESS            01340000
         BASR  R14,R15            JUMP TO PROCESSING ROUTINE            01350000
                                                                        01360000
*---------------------------------------------------------------------- 01370000
* $SESS_RECEIVE                                                         01380000
*---------------------------------------------------------------------- 01390000
                                                                        01400000
RECEIVE  DS    0H                                                       01410000
                                                                        01420000
         TM    ISEF1,ISEF1TRM     IS TERMINATION UNDERWAY?              01430000
         BO    POSTCANC           BRANCH IF YES TO REJECT REQUEST       01440000
         OC    ISERQRCV,ISERQRCV  IS A RECEIVE ALREADY ACTIVE?          01450000
         BNZ   POSTBUSY           BRANCH IF RECEIVE IS BUSY             01460000
         ST    RSPLIST,ISERQRCV   QUEUE THE ACTIVE RECEIVE              01470000
         L     R15,IVT@SREC       EP OF THE $SESS_RECEIVE PROCESSOR     01480000
         BASR  R14,R15            CALL THE $SESS RECEIVE PROCESSOR      01490000
         B     RETURN             AND EXIT WORK ELEMENT PROCESSING      01500000
                                                                        01510000
*---------------------------------------------------------------------- 01520000
* $SESS_SEND_DATA                                                       01530000
*---------------------------------------------------------------------- 01540000
                                                                        01550000
SENDDATA DS    0H                                                       01560000
                                                                        01570000
         BAS   R14,SENDCHEK       POST WITH ERROR IF A SEND IS ACTIVE   01580000
                                                                        01590000
         BAS   R14,GETRPL         OBTAIN A SEND RPL                     01600000
         MVC   RPLURH(3),SPLRH    SET THE REQUEST HEADER                01610000
         MVC   RPLAREA(4),SPLAREA SET THE DATA ADDRESS                  01620000
         MVC   RPLRLEN(4),SPLAREAL SET THE DATA LENGTH                  01630000
         L     R2,ISECID          SESSION CID                           01640000
         TM    ISEF3,ISEF3CHN     IS CHAINING ALLOWED?                  01650000
         BNO   SENDNCHN           BRANCH IF NOT                         01660000
         L     R15,=A(SENXDATA)   ADDRESS OF EXTENSION ROUTINE          01670000
         BASR  R14,R15            LINK TO ROUTINE                       01680000
         B     SENDCKP1           COMPLETE PHASE-1 PROCESSING & RETURN  01690000
                                                                        01700000
SENDNCHN DS    0H                                                       01710000
                                                                        01720000
         ICM   R3,15,SPLAREAL     DATA LENGTH                           01730000
         LH    R1,ISESRUSZ        MAXIMUM SEND RU SIZE                  01740000
         CR    R3,R1              WILL ONE RU DO IT?                    01750000
         BNH   SEND1RU            BRANCH IF YES                         01760000
         ST    R1,RPLRLEN         TRUNCATE THE SEND                     01770000
                                                                        01780000
         $MSG  968,               "SEND TRUNCATED..."                  +01790000
               FIELDS=((RISESS),     ISESS ADDRESS                     +01800000
               (ISETKUSR,4),         IVUSER TOKEN                      +01810000
               (ISETKSES,4),         ISESS  TOKEN                      +01820000
               (RITASK),             ITASK ADDRESS                     +01830000
               (TSKPCBC,4),          IPROC ADDRESS                     +01840000
               (TSKNAME,8),          ITASK NAME                        +01850000
               (R3),                 REQUESTED RU SIZE                 +01860000
               (RPLRLEN,4))          TRUNCATED RU SIZE                  01870000
                                                                        01880000
SEND1RU  DS    0H                                                       01890000
                                                                        01900000
         L     R15,=A(SENXNCHN)   ADDRESS OF EXTENSION ROUTINE          01910000
         BASR  R14,R15            LINK TO ROUTINE                       01920000
         B     SENDCKP1           COMPLETE PHASE-1 PROCESSING & RETURN  01930000
                                                                        01940000
*---------------------------------------------------------------------- 01950000
* $SESS_SEND_POSRESP                                                    01960000
*---------------------------------------------------------------------- 01970000
                                                                        01980000
SENDPRSP DS    0H                                                       01990000
                                                                        02000000
         BAS   R14,SENDRCHK       POST WITH ERROR IF A RESP IS ACTIVE   02010000
                                                                        02020000
*                                                                       02030000
* SET RESPONSE FLAG TO SHOW WE'VE BEEN THROUGH RESPONSE LOGIC           02040000
*---------------------------------------------------------------------- 02050000
                                                                        02060000
         OI    SPLRH0,RHQSRSP     SET RESPONSE FLAG                     02070000
                                                                        02080000
*                                                                       02090000
* IF THIS IS AN UNBIND RU, QUEUE UNBIND ACKNOWLEDGEMENT WE              02100000
*---------------------------------------------------------------------- 02110000
                                                                        02120000
         TM    SPLCNTDC,RPLTUNBD  UNBIND RU?                            02130000
         BO    UNBNDACK           BRANCH IF IT IS UNBIND                02140000
                                                                        02150000
*                                                                       02160000
* IF IT IS NOT A DFSYN RU JUST POST THE $SESS                           02170000
*---------------------------------------------------------------------- 02180000
                                                                        02190000
         TM    SPLCNTDF,RPLDATA+RPLCNCEL+RPLQC+RPLCHASE                 02200000
         BNZ   SENDRSCK           BRANCH IF NORMAL FLOW REQUEST         02210000
         TM    SPLCNTDC,RPLBID+RPLBIS+RPLLUS+RPLRTR                     02220000
         BNZ   SENDRSCK           BRANCH IF NOT A NORMAL FLOW REQUEST   02230000
         TM    SPLCNTSC,RPLSDT    ARE WE SENDING SDT RESPONSE?          02240000
         BO    ENDSTATE           BRANCH IF YES TO GO SEND IT           02250000
         B     SENDPOST           BRANCH TO POST THE REQUEST            02260000
                                                                        02270000
*                                                                       02280000
* IF BB FROM A CONTENTION LOSER IS BEING ACCEPTED...UPDATE THE STATE    02290000
* IF CD FROM A CONTENTION LOSER IS BEING ACCEPTED...UPDATE THE STATE    02300000
*---------------------------------------------------------------------- 02310000
                                                                        02320000
SENDRSCK DS    0H                                                       02330000
                                                                        02340000
         TM    ISEF2,ISEF2WIN      ARE WE THE WINNER?                   02350000
         BNO   ENDSTATE            BRANCH IF NOT, STATES WERE SET       02360000
         TM    SPLRH2,RHBBI        IS THIS A BB RU?                     02370000
         BZ    CHKDIR              BRANCH IF NOT, MAYBE DIR. CHANGE     02380000
         OI    ISES1,ISES1INB      SHOW INB                             02390000
         TM    SPLRH2,RHEBI+RHCEBI END OF BRACKET?                      02400000
         BZ    CHKDIR              BRANCH IF NOT                        02410000
         NI    ISES1,255-ISES1INB-ISES1DIR                              02420000
         B     ENDSTATE            AND WE ARE DONE                      02430000
                                                                        02440000
CHKDIR   DS    0H                                                       02450000
                                                                        02460000
         TM    ISEF3,ISEF3CD       DOES SESSION USE CD?                 02470000
         BNO   ENDSTATE            BRANCH IF NOT                        02480000
         TM    SPLRH2,RHCDI        DID WE GET DIRECTION?                02490000
         BNO   ENDSTATE            BRANCH IF NOT                        02500000
         OI    ISES1,ISES1DIR      SHOW DIRECTION IS OWNED              02510000
                                                                        02520000
ENDSTATE DS    0H                                                       02530000
                                                                        02540000
*                                                                       02550000
* IF EXCEPTION/NO RESPONSE WAS REQUESTED, JUST POST THE $SESS           02560000
*---------------------------------------------------------------------- 02570000
                                                                        02580000
         TM    SPLRH1,RHERI       EXCEPTION RESPONSE REQUESTED?         02590000
         BO    SENDPOST           BRANCH IF YES                         02600000
         TM    SPLRH1,RHDR1+RHDR2 WAS A DEFINITE RESPONSE REQUESTED?    02610000
         BZ    SENDPOST           BRANCH IF NOT                         02620000
                                                                        02630000
*                                                                       02640000
* CLEAR BRACKETS IF CEB IS BEING RESPONDED TO                           02650000
*---------------------------------------------------------------------- 02660000
                                                                        02670000
         TM    SPLRH2,RHCEBI      WAS THIS A CEB RU?                    02680000
         BNO   *+8                BRANCH IF NOT                         02690000
         NI    ISES1,255-ISES1INB-ISES1DIR                              02700000
                                                                        02710000
*                                                                       02720000
* ISSUE VTAM SEND TO SEND A POSITIVE RESPONSE                           02730000
*---------------------------------------------------------------------- 02740000
                                                                        02750000
         BAS   R14,GETRPL             OBTAIN A SEND RPL                 02760000
         MVC   RPLCNTRL(3),SPLCNTRL   SET THE RUTYPE FLAG               02770000
         MVC   RPLSEQNO(2),SPLSEQNO   SET THE SEQUENCE NUMBER           02780000
         MVC   RPLURH(3),SPLRH        SET THE REQUEST HEADER            02790000
         NI    RPLURH+0,B'11101111'   CLEAR RESERVED BIT                02800000
         OI    RPLURH+0,B'00000011'   ENSURE BC+EC ON                   02810000
         NI    RPLURH+1,B'10110011'   CLEAR RESERVED BITS               02820000
         MVI   RPLURH+2,B'00000000'   CLEAR RESERVED BITS               02830000
         TM    RPLURH+0,RHDFC+RHNC    IS THIS DFC, NC, OR SC?           02840000
         BNZ   PRSPFIOK               BRANCH IF YES                     02850000
         NI    RPLURH+0,255-RHFI      CLEAR FMD FORMATTED INDICATOR     02860000
                                                                        02870000
PRSPFIOK DS    0H                                                       02880000
                                                                        02890000
         L     R2,ISECID              SESSION CID                       02900000
         L     R15,=A(SENXRESP)       ADDRESS OF EXTENSION ROUTINE      02910000
         BASR  R14,R15                LINK TO ROUTINE                   02920000
         B     SENDCKP1           COMPLETE PHASE-1 PROCESSING & RETURN  02930000
                                                                        02940000
*---------------------------------------------------------------------- 02950000
* $SESS_SEND_NEGRESP                                                    02960000
*---------------------------------------------------------------------- 02970000
                                                                        02980000
SENDNRSP DS    0H                                                       02990000
                                                                        03000000
         BAS   R14,SENDRCHK       POST WITH ERROR IF A RESP IS ACTIVE   03010000
                                                                        03020000
*                                                                       03030000
* SET RESPONSE FLAG TO SHOW WE'VE BEEN THROUGH RESPONSE LOGIC           03040000
*---------------------------------------------------------------------- 03050000
                                                                        03060000
         OI    SPLRH0,RHQSRSP     SET RESPONSE FLAG                     03070000
                                                                        03080000
*                                                                       03090000
* IF THIS IS AN UNBIND RU, QUEUE UNBIND ACKNOWLEDGEMENT WE              03100000
*---------------------------------------------------------------------- 03110000
                                                                        03120000
         TM    SPLCNTDC,RPLTUNBD  UNBIND RU?                            03130000
         BO    UNBNDACK           BRANCH IF IT IS UNBIND                03140000
                                                                        03150000
*                                                                       03160000
* LOSE DIRECTION FOR RECOVERY IF APPROPRIATE                            03170000
*---------------------------------------------------------------------- 03180000
                                                                        03190000
         CLC   SPLSENSE(2),=X'0813' BID/BRACKET REJECT?                 03200000
         BE    SNRCVDON             BRANCH IF YES, DON'T CHANGE         03210000
         CLC   SPLSENSE(2),=X'0814' BID/BRACKET REJECT W/RTR ?          03220000
         BE    SNRCVDON             BRANCH IF YES, DON'T CHANGE         03230000
         CLC   SPLSENSE(2),=X'081B' BID/BRACKET REJECT SEND STATE?      03240000
         BE    SNRCVDON             BRANCH IF YES, DON'T CHANGE         03250000
                                                                        03260000
         TM    ISEF2,ISEF2SYM       SYMMETRIC RECOVERY?                 03270000
         BO    SNLOSECD             BRANCH IF YES                       03280000
         TM    ISEF2,ISEF2RCV       ARE WE THE NON-SYMMETRIC RECOVERER? 03290000
         BO    SNRCVDON             BRANCH IF YES                       03300000
                                                                        03310000
SNLOSECD DS    0H                                                       03320000
                                                                        03330000
         NI    ISES1,255-ISES1DIR   LOSE THE DIRECTION                  03340000
         B     SNRCVDON             DONE                                03350000
                                                                        03360000
SNRCVDON DS    0H                                                       03370000
                                                                        03380000
*                                                                       03390000
* IF A BID IS BEING REJECTED, CORRECT THE SESSION STATE                 03400000
*---------------------------------------------------------------------- 03410000
                                                                        03420000
         TM    SPLCNTDC,RPLBID    IS IT A BID?                          03430000
         BZ    SNNOTBID           BRANCH IF NOT A NORMAL FLOW REQUEST   03440000
         NI    ISES1,255-ISES1BBP RETRACT BEGIN BRACKET PENDING         03450000
                                                                        03460000
SNNOTBID DS    0H                                                       03470000
                                                                        03480000
*                                                                       03490000
* IF THE RESPONSE IS NOT FOR A DFSYN RU, JUST POST THE $SESS            03500000
*---------------------------------------------------------------------- 03510000
                                                                        03520000
         TM    SPLCNTDF,RPLDATA+RPLCNCEL+RPLQC+RPLCHASE                 03530000
         BNZ   SENDNRCK           BRANCH IF NORMAL FLOW REQUEST         03540000
         TM    SPLCNTDC,RPLBID+RPLBIS+RPLLUS+RPLRTR                     03550000
         BNZ   SENDNRCK           BRANCH IF NOT A NORMAL FLOW REQUEST   03560000
         TM    SPLCNTSC,RPLSDT    ARE WE SENDING SDT RESPONSE?          03570000
         BO    SENDNRCK           BRANCH IF YES TO GO SEND IT           03580000
         B     SENDPOST           BRANCH IF NOT A NORMAL FLOW REQUEST   03590000
                                                                        03600000
*                                                                       03610000
* IF NO RESPONSE WAS REQUESTED, JUST POST THE $SESS                     03620000
*---------------------------------------------------------------------- 03630000
                                                                        03640000
SENDNRCK DS    0H                                                       03650000
                                                                        03660000
         TM    SPLRH1,RHDR1+RHDR2+RHERI ANY TYPE OR RESPONSE REQUESTED? 03670000
         BZ    SENDPOST                 BRANCH IF NOT                   03680000
                                                                        03690000
         OI    SPLRH0,RHSDI             SET SENSE DATA FLAG             03700000
         OI    SPLRH1,RHERI             SEND A NEGATIVE RESPONSE        03710000
                                                                        03720000
*                                                                       03730000
* ISSUE VTAM SEND TO SEND NEGATIVE RESPONSE                             03740000
*---------------------------------------------------------------------- 03750000
                                                                        03760000
         BAS   R14,GETRPL             OBTAIN A SEND RPL                 03770000
         MVC   RPLCNTRL(3),SPLCNTRL   SET THE RUTYPE FLAG               03780000
         MVC   RPLSEQNO(2),SPLSEQNO   SET THE SEQUENCE NUMBER           03790000
         MVC   RPLURH(3),SPLRH        SET THE REQUEST HEADER            03800000
         NI    RPLURH+0,B'11101111'   CLEAR RESERVED BIT                03810000
         OI    RPLURH+0,B'00000011'   ENSURE BC+EC ON                   03820000
         NI    RPLURH+1,B'10110011'   CLEAR RESERVED BITS               03830000
         MVI   RPLURH+2,B'00000000'   CLEAR RESERVED BITS               03840000
         TM    RPLURH+0,RHDFC+RHNC    IS THIS DFC, NC, OR SC?           03850000
         BNZ   NRSPFIOK               BRANCH IF YES                     03860000
         NI    RPLURH+0,255-RHFI      CLEAR FMD FORMATTED INDICATOR     03870000
                                                                        03880000
NRSPFIOK DS    0H                                                       03890000
                                                                        03900000
         MVC   RPLOSENS(4),SPLSENSE   SET THE SENSE INFORMATION         03910000
         L     R2,ISECID              SESSION CID                       03920000
                                                                        03930000
         $MSG  966,               "-RSP SENT..."                       +03940000
               FIELDS=((RISESS),     ISESS ADDRESS                     +03950000
               (ISETKUSR,4),         IVUSER TOKEN                      +03960000
               (ISETKSES,4),         ISESS  TOKEN                      +03970000
               (RITASK),             ITASK ADDRESS                     +03980000
               (TSKPCBC,4),          IPROC ADDRESS                     +03990000
               (TSKNAME,8),          ITASK NAME                        +04000000
               (RPLOSENS,4),         SENSE                             +04010000
               (RPLCNTRL,3),         CNTRL FLAGS                       +04020000
               (RPLURH,3),           REQUEST HEADER                    +04030000
               (RPLSEQNO,2))         SEQUENCE NUMBER                    04040000
                                                                        04050000
         L     R15,=A(SENXRESP)       ADDRESS OF EXTENSION ROUTINE      04060000
         BASR  R14,R15                LINK TO ROUTINE                   04070000
         B     SENDCKP1           COMPLETE PHASE-1 PROCESSING & RETURN  04080000
                                                                        04090000
*---------------------------------------------------------------------- 04100000
* $SESS_SEND_SIGNAL                                                     04110000
*---------------------------------------------------------------------- 04120000
                                                                        04130000
SENDSIG  DS    0H                                                       04140000
                                                                        04150000
         BAS   R14,SENDCHEK         POST W/ERROR IF A SEND IS ACTIVE    04160000
                                                                        04170000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   04180000
         MVC   RPLSEQNO(2),SPLSEQNO SET THE SEQUENCE NUMBER             04190000
         L     R2,ISECID            SESSION CID                         04200000
         ICM   R1,15,SPLAREA        SIGNAL DATA ADDRESS                 04210000
         BNP   SSIGSEND             BRANCH IF NO SIGNAL DATA ADDRESS    04220000
         MVC   RPLSIGDA(4),0(R1)    SET THE SIGNAL DATA                 04230000
                                                                        04240000
SSIGSEND DS    0H                                                       04250000
                                                                        04260000
         L     R15,=A(SENXSIG)      ADDRESS OF EXTENSION ROUTINE        04270000
         BASR  R14,R15              LINK TO ROUTINE                     04280000
         B     SENDCKP1             COMPLETE PHASE-1 PROC. & RETURN     04290000
                                                                        04300000
*---------------------------------------------------------------------- 04310000
* $SESS_SEND_BID                                                        04320000
*---------------------------------------------------------------------- 04330000
                                                                        04340000
SENDBID  DS    0H                                                       04350000
                                                                        04360000
         BAS   R14,SENDCHEK       POST WITH ERROR IF A SEND IS ACTIVE   04370000
         BAS   R14,GETRPL         OBTAIN A SEND RPL                     04380000
         L     R2,ISECID          SESSION CID                           04390000
         L     R15,=A(SENXBID)    ADDRESS OF EXTENSION ROUTINE          04400000
         BASR  R14,R15            LINK TO ROUTINE                       04410000
         B     SENDCKP1           COMPLETE PHASE-1 PROCESSING & RETURN  04420000
                                                                        04430000
*---------------------------------------------------------------------- 04440000
* $SESS_SEND_LUSTAT                                                     04450000
*---------------------------------------------------------------------- 04460000
                                                                        04470000
SENDLUS  DS    0H                                                       04480000
                                                                        04490000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 04500000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   04510000
         MVC   RPLURH(3),SPLRH      SET THE REQUEST HEADER              04520000
         MVC   RPLOSENS(4),SPLSENSE SET THE SENSE INFORMATION           04530000
         L     R2,ISECID            SESSION CID                         04540000
         L     R15,=A(SENXLUS)      ADDRESS OF EXTENSION ROUTINE        04550000
         BASR  R14,R15              LINK TO ROUTINE                     04560000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  04570000
                                                                        04580000
*---------------------------------------------------------------------- 04590000
* $SESS_SEND_CANCEL                                                     04600000
*---------------------------------------------------------------------- 04610000
                                                                        04620000
SENDCAN  DS    0H                                                       04630000
                                                                        04640000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 04650000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   04660000
         L     R2,ISECID            SESSION CID                         04670000
         L     R15,=A(SENXCAN)      ADDRESS OF EXTENSION ROUTINE        04680000
         BASR  R14,R15              LINK TO ROUTINE                     04690000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  04700000
                                                                        04710000
*---------------------------------------------------------------------- 04720000
* $SESS_SEND_RTR                                                        04730000
*---------------------------------------------------------------------- 04740000
                                                                        04750000
SENDRTR  DS    0H                                                       04760000
                                                                        04770000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 04780000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   04790000
         L     R2,ISECID            SESSION CID                         04800000
         L     R15,=A(SENXRTR)      ADDRESS OF EXTENSION ROUTINE        04810000
         BASR  R14,R15              LINK TO ROUTINE                     04820000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  04830000
                                                                        04840000
*---------------------------------------------------------------------- 04850000
* $SESS_SEND_CHASE                                                      04860000
*---------------------------------------------------------------------- 04870000
                                                                        04880000
SENDCHA  DS    0H                                                       04890000
                                                                        04900000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 04910000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   04920000
         L     R2,ISECID            SESSION CID                         04930000
         L     R15,=A(SENXCHA)      ADDRESS OF EXTENSION ROUTINE        04940000
         BASR  R14,R15              LINK TO ROUTINE                     04950000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  04960000
                                                                        04970000
*---------------------------------------------------------------------- 04980000
* $SESS_SEND_SDT                                                        04990000
*---------------------------------------------------------------------- 05000000
                                                                        05010000
SENDSDT  DS    0H                                                       05020000
                                                                        05030000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05040000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05050000
         L     R2,ISECID            SESSION CID                         05060000
         L     R15,=A(SENXSDT)      ADDRESS OF EXTENSION ROUTINE        05070000
         BASR  R14,R15              LINK TO ROUTINE                     05080000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05090000
                                                                        05100000
*---------------------------------------------------------------------- 05110000
* $SESS_SEND_CLEAR                                                      05120000
*---------------------------------------------------------------------- 05130000
                                                                        05140000
SENDCLR  DS    0H                                                       05150000
                                                                        05160000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05170000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05180000
         L     R2,ISECID            SESSION CID                         05190000
         L     R15,=A(SENXCLR)      ADDRESS OF EXTENSION ROUTINE        05200000
         BASR  R14,R15              LINK TO ROUTINE                     05210000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05220000
                                                                        05230000
*---------------------------------------------------------------------- 05240000
* $SESS_SEND_SHUTD                                                      05250000
*---------------------------------------------------------------------- 05260000
                                                                        05270000
SENDSHTD DS    0H                                                       05280000
                                                                        05290000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05300000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05310000
         L     R2,ISECID            SESSION CID                         05320000
         L     R15,=A(SENXSHTD)     ADDRESS OF EXTENSION ROUTINE        05330000
         BASR  R14,R15              LINK TO ROUTINE                     05340000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05350000
                                                                        05360000
*---------------------------------------------------------------------- 05370000
* $SESS_SEND_SHUTC                                                      05380000
*---------------------------------------------------------------------- 05390000
                                                                        05400000
SENDSHTC DS    0H                                                       05410000
                                                                        05420000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05430000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05440000
         L     R2,ISECID            SESSION CID                         05450000
         L     R15,=A(SENXSHTC)     ADDRESS OF EXTENSION ROUTINE        05460000
         BASR  R14,R15              LINK TO ROUTINE                     05470000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05480000
                                                                        05490000
*---------------------------------------------------------------------- 05500000
* $SESS_SEND_RSHUT                                                      05510000
*---------------------------------------------------------------------- 05520000
                                                                        05530000
SENDRSHT DS    0H                                                       05540000
                                                                        05550000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05560000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05570000
         L     R2,ISECID            SESSION CID                         05580000
         L     R15,=A(SENXRSHT)     ADDRESS OF EXTENSION ROUTINE        05590000
         BASR  R14,R15              LINK TO ROUTINE                     05600000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05610000
                                                                        05620000
*---------------------------------------------------------------------- 05630000
* $SESS_SEND_RELQ                                                       05640000
*---------------------------------------------------------------------- 05650000
                                                                        05660000
SENDRELQ DS    0H                                                       05670000
                                                                        05680000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05690000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05700000
         L     R2,ISECID            SESSION CID                         05710000
         L     R15,=A(SENXRELQ)     ADDRESS OF EXTENSION ROUTINE        05720000
         BASR  R14,R15              LINK TO ROUTINE                     05730000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05740000
                                                                        05750000
*---------------------------------------------------------------------- 05760000
* $SESS_SEND_QEC                                                        05770000
*---------------------------------------------------------------------- 05780000
                                                                        05790000
SENDQEC  DS    0H                                                       05800000
                                                                        05810000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05820000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05830000
         L     R2,ISECID            SESSION CID                         05840000
         L     R15,=A(SENXQEC)      ADDRESS OF EXTENSION ROUTINE        05850000
         BASR  R14,R15              LINK TO ROUTINE                     05860000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  05870000
                                                                        05880000
*---------------------------------------------------------------------- 05890000
* $SESS_SEND_QC                                                         05900000
*---------------------------------------------------------------------- 05910000
                                                                        05920000
SENDQC   DS    0H                                                       05930000
                                                                        05940000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 05950000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   05960000
         L     R2,ISECID            SESSION CID                         05970000
         L     R15,=A(SENXQC)       ADDRESS OF EXTENSION ROUTINE        05980000
         BASR  R14,R15              LINK TO ROUTINE                     05990000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  06000000
                                                                        06010000
*---------------------------------------------------------------------- 06020000
* $SESS_SEND_SBI                                                        06030000
*---------------------------------------------------------------------- 06040000
                                                                        06050000
SENDSBI  DS    0H                                                       06060000
                                                                        06070000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 06080000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   06090000
         L     R2,ISECID            SESSION CID                         06100000
         L     R15,=A(SENXSBI)      ADDRESS OF EXTENSION ROUTINE        06110000
         BASR  R14,R15              LINK TO ROUTINE                     06120000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  06130000
                                                                        06140000
*---------------------------------------------------------------------- 06150000
* $SESS_SEND_BIS                                                        06160000
*---------------------------------------------------------------------- 06170000
                                                                        06180000
SENDBIS  DS    0H                                                       06190000
                                                                        06200000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 06210000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   06220000
         MVC   RPLURH(3),SPLRH      SET THE REQUEST HEADER, IF PROVIDED 06230000
         L     R2,ISECID            SESSION CID                         06240000
         L     R15,=A(SENXBIS)      ADDRESS OF EXTENSION ROUTINE        06250000
         BASR  R14,R15              LINK TO ROUTINE                     06260000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  06270000
                                                                        06280000
*---------------------------------------------------------------------- 06290000
* $SESS_SEND_RQR                                                        06300000
*---------------------------------------------------------------------- 06310000
                                                                        06320000
SENDRQR  DS    0H                                                       06330000
                                                                        06340000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 06350000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   06360000
         L     R2,ISECID            SESSION CID                         06370000
         L     R15,=A(SENXRQR)      ADDRESS OF EXTENSION ROUTINE        06380000
         BASR  R14,R15              LINK TO ROUTINE                     06390000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  06400000
                                                                        06410000
*---------------------------------------------------------------------- 06420000
* $SESS_SEND_STSN                                                       06430000
*---------------------------------------------------------------------- 06440000
                                                                        06450000
SENDSTSN DS    0H                                                       06460000
                                                                        06470000
         BAS   R14,SENDCHEK         POST WITH ERROR IF A SEND IS ACTIVE 06480000
         BAS   R14,GETRPL           OBTAIN A SEND RPL                   06490000
         L     R2,ISECID            SESSION CID                         06500000
         L     R15,=A(SENXSTSN)     ADDRESS OF EXTENSION ROUTINE        06510000
         BASR  R14,R15              LINK TO ROUTINE                     06520000
         B     SENDCKP1             COMPLETE PHASE-1 PROCESSING & RTRN  06530000
                                                                        06540000
*---------------------------------------------------------------------- 06550000
* COMMON SEND REQUEST PHASE-1 CHECK                                     06560000
*---------------------------------------------------------------------- 06570000
                                                                        06580000
SENDCKP1 DS    0H                                                       06590000
                                                                        06600000
         STM   R15,R0,IRPR15      SAVE VTAM RETURN REGISTERS            06610000
                                                                        06620000
         $VTAM CHECKPH1,          PHASE-1 RETURN CODE CHECK            +06630000
               AREA=(RIRPL),      IRPL TO BE CHECKED                   +06640000
               MF=(E,MFE_LIST)                                          06650000
                                                                        06660000
         B     RETURN             AND EXIT WORK ELEMENT PROCESSING      06670000
                                                                        06680000
*---------------------------------------------------------------------- 06690000
* $SESS_END_SESSION                                                     06700000
*---------------------------------------------------------------------- 06710000
                                                                        06720000
ENDSESS  DS    0H                                                       06730000
                                                                        06740000
*                                                                       06750000
* QUEUE AN END SESSION WORK ELEMENT TO THE ISESS PROCESS                06760000
*---------------------------------------------------------------------- 06770000
                                                                        06780000
         $VTAMWE L'IWEXH,         LENGTH                               +06790000
               IWECENDS           CODE                                  06800000
                                                                        06810000
         LA    R0,ISEWEQ          QUEUE ADDRESS                         06820000
         BAS   R14,QWE            QUEUE THE WORK ELEMENT                06830000
         B     POSTUSER                                                 06840000
                                                                        06850000
*---------------------------------------------------------------------- 06860000
* API ACKNOWLEDGED UNBIND BY SENDING A RESPONSE TO THE UNBIND.          06870000
* QUEUE AN UNBIND ACKNOWLEDGEMENT TO THE SESSION WORK QUEUE.            06880000
*---------------------------------------------------------------------- 06890000
                                                                        06900000
UNBNDACK DS    0H                                                       06910000
                                                                        06920000
         $VTAMWE L'IWEXN,          LENGTH                              +06930000
               IWECSUBA            CODE                                 06940000
                                                                        06950000
X        USING IWEVTAM,R1                                               06960000
                                                                        06970000
         MVC   X.IWEXNTYP,SPLUBTYP COPY THE UNBIND TYPE CODE            06980000
                                                                        06990000
         DROP  X                                                        07000000
                                                                        07010000
         LA    R0,ISEWEQ           QUEUE ADDRESS                        07020000
         BAS   R14,QWE             QUEUE THE WORK ELEMENT               07030000
         B     SENDPOST            POST THE $SESS RESPONSE REQUEST      07040000
                                                                        07050000
*---------------------------------------------------------------------- 07060000
* THE SESSION IS TERMINATING.  DON'T START NEW REQUESTS.                07070000
*---------------------------------------------------------------------- 07080000
                                                                        07090000
POSTCANC DS    0H                                                       07100000
                                                                        07110000
         MVC   SPLRETCD,=A($SESS_RC_CANCELED)                           07120000
         B     POSTUSER                                                 07130000
                                                                        07140000
*---------------------------------------------------------------------- 07150000
* A NON-ZERO VTAM RETURN CODE WAS RECEIVED                              07160000
*---------------------------------------------------------------------- 07170000
                                                                        07180000
POSTVTRC DS    0H                                                       07190000
                                                                        07200000
         MVC   SPLRETCD,=A($SESS_RC_VTAMRC)                             07210000
         TM    ISEF1,ISEF1TRM         IS TERMINATION UNDERWAY?          07220000
         BO    POSTCANC               BRANCH IF YES, POST CANCELED      07230000
         CLC   SPLRSNCD+2(2),=X'1413' CID INVALID?                      07240000
         BE    POSTCANC               BRANCH IF YES, POST CANCELED      07250000
         B     POSTUSER                                                 07260000
                                                                        07270000
*---------------------------------------------------------------------- 07280000
* $SESS _SEND_??? OR _RECEIVE REQUEST IS ALREADY ACTIVE                 07290000
*---------------------------------------------------------------------- 07300000
                                                                        07310000
POSTBUSY DS    0H                                                       07320000
                                                                        07330000
         MVC   SPLRETCD,=A($SESS_RC_BUSY)                               07340000
         B     POSTUSER                                                 07350000
                                                                        07360000
*---------------------------------------------------------------------- 07370000
* FUNCTION CODE ERROR                                                   07380000
*---------------------------------------------------------------------- 07390000
                                                                        07400000
POSTFUNC DS    0H                                                       07410000
                                                                        07420000
         MVC   SPLRETCD,=A($SESS_RC_FUNCTION)                           07430000
         B     POSTUSER                                                 07440000
                                                                        07450000
*---------------------------------------------------------------------- 07460000
* POST THE REQUEST COMPLETE                                             07470000
*---------------------------------------------------------------------- 07480000
                                                                        07490000
POSTUSER DS    0H                                                       07500000
                                                                        07510000
         MVC   SPLSTATE,ISESTATE  SET THE SESSION STATE WORD            07520000
         LR    R1,RSPLIST         PASS SPLIST ADDRESS IN R1             07530000
         L     R15,IVT@SPST       SPLIST  TRACE/POST ROUTINE            07540000
         BASR  R14,R15            LINK TO TRACE/POST ROUTINE            07550000
         B     RETURN             AND RETURN TO PROCESS MORE WORK       07560000
                                                                        07570000
*---------------------------------------------------------------------- 07580000
* RETURN TO CALLER                                                      07590000
*---------------------------------------------------------------------- 07600000
                                                                        07610000
RETURN   DS    0H                                                       07620000
                                                                        07630000
         LM    R15,R1,RETREGS     LOAD RETURN VALUES                    07640000
                                                                        07650000
         #EXIT R1=YES             RETURN W/R15,R0,R1                    07660000
                                                                        07670000
*---------------------------------------------------------------------- 07680000
* SUBROUTINE QWE - QUEUE A WORK ELEMENT TO A GIVEN WORK QUEUE           07690000
*                                                                       07700000
* ENTRY            R14 = RETURN ADDRESS                                 07710000
*                  R1  = WORK ELEMENT ADDRESS                           07720000
*                  R0  = QUEUE ADDRESS                                  07730000
*                                                                       07740000
* RETURNS          R15 = 0 --> QUEUEING WAS SUCCESSFUL                  07750000
*                      = 4 --> QUEUEING FAILED, WORK ELEMENT RELEASED   07760000
*---------------------------------------------------------------------- 07770000
                                                                        07780000
QWE      DS    0H                                                       07790000
                                                                        07800000
         STM   R14,R4,SUB0SAVE    SAVE REGISTERS                        07810000
         LR    R3,R0              SAVE QUEUE ADDRESS                    07820000
         LR    R4,R1              SAVE WORK ELEMENT ADDRESS             07830000
                                                                        07840000
         $VTAMQ (R4),             WORK ELEMENT                         +07850000
               (R3)               QUEUE                                 07860000
                                                                        07870000
         L     R14,SUB0SAVE       RESTORE REGISTERS                     07880000
         LM    R0,R4,SUB0SAVE+8   RESTORE REGISTERS                     07890000
         BR    R14                AND RETURN TO CALLER W/R15            07900000
                                                                        07910000
*---------------------------------------------------------------------- 07920000
* SUBROUTINE: SENDCHEK TO CHECK FOR ACTIVE SEND                         07930000
*---------------------------------------------------------------------- 07940000
                                                                        07950000
SENDCHEK DS    0H                                                       07960000
                                                                        07970000
         ST    R14,SUB0SAVE       SAVE RETURN REGISTER                  07980000
         TM    ISEF1,ISEF1TRM     IS TERMINATION UNDERWAY?              07990000
         BO    POSTCANC           BRANCH IF YES TO REJECT REQUEST       08000000
         OC    ISERQSND,ISERQSND  IS A SEND ALREADY ACTIVE?             08010000
         BNZ   POSTBUSY           BRANCH IF SEND IS BUSY                08020000
         L     R15,IVT@SSIP       PROTOCOL CHECKS ROUTINE               08030000
         BASR  R14,R15            CALL THE CHECKER                      08040000
         LTR   R15,R15            TEST THE RETURN CODE                  08050000
         BNZ   POSTUSER           BRANCH IF REQUEST ERROR               08060000
         ST    RSPLIST,ISERQSND   QUEUE THE ACTIVE SEND                 08070000
         NI    ISEF4,255-ISEF4ERS SHOW NO "EARLY RESPONSE"              08080000
         XC    ISEERSEQ,ISEERSEQ  CLEAR "EARLY RESPONSE" FIELDS         08090000
         XC    ISEERRTN,ISEERRTN  CLEAR "EARLY RESPONSE" FIELDS         08100000
         XC    ISEERFD2,ISEERFD2  CLEAR "EARLY RESPONSE" FIELDS         08110000
         XC    ISEERFBK,ISEERFBK  CLEAR "EARLY RESPONSE" FIELDS         08120000
         XC    ISEERRH,ISEERRH    CLEAR "EARLY RESPONSE" FIELDS         08130000
         L     R14,SUB0SAVE       RESTORE RETURN REGISTER               08140000
         BR    R14                RETURN TO CALLER                      08150000
                                                                        08160000
*---------------------------------------------------------------------- 08170000
* SUBROUTINE: SENDRCHK TO CHECK FOR ACTIVE SEND RESP                    08180000
*---------------------------------------------------------------------- 08190000
                                                                        08200000
SENDRCHK DS    0H                                                       08210000
                                                                        08220000
         ST    R14,SUB0SAVE       SAVE RETURN REGISTER                  08230000
         TM    ISEF1,ISEF1TRM     IS TERMINATION UNDERWAY?              08240000
         BO    POSTCANC           BRANCH IF YES TO REJECT REQUEST       08250000
         OC    ISERQRSP,ISERQRSP  IS A RESP ALREADY ACTIVE?             08260000
         BNZ   POSTBUSY           BRANCH IF RESP IS BUSY                08270000
         ST    RSPLIST,ISERQRSP   QUEUE THE ACTIVE SEND RESP            08280000
         L     R14,SUB0SAVE       RESTORE RETURN REGISTER               08290000
         BR    R14                RETURN TO CALLER                      08300000
                                                                        08310000
*---------------------------------------------------------------------- 08320000
* SUBROUTINE: GETRPL                                                    08330000
*---------------------------------------------------------------------- 08340000
                                                                        08350000
GETRPL   DS    0H                                                       08360000
                                                                        08370000
         STM   R14,R1,SUB0SAVE    SAVE RETURN ADDRESS                   08380000
                                                                        08390000
         $VTAM GETRPL,                                                 +08400000
               AREA=ISERPACT,                                          +08410000
               ERRET=ERR$VTAM,                                         +08420000
               MF=(E,MFE_LIST)    ACQUIRE AN IRPL                       08430000
                                                                        08440000
         LR    RIRPL,R1           ESTABLISH ADDRESSIBILITY              08450000
         LA    R1,ISEWEQ          SESSION QUEUE                         08460000
         ST    R1,IRP@WEQ         WILL RECEIVE THE RPL COMPLETION       08470000
         LA    R1,SENDEND         RPL COMPLETION ROUTINE                08480000
         ST    R1,IRPWTGOK        SET COMPLETION ADDRESS                08490000
         ST    RISESS,IRPISESS    SET ISESS POINTER                     08500000
         MVC   IRPARG,ISECID      SET CID COPY                          08510000
         MVC   IRPTOKEN,ISETK     SET SESSION TOKEN                     08520000
         ST    RSPLIST,IRPPLIST   SET SPLIST POINTER                    08530000
         ST    RIACB,RPLDACB      SET IACB ADDRESS                      08540000
         LM    R14,R1,SUB0SAVE    RESTORE REGISTERS                     08550000
         BR    R14                RETURN TO CALLER                      08560000
                                                                        08570000
*---------------------------------------------------------------------- 08580000
* SUBROUTINE: FREERPL                                                   08590000
*---------------------------------------------------------------------- 08600000
                                                                        08610000
FREERPL  DS    0H                                                       08620000
                                                                        08630000
         STM   R14,R1,SUB0SAVE    SAVE RETURN ADDRESS                   08640000
                                                                        08650000
         $VTAM RETRPL,                                                 +08660000
               AREA=(RIRPL),                                           +08670000
               ERRET=ERR$VTAM,                                         +08680000
               MF=(E,MFE_LIST)    RELEASE THE IRPL                      08690000
                                                                        08700000
         SR    RIRPL,RIRPL        SHOW NO IRPL                          08710000
         LM    R14,R1,SUB0SAVE    RESTORE REGISTERS                     08720000
         BR    R14                RETURN TO CALLER                      08730000
                                                                        08740000
*---------------------------------------------------------------------- 08750000
* ERROR ROUTINES                                                        08760000
*---------------------------------------------------------------------- 08770000
                                                                        08780000
ERR$VTAM DS    0H                                                       08790000
                                                                        08800000
         $ABEND ABE_VTDIAG,                                            +08810000
               SCOPE=PCB,                                              +08820000
               TITLE='$VTAM FAILURE'                                    08830000
                                                                        08840000
ERRSESS  DS    0H                                                       08850000
                                                                        08860000
         $ABEND ABE_VTDIAG,                                            +08870000
               SCOPE=PCB,                                              +08880000
               TITLE='SESSION FAILURE'                                  08890000
                                                                        08900000
*---------------------------------------------------------------------- 08910000
*                                                                       08920000
* RPL COMPLETION ROUTINE FOR SENDS                                      08930000
*                                                                       08940000
* ON ENTRY:                                                             08950000
*                                                                       08960000
*    R15 = ENTRY POINT ADDRESS                                          08970000
*    R14 = RETURN ADDRESS                                               08980000
*    R13 = AVAILABLE SAVE AREA                                          08990000
*    R11 = ICVT ADDRESS                                                 09000000
*    R10 = ITASK ADDRESS                                                09010000
*    R09 = IVTAMCVT ADDRESS                                             09020000
*    R01 = ADDRESS OF COMPLETED IRPL                                    09030000
*    R00 = RECOVERY ACTION RETURN CODE                                  09040000
*                                                                       09050000
*---------------------------------------------------------------------- 09060000
                                                                        09070000
         DROP  R12                                                      09080000
                                                                        09090000
SENDEND  #ENTER BASE=R12,         ENTRY LINKAGE                        +09100000
               PREG=(RIRPL,R2),   R1-->RIRPL, R0-->R2                  +09110000
               EP=YES             THIS IS AN ENTRY POINT                09120000
                                                                        09130000
*                                                                       09140000
* RESTORE ENVIRONMENT                                                   09150000
*---------------------------------------------------------------------- 09160000
                                                                        09170000
         L     RIACB,RPLDACB      ACB REFERENCE                         09180000
         L     RISESS,RPLUSFLD    ISESS ADDRESS                         09190000
         L     RSPLIST,IRPPLIST   SPLIST ADDRESS                        09200000
         SR    RIWE,RIWE          SHOW NO IWE DURING RPL COMPLETION     09210000
                                                                        09220000
*                                                                       09230000
* MAKE SURE AN ISESS WAS RETURNED IN RPLUSFLD                           09240000
*---------------------------------------------------------------------- 09250000
                                                                        09260000
         LTR   RISESS,RISESS      WAS THERE A RPLUSFLD?                 09270000
         BNZ   SENDVER            BRANCH IF YES                         09280000
                                                                        09290000
         CLC   RPLRTNCD(2),=X'1413' CID INVALID?                        09300000
         BE    SPECERR            BRANCH IF SPECIAL ERROR               09310000
                                                                        09320000
SENDFREE DS    0H                                                       09330000
                                                                        09340000
         BAS   R14,FREERPL        RELEASE THE RPL                       09350000
         B     RETURN             AND IGNORE THIS INTERRUPTION          09360000
                                                                        09370000
SPECERR  DS    0H                                                       09380000
                                                                        09390000
         L     RISESS,IRPISESS    GET COPY OF ISESS ADDRESS             09400000
         CLC   ISEID,=CL8'ISESS'  DOES IT HAVE THE ID?                  09410000
         BE    SENDVER            BRANCH IF YES                         09420000
         B     SENDFREE           BRANCH IF NOT, LOSE THE IRPL          09430000
                                                                        09440000
*                                                                       09450000
* VERIFY ACTIVE SPLIST                                                  09460000
*---------------------------------------------------------------------- 09470000
                                                                        09480000
SENDVER  DS    0H                                                       09490000
                                                                        09500000
         C     RSPLIST,ISERQSND   IS THIS THE ACTIVE SEND?              09510000
         BNE   SENDVERR           BRANCH IF NOT                         09520000
         OI    FLAG,FLGRQSND      REMEMBER SEND                         09530000
         B     VERIFIED                                                 09540000
                                                                        09550000
SENDVERR DS    0H                                                       09560000
                                                                        09570000
         C     RSPLIST,ISERQRSP   IS THIS THE ACTIVE SEND RESP?         09580000
         BNE   ERRSESS            IF NOT, WE ARE CONFUSED               09590000
         OI    FLAG,FLGRQRSP      REMEMBER SEND RESP                    09600000
                                                                        09610000
VERIFIED DS    0H                                                       09620000
                                                                        09630000
*                                                                       09640000
* SET SPL FIELDS                                                        09650000
*---------------------------------------------------------------------- 09660000
                                                                        09670000
         MVC   SPLSEQNO(2),RPLSEQNO     SEQUENCE # OF LAST RU (LMPEO)   09680000
         MVC   SPLOBSQV(2),RPLOBSQV     SEQUENCE # OF 1ST  RU (LMPEO)   09690000
         TM    RPLOPT7,RPLLMPEO         IS LMPEO IN EFFECT?             09700000
         BO    *+10                     BRANCH IF YES                   09710000
         MVC   SPLOBSQV(2),RPLSEQNO     SEQ # OF 1ST  RU (NOT LMPEO)    09720000
         MVC   SPLRSNCD+2(1),RPLRTNCD   RETURN CODE                     09730000
         MVC   SPLRSNCD+3(1),RPLFDB2    REASON CODE                     09740000
         MVC   SPLCNTRL(3),RPLCNTRL     RU-TYPE FLAGS                   09750000
         MVC   SPLRH(3),RPLURH          RH                              09760000
                                                                        09770000
*                                                                       09780000
* RELEASE THE SEND RPL                                                  09790000
*---------------------------------------------------------------------- 09800000
                                                                        09810000
         BAS   R14,FREERPL        RELEASE THE SEND RPL                  09820000
                                                                        09830000
*                                                                       09840000
* IF THE VTAM RETURN CODES WERE NON-ZERO DEQUEUE THE SEND & POST USER   09850000
*---------------------------------------------------------------------- 09860000
                                                                        09870000
         OC    SPLRSNCD,SPLRSNCD  NON-ZERO VTAM COMPLETION CODES?       09880000
         BZ    SENDOK             BRANCH IF NON-ZERO                    09890000
         TM    FLAG,FLGRQSND      WAS THIS A SEND?                      09900000
         BNO   VTRCRESP           BRANCH IF NOT                         09910000
         XC    ISERQSND,ISERQSND  DEQUEUE THE ACTIVE SEND REQUEST       09920000
         B     POSTVTRC           POST THE USER NOW                     09930000
                                                                        09940000
VTRCRESP DS    0H                                                       09950000
                                                                        09960000
         XC    ISERQRSP,ISERQRSP  DEQUEUE THE ACTIVE SEND RESP REQUEST  09970000
         B     POSTVTRC           POST THE USER NOW                     09980000
                                                                        09990000
*                                                                       10000000
* IF THIS WAS NOT A DFSYN RU, DEQUEUE THE SEND & POST USER              10010000
*---------------------------------------------------------------------- 10020000
                                                                        10030000
SENDOK   DS    0H                                                       10040000
                                                                        10050000
         TM    SPLCNTDF,RPLDATA+RPLCNCEL+RPLQC+RPLCHASE                 10060000
         BNZ   SENDCHKR           BRANCH IF NORMAL FLOW REQUEST         10070000
         TM    SPLCNTDC,RPLBID+RPLBIS+RPLLUS+RPLRTR                     10080000
         BZ    SENDPOST           BRANCH IF NOT A NORMAL FLOW REQUEST   10090000
                                                                        10100000
*                                                                       10110000
* IF A RESPONSE WAS BEING SENT, DEQUEUE THE SEND & POST USER            10120000
*---------------------------------------------------------------------- 10130000
                                                                        10140000
SENDCHKR DS    0H                                                       10150000
                                                                        10160000
         TM    SPLRH0,RHQSRSP     WAS A RESPONSE BEING SENT?            10170000
         BO    SENDPOST           BRANCH IF YES                         10180000
                                                                        10190000
*                                                                       10200000
* SAVE LAST NORMAL FLOW SEQUENCE NUMBER FOR LU6.2 & SET BB REGISTERS.   10210000
* CORRECT THE SPLSEQNO FOR THE EXPECTED RESPONSE SEQUENCE# VALUE.       10220000
*---------------------------------------------------------------------- 10230000
                                                                        10240000
         CLC   BINLUP(2),=X'0602' LU6.2?                                10250000
         BNE   NOT62REQ                                                 10260000
         MVC   ISE62SSC,SPLSEQNO  LAST NORMAL FLOW SEQUENCE NUMBER      10270000
         TM    SPLRH2,RHBBI       A BB REQUEST?                         10280000
         BNO   NOT62BB                                                  10290000
         TM    ISEF2,ISEF2SLU     ARE WE THE SLU?                       10300000
         BNO   PLU62REQ           BRANCH IF NOT                         10310000
         MVC   ISE62SBR,SPLOBSQV  SET THE SLU BB REGISTER               10320000
         NI    ISE62SBR,X'7F'     ENSURE HI BIT IS OFF                  10330000
         MVC   SPLSEQNO,ISE62SBR  EXPECTED RESPONSE IS SLU BB REGISTER  10340000
         TM    ISEF2,ISEF2WIN     ARE WE THE WINNER?                    10350000
         BNO   NOT62REQ           BRANCH IF NOT                         10360000
         MVC   ISE62CBS,ISE62SBR  SET CURRENT BRACKET SEQUENCE NUMBER   10370000
         B     NOT62REQ           AND WE ARE DONE                       10380000
                                                                        10390000
PLU62REQ DS    0H                                                       10400000
                                                                        10410000
         MVC   ISE62PBR,SPLOBSQV  SET THE PLU BB REGISTER               10420000
         OI    ISE62PBR,X'80'     SET HI BIT                            10430000
         MVC   SPLSEQNO,ISE62PBR  EXPECTED RESPONSE IS PLU BB REGISTER  10440000
         TM    ISEF2,ISEF2WIN     ARE WE THE WINNER?                    10450000
         BNO   NOT62REQ           BRANCH IF NOT                         10460000
         MVC   ISE62CBS,ISE62PBR  SET CURRENT BRACKET SEQUENCE NUMBER   10470000
         B     NOT62REQ           AND WE ARE DONE                       10480000
                                                                        10490000
NOT62BB  DS    0H                                                       10500000
                                                                        10510000
         TM    SPLCNTDF,RPLDATA                                         10520000
         BO    SET62SEQ           BRANCH IF FMD                         10530000
         TM    SPLCNTDC,RPLLUS                                          10540000
         BZ    NOT62REQ           BRANCH IF NOT LUS                     10550000
                                                                        10560000
SET62SEQ DS    0H                                                       10570000
                                                                        10580000
         MVC   SPLSEQNO,ISE62CBS  EXPECTED RESPONSE IS CURRENT BRK SEQ# 10590000
                                                                        10600000
NOT62REQ DS    0H                                                       10610000
                                                                        10620000
*                                                                       10630000
* IF THIS WAS A DATA SEND, UPDATE THE MESSAGE AND BYTE COUNTS           10640000
*---------------------------------------------------------------------- 10650000
                                                                        10660000
         TM    SPLCNTDF,RPLDATA   DATA SEND?                            10670000
         BNO   SENDDRCK           BRANCH IF NOT                         10680000
                                                                        10690000
         L     R1,ISE#MSGO        OUTBOUND MESSAGE COUNT                10700000
         A     R1,=F'1'           BUMP IT BY ONE                        10710000
         ST    R1,ISE#MSGO        STORE UPDATED COUNT                   10720000
                                                                        10730000
         L     R1,ISE#BYTO        OUTBOUND BYTE COUNT                   10740000
         A     R1,SPLAREAL        ADD BYTE COUNT OF THIS MESSAGE        10750000
         ST    R1,ISE#BYTO        STORE UPDATE COUNT                    10760000
                                                                        10770000
*                                                                       10780000
* IF EXCEPTION/NO RESPONSE WAS REQUESTED DEQUEUE THE SEND & POST USER   10790000
*---------------------------------------------------------------------- 10800000
                                                                        10810000
SENDDRCK DS    0H                                                       10820000
                                                                        10830000
         TM    SPLRH1,RHERI       EXCEPTIOM RESPONSE REQUESTED?         10840000
         BO    SENDPOST           BRANCH YES TO COMPLETE THE REQUEST    10850000
         TM    SPLRH1,RHDR1+RHDR2 WAS A DEFINITE RESPONSE REQUESTED?    10860000
         BZ    SENDPOST           BRANCH IF NOT, ALL DONE               10870000
                                                                        10880000
*                                                                       10890000
* CHECK IF AN "EARLY RESPONSE" BEAT OUT THE SEND POST=SCHED             10900000
*---------------------------------------------------------------------- 10910000
                                                                        10920000
         TM    ISEF4,ISEF4ERS     WAS AN "EARLY RESPONSE" RECEIVED?     10930000
         BNO   RETURN             BRANCH NO, LEAVE SEND QUEUED FOR RESP 10940000
         CLC   ISEERSEQ,SPLSEQNO  WAS RESPONSE FOR THIS DR CHAIN?       10950000
         BNE   RETURN             BRANCH NO, LEAVE SEND QUEUED FOR RESP 10960000
         MVC   SPLRRH(3),ISEERRH      SET RESPONSE RH                   10970000
         MVC   SPLSENSE(4),ISEERFBK   SET POSSIBLE SENSE INFORMATION    10980000
         MVC   SPLRSNCD+2(1),ISEERRTN SET RETURN CODE                   10990000
         MVC   SPLRSNCD+3(1),ISEERFD2 SET REASON CODE                   11000000
         OC    SPLRSNCD,SPLRSNCD      NON-ZERO VTAM COMPLETION CODES?   11010000
         BZ    SENDSFP                BRANCH IF ZEROES                  11020000
         MVC   SPLRETCD,=A($SESS_RC_VTAMRC)                             11030000
                                                                        11040000
SENDSFP  DS    0H                                                       11050000
                                                                        11060000
         LR    R1,RSPLIST         PASS SPLIST IN R1                     11070000
         LR    R0,RISESS          PASS ISESS  IN R0                     11080000
         L     R15,IVT@SSFP       DO SEND COMPLETION STATE UPDATES      11090000
         BASR  R14,R15            LINK TO ROUTINE                       11100000
                                                                        11110000
*                                                                       11120000
* END THE REQUEST BY POSTING THE USER/API                               11130000
*---------------------------------------------------------------------- 11140000
                                                                        11150000
SENDPOST DS    0H                                                       11160000
                                                                        11170000
         TM    FLAG,FLGRQSND      WAS THIS A SEND?                      11180000
         BNO   POSTRESP           BRANCH IF NOT                         11190000
         XC    ISERQSND,ISERQSND  DEQUEUE THE ACTIVE SEND REQUEST       11200000
         B     POSTUSER           POST THE USER NOW                     11210000
                                                                        11220000
POSTRESP DS    0H                                                       11230000
                                                                        11240000
         XC    ISERQRSP,ISERQRSP  DEQUEUE THE ACTIVE SEND RESP REQUEST  11250000
         B     POSTUSER           POST THE USER NOW                     11260000
                                                                        11270000
*---------------------------------------------------------------------- 11280000
*  CONSTANTS AND LITERALS                                               11290000
*---------------------------------------------------------------------- 11300000
                                                                        11310000
         LTORG ,                                                        11320000
                                                                        11330000
*---------------------------------------------------------------------- 11340000
* $SESS_SEND_NEGRESP/POSRESP EXTENSION                                  11350000
*---------------------------------------------------------------------- 11360000
                                                                        11370000
         DS    0D                                                       11380000
                                                                        11390000
         DROP  R12                                                      11400000
         USING *,R12                                                    11410000
                                                                        11420000
SENXRESP DS    0H                                                       11430000
                                                                        11440000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         11450000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       11460000
         LR    R12,R15              NEW BASE REGISTER                   11470000
         TM    RPLCNTSC,RPLSDT      IS THIS AN SDT RESPONSE?            11480000
         BO    SENXRSDT             BRANCH IF YES                       11490000
                                                                        11500000
         SEND  STYPE=RESP,                                             +11510000
               RPL=(RIRPL),                                            +11520000
               ARG=(R2),                                               +11530000
               OPTCD=(USERRH,ASY,NLMPEO,NBUFFLST),                     +11540000
               POST=SCHED                                               11550000
                                                                        11560000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      11570000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    11580000
         BR    R14                  RETURN TO POINT OF CALL             11590000
                                                                        11600000
SENXRSDT DS    0H                                                       11610000
                                                                        11620000
         NI    RPLVTFL2,255-(RPLEX+RPLNFME+RPLRRN)                      11630000
         TM    RPLURH+1,RHERI       EXCEPTION RESPONSE?                 11640000
         BNO   *+8                  BRANCH IF NOT                       11650000
         OI    RPLVTFL2,RPLEX       SET EXCEPTION RESPONSE              11660000
         TM    RPLURH+1,RHDR1       DR1?                                11670000
         BO    *+8                  BRANCH IF YES                       11680000
         OI    RPLVTFL2,RPLNFME     SET NO DR1                          11690000
         TM    RPLURH+1,RHDR2       DR2?                                11700000
         BNO   *+8                  BRANCH IF NOT                       11710000
         OI    RPLVTFL2,RPLRRN      SET DR2                             11720000
                                                                        11730000
         SESSIONC CONTROL=SDT,                                         +11740000
               STYPE=RESP,                                             +11750000
               RPL=(RIRPL),                                            +11760000
               ARG=(R2),                                               +11770000
               OPTCD=(ASY)                                              11780000
                                                                        11790000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      11800000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    11810000
         BR    R14                  RETURN TO POINT OF CALL             11820000
                                                                        11830000
         LTORG                                                          11840000
                                                                        11850000
*---------------------------------------------------------------------- 11860000
* $SESS_SEND_CLEAR EXTENSION                                            11870000
*---------------------------------------------------------------------- 11880000
                                                                        11890000
         DS    0D                                                       11900000
                                                                        11910000
         DROP  R12                                                      11920000
         USING *,R12                                                    11930000
                                                                        11940000
SENXCLR  DS    0H                                                       11950000
                                                                        11960000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         11970000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       11980000
         LR    R12,R15              NEW BASE REGISTER                   11990000
                                                                        12000000
         SESSIONC CONTROL=CLEAR,                                       +12010000
               STYPE=REQ,                                              +12020000
               RPL=(RIRPL),                                            +12030000
               ARG=(R2),                                               +12040000
               OPTCD=(ASY)                                              12050000
                                                                        12060000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      12070000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    12080000
         BR    R14                  RETURN TO POINT OF CALL             12090000
                                                                        12100000
         LTORG                                                          12110000
                                                                        12120000
*---------------------------------------------------------------------- 12130000
* $SESS_SEND_SDT   EXTENSION                                            12140000
*---------------------------------------------------------------------- 12150000
                                                                        12160000
         DS    0D                                                       12170000
                                                                        12180000
         DROP  R12                                                      12190000
         USING *,R12                                                    12200000
                                                                        12210000
SENXSDT  DS    0H                                                       12220000
                                                                        12230000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         12240000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       12250000
         LR    R12,R15              NEW BASE REGISTER                   12260000
                                                                        12270000
         SESSIONC CONTROL=SDT,                                         +12280000
               STYPE=REQ,                                              +12290000
               RPL=(RIRPL),                                            +12300000
               ARG=(R2),                                               +12310000
               OPTCD=(ASY)                                              12320000
                                                                        12330000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      12340000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    12350000
         BR    R14                  RETURN TO POINT OF CALL             12360000
                                                                        12370000
         LTORG                                                          12380000
                                                                        12390000
*---------------------------------------------------------------------- 12400000
* $SESS_SEND_DATA  EXTENSION                                            12410000
*---------------------------------------------------------------------- 12420000
                                                                        12430000
         DS    0D                                                       12440000
                                                                        12450000
         DROP  R12                                                      12460000
         USING *,R12                                                    12470000
                                                                        12480000
SENXDATA DS    0H                                                       12490000
                                                                        12500000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         12510000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       12520000
         LR    R12,R15              NEW BASE REGISTER                   12530000
                                                                        12540000
         SEND  CONTROL=DATA,                                           +12550000
               STYPE=REQ,                                              +12560000
               RPL=(RIRPL),                                            +12570000
               ARG=(R2),                                               +12580000
               OPTCD=(USERRH,ASY,LMPEO,NBUFFLST),                      +12590000
               POST=SCHED                                               12600000
                                                                        12610000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      12620000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    12630000
         BR    R14                  RETURN TO POINT OF CALL             12640000
                                                                        12650000
*---------------------------------------------------------------------- 12660000
* $SESS_SEND_DATA  EXTENSION (NO LMPEO)                                 12670000
*---------------------------------------------------------------------- 12680000
                                                                        12690000
         DS    0D                                                       12700000
                                                                        12710000
         DROP  R12                                                      12720000
         USING *,R12                                                    12730000
                                                                        12740000
SENXNCHN DS    0H                                                       12750000
                                                                        12760000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         12770000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       12780000
         LR    R12,R15              NEW BASE REGISTER                   12790000
                                                                        12800000
         SEND  CONTROL=DATA,                                           +12810000
               STYPE=REQ,                                              +12820000
               RPL=(RIRPL),                                            +12830000
               ARG=(R2),                                               +12840000
               OPTCD=(USERRH,ASY,NLMPEO,NBUFFLST),                     +12850000
               POST=SCHED                                               12860000
                                                                        12870000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      12880000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    12890000
         BR    R14                  RETURN TO POINT OF CALL             12900000
                                                                        12910000
         LTORG                                                          12920000
                                                                        12930000
*---------------------------------------------------------------------- 12940000
* $SESS_SEND_SIGNAL  EXTENSION                                          12950000
*---------------------------------------------------------------------- 12960000
                                                                        12970000
         DS    0D                                                       12980000
                                                                        12990000
         DROP  R12                                                      13000000
         USING *,R12                                                    13010000
                                                                        13020000
SENXSIG  DS    0H                                                       13030000
                                                                        13040000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         13050000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       13060000
         LR    R12,R15              NEW BASE REGISTER                   13070000
                                                                        13080000
         SEND  CONTROL=SIGNAL,                                         +13090000
               STYPE=REQ,                                              +13100000
               RPL=(RIRPL),                                            +13110000
               ARG=(R2),                                               +13120000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +13130000
               POST=SCHED                                               13140000
                                                                        13150000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      13160000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    13170000
         BR    R14                  RETURN TO POINT OF CALL             13180000
                                                                        13190000
         LTORG                                                          13200000
                                                                        13210000
*---------------------------------------------------------------------- 13220000
* $SESS_SEND_BID EXTENSION                                              13230000
*---------------------------------------------------------------------- 13240000
                                                                        13250000
         DS    0D                                                       13260000
                                                                        13270000
         DROP  R12                                                      13280000
         USING *,R12                                                    13290000
                                                                        13300000
SENXBID  DS    0H                                                       13310000
                                                                        13320000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         13330000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       13340000
         LR    R12,R15              NEW BASE REGISTER                   13350000
                                                                        13360000
         SEND  CONTROL=BID,                                            +13370000
               STYPE=REQ,                                              +13380000
               RPL=(RIRPL),                                            +13390000
               ARG=(R2),                                               +13400000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +13410000
               POST=SCHED                                               13420000
                                                                        13430000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      13440000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    13450000
         BR    R14                  RETURN TO POINT OF CALL             13460000
                                                                        13470000
         LTORG                                                          13480000
                                                                        13490000
*---------------------------------------------------------------------- 13500000
* $SESS_SEND_LUSTAT EXTENSION                                           13510000
*---------------------------------------------------------------------- 13520000
                                                                        13530000
         DS    0D                                                       13540000
                                                                        13550000
         DROP  R12                                                      13560000
         USING *,R12                                                    13570000
                                                                        13580000
SENXLUS  DS    0H                                                       13590000
                                                                        13600000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         13610000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       13620000
         LR    R12,R15              NEW BASE REGISTER                   13630000
         OC    RPLURH,RPLURH        IS THERE SOME URH?                  13640000
         BNZ   SXLUSURH             BRANCH IF YES                       13650000
                                                                        13660000
         SEND  CONTROL=LUS,                                            +13670000
               STYPE=REQ,                                              +13680000
               RPL=(RIRPL),                                            +13690000
               ARG=(R2),                                               +13700000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +13710000
               POST=SCHED                                               13720000
                                                                        13730000
         B     SXLUSEND                                                 13740000
                                                                        13750000
SXLUSURH DS    0H                                                       13760000
                                                                        13770000
         SEND  CONTROL=LUS,                                            +13780000
               STYPE=REQ,                                              +13790000
               RPL=(RIRPL),                                            +13800000
               ARG=(R2),                                               +13810000
               OPTCD=(USERRH,ASY,NLMPEO,NBUFFLST),                     +13820000
               POST=SCHED                                               13830000
                                                                        13840000
SXLUSEND DS    0H                                                       13850000
                                                                        13860000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      13870000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    13880000
         BR    R14                  RETURN TO POINT OF CALL             13890000
                                                                        13900000
         LTORG                                                          13910000
                                                                        13920000
*---------------------------------------------------------------------- 13930000
* $SESS_SEND_CANCEL EXTENSION                                           13940000
*---------------------------------------------------------------------- 13950000
                                                                        13960000
         DS    0D                                                       13970000
                                                                        13980000
         DROP  R12                                                      13990000
         USING *,R12                                                    14000000
                                                                        14010000
SENXCAN  DS    0H                                                       14020000
                                                                        14030000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         14040000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       14050000
         LR    R12,R15              NEW BASE REGISTER                   14060000
                                                                        14070000
         SEND  CONTROL=CANCEL,                                         +14080000
               STYPE=REQ,                                              +14090000
               RPL=(RIRPL),                                            +14100000
               ARG=(R2),                                               +14110000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +14120000
               POST=SCHED                                               14130000
                                                                        14140000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      14150000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    14160000
         BR    R14                  RETURN TO POINT OF CALL             14170000
                                                                        14180000
         LTORG                                                          14190000
                                                                        14200000
*---------------------------------------------------------------------- 14210000
* $SESS_SEND_RTR EXTENSION                                              14220000
*---------------------------------------------------------------------- 14230000
                                                                        14240000
         DS    0D                                                       14250000
                                                                        14260000
         DROP  R12                                                      14270000
         USING *,R12                                                    14280000
                                                                        14290000
SENXRTR  DS    0H                                                       14300000
                                                                        14310000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         14320000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       14330000
         LR    R12,R15              NEW BASE REGISTER                   14340000
                                                                        14350000
         SEND  CONTROL=RTR,                                            +14360000
               STYPE=REQ,                                              +14370000
               RPL=(RIRPL),                                            +14380000
               ARG=(R2),                                               +14390000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +14400000
               POST=SCHED                                               14410000
                                                                        14420000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      14430000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    14440000
         BR    R14                  RETURN TO POINT OF CALL             14450000
                                                                        14460000
         LTORG                                                          14470000
                                                                        14480000
*---------------------------------------------------------------------- 14490000
* $SESS_SEND_CHASE EXTENSION                                            14500000
*---------------------------------------------------------------------- 14510000
                                                                        14520000
         DS    0D                                                       14530000
                                                                        14540000
         DROP  R12                                                      14550000
         USING *,R12                                                    14560000
                                                                        14570000
SENXCHA  DS    0H                                                       14580000
                                                                        14590000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         14600000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       14610000
         LR    R12,R15              NEW BASE REGISTER                   14620000
                                                                        14630000
         SEND  CONTROL=CHASE,                                          +14640000
               STYPE=REQ,                                              +14650000
               RPL=(RIRPL),                                            +14660000
               ARG=(R2),                                               +14670000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +14680000
               POST=SCHED                                               14690000
                                                                        14700000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      14710000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    14720000
         BR    R14                  RETURN TO POINT OF CALL             14730000
                                                                        14740000
         LTORG                                                          14750000
                                                                        14760000
*---------------------------------------------------------------------- 14770000
* $SESS_SEND_SHUTD EXTENSION                                            14780000
*---------------------------------------------------------------------- 14790000
                                                                        14800000
         DS    0D                                                       14810000
                                                                        14820000
         DROP  R12                                                      14830000
         USING *,R12                                                    14840000
                                                                        14850000
SENXSHTD DS    0H                                                       14860000
                                                                        14870000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         14880000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       14890000
         LR    R12,R15              NEW BASE REGISTER                   14900000
                                                                        14910000
         SEND  CONTROL=SHUTD,                                          +14920000
               STYPE=REQ,                                              +14930000
               RPL=(RIRPL),                                            +14940000
               ARG=(R2),                                               +14950000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +14960000
               POST=SCHED                                               14970000
                                                                        14980000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      14990000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    15000000
         BR    R14                  RETURN TO POINT OF CALL             15010000
                                                                        15020000
         LTORG                                                          15030000
                                                                        15040000
*---------------------------------------------------------------------- 15050000
* $SESS_SEND_SHUTC EXTENSION                                            15060000
*---------------------------------------------------------------------- 15070000
                                                                        15080000
         DS    0D                                                       15090000
                                                                        15100000
         DROP  R12                                                      15110000
         USING *,R12                                                    15120000
                                                                        15130000
SENXSHTC DS    0H                                                       15140000
                                                                        15150000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         15160000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       15170000
         LR    R12,R15              NEW BASE REGISTER                   15180000
                                                                        15190000
         SEND  CONTROL=SHUTC,                                          +15200000
               STYPE=REQ,                                              +15210000
               RPL=(RIRPL),                                            +15220000
               ARG=(R2),                                               +15230000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +15240000
               POST=SCHED                                               15250000
                                                                        15260000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      15270000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    15280000
         BR    R14                  RETURN TO POINT OF CALL             15290000
                                                                        15300000
         LTORG                                                          15310000
                                                                        15320000
*---------------------------------------------------------------------- 15330000
* $SESS_SEND_RSHUT EXTENSION                                            15340000
*---------------------------------------------------------------------- 15350000
                                                                        15360000
         DS    0D                                                       15370000
                                                                        15380000
         DROP  R12                                                      15390000
         USING *,R12                                                    15400000
                                                                        15410000
SENXRSHT DS    0H                                                       15420000
                                                                        15430000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         15440000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       15450000
         LR    R12,R15              NEW BASE REGISTER                   15460000
                                                                        15470000
         SEND  CONTROL=RSHUTD,                                         +15480000
               STYPE=REQ,                                              +15490000
               RPL=(RIRPL),                                            +15500000
               ARG=(R2),                                               +15510000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +15520000
               POST=SCHED                                               15530000
                                                                        15540000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      15550000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    15560000
         BR    R14                  RETURN TO POINT OF CALL             15570000
                                                                        15580000
         LTORG                                                          15590000
                                                                        15600000
*---------------------------------------------------------------------- 15610000
* $SESS_SEND_RELQ EXTENSION                                             15620000
*---------------------------------------------------------------------- 15630000
                                                                        15640000
         DS    0D                                                       15650000
                                                                        15660000
         DROP  R12                                                      15670000
         USING *,R12                                                    15680000
                                                                        15690000
SENXRELQ DS    0H                                                       15700000
                                                                        15710000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         15720000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       15730000
         LR    R12,R15              NEW BASE REGISTER                   15740000
                                                                        15750000
         SEND  CONTROL=RELQ,                                           +15760000
               STYPE=REQ,                                              +15770000
               RPL=(RIRPL),                                            +15780000
               ARG=(R2),                                               +15790000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +15800000
               POST=SCHED                                               15810000
                                                                        15820000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      15830000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    15840000
         BR    R14                  RETURN TO POINT OF CALL             15850000
                                                                        15860000
         LTORG                                                          15870000
                                                                        15880000
*---------------------------------------------------------------------- 15890000
* $SESS_SEND_QEC EXTENSION                                              15900000
*---------------------------------------------------------------------- 15910000
                                                                        15920000
         DS    0D                                                       15930000
                                                                        15940000
         DROP  R12                                                      15950000
         USING *,R12                                                    15960000
                                                                        15970000
SENXQEC  DS    0H                                                       15980000
                                                                        15990000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         16000000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       16010000
         LR    R12,R15              NEW BASE REGISTER                   16020000
                                                                        16030000
         SEND  CONTROL=QEC,                                            +16040000
               STYPE=REQ,                                              +16050000
               RPL=(RIRPL),                                            +16060000
               ARG=(R2),                                               +16070000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +16080000
               POST=SCHED                                               16090000
                                                                        16100000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      16110000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    16120000
         BR    R14                  RETURN TO POINT OF CALL             16130000
                                                                        16140000
         LTORG                                                          16150000
                                                                        16160000
*---------------------------------------------------------------------- 16170000
* $SESS_SEND_QC EXTENSION                                               16180000
*---------------------------------------------------------------------- 16190000
                                                                        16200000
         DS    0D                                                       16210000
                                                                        16220000
         DROP  R12                                                      16230000
         USING *,R12                                                    16240000
                                                                        16250000
SENXQC   DS    0H                                                       16260000
                                                                        16270000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         16280000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       16290000
         LR    R12,R15              NEW BASE REGISTER                   16300000
                                                                        16310000
         SEND  CONTROL=QC,                                             +16320000
               STYPE=REQ,                                              +16330000
               RPL=(RIRPL),                                            +16340000
               ARG=(R2),                                               +16350000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +16360000
               POST=SCHED                                               16370000
                                                                        16380000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      16390000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    16400000
         BR    R14                  RETURN TO POINT OF CALL             16410000
                                                                        16420000
         LTORG                                                          16430000
                                                                        16440000
*---------------------------------------------------------------------- 16450000
* $SESS_SEND_SBI EXTENSION                                              16460000
*---------------------------------------------------------------------- 16470000
                                                                        16480000
         DS    0D                                                       16490000
                                                                        16500000
         DROP  R12                                                      16510000
         USING *,R12                                                    16520000
                                                                        16530000
SENXSBI  DS    0H                                                       16540000
                                                                        16550000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         16560000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       16570000
         LR    R12,R15              NEW BASE REGISTER                   16580000
                                                                        16590000
         SEND  CONTROL=SBI,                                            +16600000
               STYPE=REQ,                                              +16610000
               RPL=(RIRPL),                                            +16620000
               ARG=(R2),                                               +16630000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +16640000
               POST=SCHED                                               16650000
                                                                        16660000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      16670000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    16680000
         BR    R14                  RETURN TO POINT OF CALL             16690000
                                                                        16700000
         LTORG                                                          16710000
                                                                        16720000
*---------------------------------------------------------------------- 16730000
* $SESS_SEND_BIS EXTENSION                                              16740000
*---------------------------------------------------------------------- 16750000
                                                                        16760000
         DS    0D                                                       16770000
                                                                        16780000
         DROP  R12                                                      16790000
         USING *,R12                                                    16800000
                                                                        16810000
SENXBIS  DS    0H                                                       16820000
                                                                        16830000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         16840000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       16850000
         LR    R12,R15              NEW BASE REGISTER                   16860000
         OC    RPLURH,RPLURH        IS THERE SOME URH?                  16870000
         BNZ   SXBISURH             BRANCH IF YES                       16880000
                                                                        16890000
         SEND  CONTROL=BIS,                                            +16900000
               STYPE=REQ,                                              +16910000
               RPL=(RIRPL),                                            +16920000
               ARG=(R2),                                               +16930000
               OPTCD=(NUSERRH,ASY,NLMPEO,NBUFFLST),                    +16940000
               POST=SCHED                                               16950000
                                                                        16960000
         B     SXBISEND                                                 16970000
                                                                        16980000
SXBISURH DS    0H                                                       16990000
                                                                        17000000
         SEND  CONTROL=BIS,                                            +17010000
               STYPE=REQ,                                              +17020000
               RPL=(RIRPL),                                            +17030000
               ARG=(R2),                                               +17040000
               OPTCD=(USERRH,ASY,NLMPEO,NBUFFLST),                     +17050000
               POST=SCHED                                               17060000
                                                                        17070000
SXBISEND DS    0H                                                       17080000
                                                                        17090000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      17100000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    17110000
         BR    R14                  RETURN TO POINT OF CALL             17120000
                                                                        17130000
         LTORG                                                          17140000
                                                                        17150000
*---------------------------------------------------------------------- 17160000
* $SESS_SEND_RQR EXTENSION                                              17170000
*---------------------------------------------------------------------- 17180000
                                                                        17190000
         DS    0D                                                       17200000
                                                                        17210000
         DROP  R12                                                      17220000
         USING *,R12                                                    17230000
                                                                        17240000
SENXRQR  DS    0H                                                       17250000
                                                                        17260000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         17270000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       17280000
         LR    R12,R15              NEW BASE REGISTER                   17290000
                                                                        17300000
         SESSIONC CONTROL=RQR,                                         +17310000
               STYPE=REQ,                                              +17320000
               RPL=(RIRPL),                                            +17330000
               ARG=(R2),                                               +17340000
               OPTCD=(ASY)                                              17350000
                                                                        17360000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      17370000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    17380000
         BR    R14                  RETURN TO POINT OF CALL             17390000
                                                                        17400000
         LTORG                                                          17410000
                                                                        17420000
*---------------------------------------------------------------------- 17430000
* $SESS_SEND_STSN EXTENSION                                             17440000
*---------------------------------------------------------------------- 17450000
                                                                        17460000
         DS    0D                                                       17470000
                                                                        17480000
         DROP  R12                                                      17490000
         USING *,R12                                                    17500000
                                                                        17510000
SENXSTSN DS    0H                                                       17520000
                                                                        17530000
         ST    R12,IRPR15           SAVE MAINLINE BASE REGISTER         17540000
         ST    R14,IRPR0            SAVE MAINLINE RETURN REGISTER       17550000
         LR    R12,R15              NEW BASE REGISTER                   17560000
                                                                        17570000
         SESSIONC CONTROL=STSN,                                        +17580000
               STYPE=REQ,                                              +17590000
               RPL=(RIRPL),                                            +17600000
               ARG=(R2),                                               +17610000
               OPTCD=(ASY)                                              17620000
                                                                        17630000
         L     R12,IRPR15           RESTORE MAINLINE BASE REGISTER      17640000
         L     R14,IRPR0            RESTORE MAINLINE RETURN REGISTER    17650000
         BR    R14                  RETURN TO POINT OF CALL             17660000
                                                                        17670000
         LTORG                                                          17680000
                                                                        17690000
*---------------------------------------------------------------------- 17700000
* DSECTS                                                                17710000
*---------------------------------------------------------------------- 17720000
         PRINT NOGEN                                                    17730000
         IHAPSA ,                 MVS PREFIXED SAVE AREA                17740000
         ISTDBIND ,               VTAM BIND IMAGE                       17750000
         ISTRH ,                  VTAM SNA REQUEST HEADER               17760000
         TRACODES ,               INTEGRATOR TRACE CODE EQUATES         17770000
         ICVT  ,                  INTEGRATOR CVT                        17780000
         IVTAMCVT ,               INTEGRATOR VTAM CVT                   17790000
         IRPL ,                   INTEGRATOR VTAM RPL+                  17800000
         IACB ,                   INTEGRATOR VTAM ACB+                  17810000
         INIB ,                   INTEGRATOR VTAM NIB+                  17820000
         ISESS ,                  INTEGRATOR SESSION BLOCK              17830000
         IRQE ,                   INTEGRATOR RECEIVE QUEUE ELEMENT      17840000
         IVUSER ,                 INTEGRATOR VTAM USER BLOCK            17850000
         ITASK ,                  INTEGRATOR TASK BLOCK                 17860000
         IWEVTAM ,                INTEGRATOR VTAM WORK ELEMENT          17870000
         TMSG  ,                  INTEGRATOR INTERTASK MSG FORMAT       17880000
         EVCODES ,                INTEGRATOR EVENT CODES                17890000
         ABCODES ,                INTEGRATOR $ABEND CODES               17900000
         MSGCODES ,               INTEGRATOR INTERTASK MSGING CODES     17910000
         @EPB ,                   INTEGRATOR EVENT PROCESS BLOCK        17920000
         $TASK DSECT=YES          INTEGRATOR $TASK SERVICES             17930000
         $PROC DSECT=YES          INTEGRATOR $PROC SERVICES             17940000
         $VTAM DSECT=YES          INTEGRATOR $VTAM SERVICES             17950000
         $SESS DSECT=YES          INTEGRATOR $SESS SERVICES             17960000
         IFGEXLST ,               VTAM EXIT LIST                        17970000
         END   ,                                                        17980000
