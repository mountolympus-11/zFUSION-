IPSBLOC  TITLE ' - PREPARED STATEMENT BLOCK LOCATE'                     00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE: IPSBLOC  - PREPARED STATEMENT BLOCK LOCATE                   00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    THIS ROUTINE IS USED TO LOCATE THE PREPARED SQL STATEMENT          00080000
*    BLOCK (PSB) IDENTIFIED BY ITS COOP-ASSIGNED HANDLE                 00090000
*    PROVIDED AS INPUT.                                                 00100000
*                                                                       00110000
* ENTRY:                                                                00120000
*                                                                       00130000
*    R1  CONTAINS THE ADDRESS OF PREPARED STATEMENT TOKEN               00140000
*                                                                       00150000
* EXIT:                                                                 00160000
*                                                                       00170000
*    R15 CONTAINS ONE OF THE FOLLOWING RETURN CODES                     00180000
*                                                                       00190000
*        RC00 - PSB LOCATED AND RETURNED VIA R1                         00200000
*        RC04 - NO PSB MATCHES SELECTION CRITERIA                       00210000
*                                                                       00220000
**<DOC-OFF>****************************************************         00230000
                                                                        00240000
         EJECT                                                          00250000
***************************************************************         00260000
*                                                                       00270000
* MAINTENANCE:                                                          00280000
*                                                                       00290000
*   04/26/94  R. TURGEON                                                00300000
*             INITIAL VERSION                                           00310000
*                                                                       00320000
***************************************************************         00330000
                                                                        00340000
         EJECT                                                          00350000
         IUSER ,                       COOP INSTANCE (USER) BLOCK       00360000
                                                                        00370000
         EJECT                                                          00380000
         NAV   ,                       NAVIGATION / PLAN STRUCTURES     00390000
                                                                        00400000
         EJECT                                                          00410000
         PSB   ,                       TABLE INTERFACE BLOCK (TIB)      00420000
                                                                        00430000
         EJECT                                                          00440000
         EQUS  ,                                                        00450000
                                                                        00460000
         EJECT                                                          00470000
IPSBLOC  #ENTER BASE=R12,PREG=(R8),SAVE=NO                              00480000
                                                                        00490000
         USING ITASK,R10               ITASK ADDRESSABILITY             00500000
         L     R9,TSKPCBC              PROCESS MODE                     00510000
         USING IPCB,R9                                                  00520000
                                                                        00530000
         EJECT                                                          00540000
*--------------------------------------------------------------         00550000
*   LOCATE COOP'S IUSER, SCAN PSB CHAIN FOR MATCHING TOKEN              00560000
*--------------------------------------------------------------         00570000
         L     R6,PCBUSER              USER INSTANCE                    00580000
         USING IUSER,R6                                                 00590000
                                                                        00600000
         ICM   R4,15,USRPSBS           LOCATE FIRST PSB                 00610000
         BZ    FAIL                    TOKEN NOT MATCHED                00620000
         USING PSB,R4                  PREPARED STATEMENT BLOCK         00630000
                                                                        00640000
NEXT     DS    0H                      PSB CHAIN SCAN                   00650000
         CLC   PSBTOKEN,0(R8)          MATCHING TOKENS                  00660000
         BE    MATCH                   PSB LOCATED                      00670000
         ICM   R4,15,PSBNEXT           ELSE TRY NEXT PSB                00680000
         BNZ   NEXT                    AGAIN                            00690000
                                                                        00700000
*--------------------------------------------------------------         00710000
*   RETURN COMPLETION STATUS AND PSB TO REQUESTER                       00720000
*--------------------------------------------------------------         00730000
FAIL     DS    0H                      PSB NOT FOUND                    00740000
         LA    R15,RC04                INDICATE FAILURE                 00750000
         SR    R1,R1                   NO PSB RETURNED                  00760000
         B     RETURN                                                   00770000
                                                                        00780000
MATCH    DS    0H                      PSB FOUND                        00790000
         LA    R15,RC00                INDICATE SUCCESS                 00800000
         LA    R1,PSB                  RETURN MATCHED PSB PTR           00810000
                                                                        00820000
RETURN   DS    0H                                                       00830000
         #EXIT ,                                                        00840000
                                                                        00850000
         EJECT                                                          00860000
***************************************************************         00870000
*                                                                       00880000
*   LOCAL READ ONLY STORAGE                                             00890000
*                                                                       00900000
***************************************************************         00910000
         LTORG ,                                                        00920000
                                                                        00930000
         PRINT NOGEN                                                    00940000
         ICVT  ,                                                        00950000
         ITASK ,                                                        00960000
         IPCB  ,                                                        00970000
         END   ,                                                        00980000
