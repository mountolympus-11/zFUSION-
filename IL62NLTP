IL62NLTP TITLE 'INTEGRATOR - WE PROCESSOR LOAD TRANSACTION PROGRAM'     00010000
                                                                        00020000
         PRINT NOGEN                                                    00030000
         CMINCL ,                 INTEGRATOR CPI-C DEFINITIONS          00040000
         L62INCL ,                INTEGRATOR LU6.2 DEFINITIONS          00050000
         PRINT GEN                                                      00060000
                                                                        00070000
**<DOC-ON>************************************************************* 00080000
*                                                                       00090000
* ROUTINE: IL62NLTP - INTEGRATOR WE PROCESSOR LOAD TRANSACTION PROGRAM  00100000
*                                                                       00110000
* DESCRIPTION:                                                          00120000
*                                                                       00130000
* ON ENTRY:                                                             00140000
*                                                                       00150000
*    R15 = ENTRY POINT ADDRESS                                          00160000
*    R14 = RETURN ADDRESS                                               00170000
*    R13 = AVAILABLE SAVE AREA                                          00180000
*    R11 = ICVT ADDRESS                                                 00190000
*    R10 = ITASK ADDRESS                                                00200000
*    R01 = IWE ADDRESS (WORK ELEMENT)                                   00210000
*                                                                       00220000
* ON EXIT:                                                              00230000
*                                                                       00240000
*    R15 = 0                                                            00250000
*    R00 = 0                                                            00260000
*    R01 = 0                                                            00270000
*                                                                       00280000
*    ALL OTHER REGISTERS ARE RESTORED                                   00290000
*                                                                       00300000
**<DOC-OFF>************************************************************ 00310000
                                                                        00320000
         EJECT ,                                                        00330000
*********************************************************************** 00340000
*                                                                       00350000
* MAINTENANCE:                                                          00360000
*                                                                       00370000
*   07/01/94 RANDY WITEK                                                00380000
*   12/31/95 RANDY WITEK - 2.1 TRANSACTION PROGRAM VTAM WU SUPPORT      00390000
*                                                                       00400000
*********************************************************************** 00410000
                                                                        00420000
         EQUS  ,                  GENERAL EQUATES                       00430000
                                                                        00440000
RICVT    EQU   R11                                                      00450000
RITASK   EQU   R10                                                      00460000
RIVTAM   EQU   R9                                                       00470000
RIACB    EQU   R8                                                       00480000
RIRPL    EQU   R7                                                       00490000
RIWE     EQU   R6                                                       00500000
                                                                        00510000
         USING ICVT,RICVT         ESTABLISH ADDRESSABILITY              00520000
         USING ITASK,RITASK       ESTABLISH ADDRESSABILITY              00530000
         USING IVTAMCVT,RIVTAM    ESTABLISH ADDRESSABILITY              00540000
         USING IACB,RIACB         ESTABLISH ADDRESSABILITY              00550000
         USING IRPL,RIRPL         ESTABLISH ADDRESSABILITY              00560000
         USING IWEVTAM,RIWE       ESTABLISH ADDRESSABILITY              00570000
                                                                        00580000
WORKAREA #WORK ,                  READ/WRITE WORKAREA                   00590000
L62MFL   L62DFPL MF=L             PLIST CONSTRUCTION                    00600000
WRK256   DS    XL256              GENERAL WORKAREA                      00610000
RETEP    DS    F                  LU6.2 EP ADDRESS RETURN AREA          00620000
RETWU    DS    CL4                LU6.2 WU TYPE    RETURN AREA          00630000
RETCODE  DS    F                  LU6.2 RETURN CODE AREA (POST CODE)    00640000
RETRC    DS    F                  LU6.2 RETURN CODE AREA                00650000
RETR15   DS    F                  RETURN CODE VALUE                     00660000
RETR0    DS    F                  RETURN REGISTER 0                     00670000
RETR1    DS    F                  RETURN REGISTER 1                     00680000
RETREGS  EQU   RETR15,*-RETR15    INCLUSIVE SYMBOL                      00690000
WORKLEN  #ENDWORK                 END OF WORKAREA                       00700000
                                                                        00710000
         $MSGDFT PREFIX=ICTPID,                                        +00720000
               COMPID='L62',                                           +00730000
               TABLE=*#MSGS,                                           +00740000
               WORKA=0,                                                +00750000
               MF=(E,WRK256),                                          +00760000
               PRINT=NOGEN                                              00770000
                                                                        00780000
IL62NLTP #ENTER BASE=R12,         ENTRY LINKAGE                        +00790000
               AMODE=31,                                               +00800000
               PREG=(RIWE),                                            +00810000
               RMODE=ANY                                                00820000
                                                                        00830000
*---------------------------------------------------------------------- 00840000
* ISSUE LOAD TP CALL                                                    00850000
*---------------------------------------------------------------------- 00860000
                                                                        00870000
         L62LDTP IWEXUTPN,        ADDRESS OF TPNAME                    +00880000
               RETEP,             ADDRESS OF EP ADDRESS RETURN AREA    +00890000
               RETWU,             ADDRESS OF WU TYPE    RETURN AREA    +00900000
               RETCODE,           ADDRESS OF RETURN_CODE AREA          +00910000
               MF=(E,L62MFL)      LOAD THE TRANSACTION PROGRAM          00920000
                                                                        00930000
*---------------------------------------------------------------------- 00940000
* POST PROCESS WAITING ON LOAD TP                                       00950000
*---------------------------------------------------------------------- 00960000
                                                                        00970000
         OC    IWEXUEPB,IWEXUEPB  ADDRESS OF ASSOCIATED EPB             00980000
         BZ    EXIT               BRANCH IF NO EPB                      00990000
                                                                        01000000
         L62POST *IWEXUEPB,       ADDRESS OF EPB TO BE POSTED          +01010000
               RETCODE,           ADDRESS OF POST CODE                 +01020000
               IWEXUENT,          ADDRESS OF ENTITY TOKEN              +01030000
               RETRC,             RETURN CODE AREA                     +01040000
               MF=(E,L62MFL)                                            01050000
                                                                        01060000
         B     EXIT               BRANCH IF NO EPB                      01070000
                                                                        01080000
*---------------------------------------------------------------------- 01090000
* RETURN TO MAIN TASK MAINLINE                                          01100000
*---------------------------------------------------------------------- 01110000
                                                                        01120000
EXIT     DS    0H                                                       01130000
                                                                        01140000
         LM    R15,R1,RETREGS     LOAD RETURN REGISTERS                 01150000
                                                                        01160000
         #EXIT R1=YES             RETURN W/R15,R0,R1                    01170000
                                                                        01180000
*---------------------------------------------------------------------- 01190000
* ERROR ROUTINES                                                        01200000
*---------------------------------------------------------------------- 01210000
                                                                        01220000
*---------------------------------------------------------------------- 01230000
*  CONSTANTS AND LITERALS                                               01240000
*---------------------------------------------------------------------- 01250000
                                                                        01260000
         LTORG ,                                                        01270000
         PRINT NOGEN                                                    01280000
         IHAPSA ,                 MVS PREFIXED SAVE AREA                01290000
         ISTDBIND ,               VTAM BIND IMAGE                       01300000
         ICVT  ,                  INTEGRATOR CVT                        01310000
         IVTAMCVT ,               INTEGRATOR VTAM CVT                   01320000
         IRPL ,                   INTEGRATOR VTAM RPL+                  01330000
         IACB ,                   INTEGRATOR VTAM ACB+                  01340000
         INIB ,                   INTEGRATOR VTAM NIB+                  01350000
         ISESS ,                  INTEGRATOR SESSION BLOCK              01360000
         IVUSER ,                 INTEGRATOR VTAM USER BLOCK            01370000
         ITASK ,                  INTEGRATOR TASK BLOCK                 01380000
         IWEVTAM ,                INTEGRATOR VTAM WORK ELEMENT          01390000
         TMSG  ,                  INTEGRATOR INTERTASK MSG FORMAT       01400000
         EVCODES ,                INTEGRATOR EVENT CODES                01410000
         ABCODES ,                INTEGRATOR $ABEND CODES               01420000
         MSGCODES ,               INTEGRATOR INTERTASK MSGING CODES     01430000
         @EPB ,                   INTEGRATOR EVENT PROCESS BLOCK        01440000
         $VTAM DSECT=YES          INTEGRATOR $VTAM SERVICES             01450000
         IFGEXLST ,               VTAM EXIT LIST                        01460000
         END   ,                                                        01470000
