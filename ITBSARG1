ITBSARG1 TITLE 'TABLE SERVICES - VER 1 SEARCH ARG / FILTER APPLICATION' 00010000
**<DOC-ON>*****************************************************         00020000
*                                                                       00030000
* ROUTINE:  ITBSARG1 - Ver 1 search arg / filter application            00040000
*                                                                       00050000
* DESCRIPTION:                                                          00060000
*                                                                       00070000
*    This routine accepts an execution-ready predicate tree,            00080000
*    as prepared by TBPSARG and a table row in stored row               00090000
*    format and determines whether the row satisfies the                00100000
*    selection criterea expressed therein.  The service can             00110000
*    be used as a filter to either suppress admission or                00120000
*    return of undesired rows.                                          00130000
*                                                                       00140000
*    Both the predicate and connector nodes may include a               00150000
*    predetermined, invariant truth value (catagorically TRUE           00160000
*    or FALSE) that is reflected up the tree without evaluating         00170000
*    the predicate (TBBPRED.TBPRTV) or connector subtrees               00180000
*    (TBCONN.TBCOTV).                                                   00190000
*                                                                       00200000
*                                                                       00210000
* NOTES:                                                                00220000
*                                                                       00230000
*    Standard character and signed/unsigned integer numeric             00240000
*    datatypes are supported.                                           00250000
*                                                                       00260000
*                                                                       00270000
* ON ENTRY:                                                             00280000
*                                                                       00290000
*    R1  contains the address of a parameter list mapped by             00300000
*        SARG1PRM                                                       00310000
*                                                                       00320000
*                                                                       00330000
* ON EXIT:                                                              00340000
*                                                                       00350000
*    R15 contains one of the following return codes                     00360000
*                                                                       00370000
*        RC00 - row satisfies search/filter criteria                    00380000
*                                                                       00390000
*        RC04 - row does not satisfy search/filter criteria             00400000
*                                                                       00410000
*        RC08 - reserved                                                00420000
*                                                                       00430000
*        RC12 - invalid search argument tree                            00440000
*                                                                       00450000
*               R1 contains the address of an invalid node or           00460000
*                  zero if the error is not attributed to a             00470000
*                  single or identifiable predicate tree node           00480000
*                                                                       00490000
**<DOC-OFF>****************************************************         00500000
                                                                        00510000
         EJECT                                                          00520000
WORKAREA DSECT                                                          00530000
                                                                        00540000
         @WORK ,                  STANDARD WORKAREA                     00550000
                                                                        00560000
WORKFREE DS    0D                 AVAILABLE TO SERVICE ROUTINES         00570000
WORKLEN  EQU   *-WORKAREA         LENGTH OF WORKAREA                    00580000
                                                                        00590000
         EJECT                                                          00600000
         SARG1PRM ,               PARAMETER LIST FORMAT                 00610000
                                                                        00620000
         EJECT                                                          00630000
         TBBNODES ,               MODIFIED SARG LIST AND TREE           00640000
                                                                        00650000
         EJECT                                                          00660000
         $STG  TYPE=DSECT         MAPPINGS REQUIRED IN @TABLE           00670000
                                                                        00680000
         EJECT                                                          00690000
         @TABLE ,                 TABLE OBJECT PREFIX                   00700000
                                                                        00710000
         EJECT                                                          00720000
         @TBCOLDF ,               COLUMN DEFINITION                     00730000
                                                                        00740000
         EJECT                                                          00750000
         ROWPFX ,                 STORED ROW PREFIX                     00760000
                                                                        00770000
         EJECT                                                          00780000
         COLHDR ,                 COLUMN DEFINITION HEADER / LINKAGE    00790000
                                                                        00800000
         EJECT                                                          00810000
         $LIKE DSECT=YES          $LIKE PREDICATE                       00820000
                                                                        00830000
         EJECT                                                          00840000
         EQUS  LINKAGE=VCON                                             00850000
                                                                        00860000
         EJECT                                                          00870000
ITBSARG1 @ENTER WORKA=(WORKAREA,WORKLEN),ASC=AR                         00880000
                                                                        00890000
***************************************************************         00900000
*                                                                       00910000
*   General initialization and validation                               00920000
*                                                                       00930000
***************************************************************         00940000
                                                                        00950000
         LAM   R1,R7,MFE_LIST     PRIMARY SPACE WINDOWS                 00960000
                                                                        00970000
         LR    R7,R1              PARAMETER LIST                        00980000
         USING SARG1PRM,R7        SEARCH ARG APPLICATION REQUEST        00990000
         L     R11,SA1PTABL       TABLE ORIGIN                          01000000
         LAM   R11,R11,SA1PALET   QUALIFIED TO OBJECT SPACE             01010000
         USING TABLE,R11          LIFE OF ROUTINE                       01020000
                                                                        01030000
         ICM   R6,15,SA1PSARG     LOCATE SARG BLOCK                     01040000
         BZ    END_ACPT           ACCEPT CANDIDATE ROW                  01050000
         USING TBSARG1,R6         VERSION 1 FORMAT                      01060000
                                                                        01070000
         CLI   TBS1VER,TBS1SAV1   VERSION 1 FORMAT OR BETTER?           01080000
         BL    ERR_REQ            IMPROPER REQUEST IF NOT               01090000
         TM    TBS1VAL,TBS1$VAL   SARG/FILTER EXECUTION-READY?          01100000
         BNO   ERR_REQ            IMPROPER REQUEST IF NOT               01110000
                                                                        01120000
         EJECT                                                          01130000
***************************************************************         01140000
*                                                                       01150000
*   Clash the stored row against the search argument/filter             01160000
*                                                                       01170000
***************************************************************         01180000
                                                                        01190000
         L     R1,TBS1NODE        R1 <== TREE ORIGIN                    01200000
         SR    R0,R0              R0 <== ERROR NOTIFICATION FLAG        01210000
         BAS   R14,EVALTREE       EVALUATE THE SARG TREE                01220000
                                                                        01230000
         B     *+4(R15)           ANALYZE SUITABILITY OF CANDIDATE ROW  01240000
         B     END_ACPT              ROW MATCHES ARGUMENTS              01250000
         B     END_FAIL              ROW DOES NOT MATCH ARGUMENT        01260000
         B     ERR_REQD              IMPROPERLY FORMED SEARCH ARG       01270000
                                                                        01280000
         EJECT                                                          01290000
***************************************************************         01300000
*                                                                       01310000
*   Return completion status to caller                                  01320000
*                                                                       01330000
***************************************************************         01340000
                                                                        01350000
END_ACPT DS    0H                 CANDIDATE SATISFIES REQUIREMENTS      01360000
         LA    R15,RC00                                                 01370000
         B     RETURN                                                   01380000
                                                                        01390000
END_FAIL DS    0H                 SEARCH ARGUMENT NOT SATISFIED         01400000
         LA    R15,RC04                                                 01410000
         B     RETURN                                                   01420000
                                                                        01430000
ERR_REQ  DS    0H                 INVALID REQUEST                       01440000
         LA    R15,RC12                                                 01450000
         SR    R1,R1              NODE ADDRESS NOT PROVIDED             01460000
         B     RETURN                                                   01470000
                                                                        01480000
ERR_REQD DS    0H                 INVALID REQUEST, NODE ADDR IN R1      01490000
         LA    R15,RC12                                                 01500000
         B     RETURN                                                   01510000
                                                                        01520000
RETURN   DS    0H                 RETURN                                01530000
         NOP   0                  XDC                                   01540000
                                                                        01550000
         @EXIT ,                                                        01560000
                                                                        01570000
         EJECT                                                          01580000
***************************************************************         01590000
*                                                                       01600000
* ROUTINE: EVALTREE - Recursive analysis of row vs sarg                 01610000
*                                                                       01620000
*                                                                       01630000
* ON ENTRY:                                                             01640000
*                                                                       01650000
*    R1  contains the addr of the sarg subtree root                     01660000
*                                                                       01670000
*    table is addressable                                               01680000
*                                                                       01690000
*                                                                       01700000
* ON EXIT:                                                              01710000
*                                                                       01720000
*    R15 contains the truth value of the input subtree                  01730000
*                                                                       01740000
*        RC00 - true (match)                                            01750000
*        RC04 - false (mismatch)                                        01760000
*                                                                       01770000
*        RC08 - improperly formed search argument                       01780000
*                                                                       01790000
*               R1 contains the address of the invalid node             01800000
*                                                                       01810000
***************************************************************         01820000
                                                                        01830000
EVALTREE DS    0H                                                       01840000
         BAKR  R14,0              SAVE MAINLINE REGS                    01850000
                                                                        01860000
         LR    R5,R1              CURRENT SUBTREE NODE                  01870000
         CLI   0(R5),TBCO$CON     BOOLEAN CONNECTOR NODE?               01880000
         BNE   EVALPRED           VALUE <RELOP> CONSTANT                01890000
                                                                        01900000
***************************************************************         01910000
*                                                                       01920000
*   Evaluate boolean (and/*, or/+) connector                            01930000
*                                                                       01940000
***************************************************************         01950000
                                                                        01960000
EVALCON  DS    0H                                                       01970000
         USING TBCONN,R5          BOOLEAN CONNECTOR NODE                01980000
                                                                        01990000
         ICM   R0,1,TBCOTV        TRUTH VALUE PREVIOUSLY DETERMINED?    02000000
         BP    EVAL_HIT           CATEGORICALLY TRUE                    02010000
         BM    EVALMISS           CATEGORICALLY FALSE                   02020000
                                                                        02030000
         L     R1,TBCOLEFT        EVALUATE LEFT SUBTREE                 02040000
         BAS   R14,EVALTREE       RECURSIVE ENTRY                       02050000
         CH    R15,=AL2(RC08)     ERROR ENCOUNTERED?                    02060000
         BE    EVALEND            PROPOGATE THE FAIURE IF SO            02070000
                                                                        02080000
         LA    R3,EVALEND         CONTINUATION IF (TRUE + <ANY>)        02090000
         CLI   TBCOCTYP,TBCO$OR   CONNECTOR IS AN OR?                   02100000
         BE    *+8                SKIP IF NOT                           02110000
         LA    R3,EVALRGHT        CONTINUATION IF (TRUE * <ANY>)        02120000
         LTR   R15,R15            LEFT SUBTREE YIELDS TRUE?             02130000
         BZR   R3                 CONTINUE ACCORDINGLY IF SO            02140000
                                                                        02150000
         CLI   TBCOCTYP,TBCO$OR   DETERMINE CONNECTOR TYPE              02160000
         BE    EVALRGHT           CONTINUATION IF (FALSE + <ANY>)       02170000
         B     EVALEND            CONTINUATION IF (FALSE * <ANY>)       02180000
                                                                        02190000
EVALRGHT DS    0H                                                       02200000
         L     R1,TBCORGHT        EVALUATE RIGHT SUBTREE                02210000
         BAS   R14,EVALTREE       RECURSIVE ENTRY                       02220000
         B     EVALEND            R15 CONTAINS TRUTH VALUE OR ERROR     02230000
                                                                        02240000
***************************************************************         02250000
*                                                                       02260000
*   Evaluate predicate as (column-value <relop> constant).              02270000
*   Note that A/R2 is used to address the stored table row,             02280000
*   contrary to normal table services register usage.                   02290000
*                                                                       02300000
***************************************************************         02310000
                                                                        02320000
EVALPRED DS    0H                                                       02330000
         USING TBBPRED,R5                                               02340000
         L     R1,TBPRCDEF        COLUMN DEFINITION OFFSET IN TABLE     02350000
         LAE   R10,TABLE(R1)      AR QUALIFIED ADDRESS OF COL INFO      02360000
         USING COLHDR,R10         COLUMN HEADER                         02370000
                                                                        02380000
         LAE   R9,COLDEF          COLUMN DEFINITION PROPER              02390000
         USING TBCOLDEF,R9        ADDRESSABILITY                        02400000
                                                                        02410000
         ICM   R0,1,TBPRTV        TRUTH VALUE PREVIOUSLY DETERMINED?    02420000
         BP    EVAL_HIT           CATEGORICALLY TRUE                    02430000
         BM    EVALMISS           CATEGORICALLY FALSE                   02440000
                                                                        02450000
         L     R2,SA1PROW         ADDRESS OF UNPREFIXED STORED ROW      02460000
         CPYA  AR2,AR11           RESIDES IN OBJECT SPACE               02470000
                                                                        02480000
***************************************************************         02490000
*                                                                       02500000
*   NULL predicate requires column existence test only                  02510000
*                                                                       02520000
***************************************************************         02530000
                                                                        02540000
         CLI   TBPRTYPE,TBPR$NUP  NULL PREDICATE?                       02550000
         BNE   TYPCOMPR           COMPARISON OF SOME KIND OTHERWISE     02560000
                                                                        02570000
         SH    R2,=AL2(RPFXLN)    BACKUP TO ORIGIN OF ROW PREFIX        02580000
         USING ROWPFX,R2          REQUIRED TO DETERMINE NULL USAGE      02590000
         TM    RPVARYSZ,X'80'     NULL INDICATOR MASK ATTACHED?         02600000
         BNO   NULLOFF            NO NULL COLUMNS OTHERWISE             02610000
         DROP  R2                 ROWPFX                                02620000
                                                                        02630000
         LA    R2,RPFXLN(R2)      BACK TO ROW DATA ORIGIN               02640000
         AL    R2,TBLROWSZ        ORIGIN OF NULL INDICATOR MASK         02650000
                                                                        02660000
         TESTBIT 0(,R2),*COLNUMBR                                       02670000
                                                                        02680000
         BNO   NULLOFF                                                  02690000
                                                                        02700000
*--------------------------------------------------------------         02710000
*   Column is null                                                      02720000
*--------------------------------------------------------------         02730000
                                                                        02740000
         CLI   TBPROPR,TBPR$IS    IS NULL TEST?                         02750000
         BE    EVAL_HIT           SATISFIES                             02760000
         B     EVALMISS           FAILS                                 02770000
                                                                        02780000
*--------------------------------------------------------------         02790000
*   Column is not null                                                  02800000
*--------------------------------------------------------------         02810000
                                                                        02820000
NULLOFF  DS    0H                                                       02830000
         CLI   TBPROPR,TBPR$NOT   IS NOT NULL TEST?                     02840000
         BE    EVAL_HIT           SATISFIES                             02850000
         B     EVALMISS           FAILS                                 02860000
                                                                        02870000
***************************************************************         02880000
*                                                                       02890000
*   Comparison predicates - locate comparand in stored row              02900000
*                                                                       02910000
***************************************************************         02920000
                                                                        02930000
TYPCOMPR DS    0H                                                       02940000
         AL    R2,COLDISPL        LOCATE ORIGIN OF STORED COLUMN        02950000
         L     R3,TBCLENG         LOCALLY STORED DATA - EXTRACT LENGTH  02960000
                                                                        02970000
         CLI   TBCDTYPE,$VCHAR    IDENTIFY REMOTELY STORED VARDATA      02980000
         BE    VDATA                                                    02990000
         CLI   TBCDTYPE,$VBIN                                           03000000
         BE    VDATA                                                    03010000
                                                                        03020000
         CLI   TBCDTYPE,$VCHARX   IDENTIFY REMOTELY STORED VARDATAX     03030000
         BE    XDATA                                                    03040000
         CLI   TBCDTYPE,$VBINX                                          03050000
         BE    XDATA                                                    03060000
         B     TYPEANAL                                                 03070000
                                                                        03080000
VDATA    DS    0H                 SET VARDATA STRING ORIGIN AND LENGTH  03090000
         SR    R3,R3              ASSUME NULL STRING                    03100000
         ICM   R2,15,0(R2)        VARDATA STRUCTURE ORIGIN              03110000
         LAE   R2,TABLE(R2)       CONVERT OFFSET TO ADDRESS             03120000
         BZ    TYPEANAL           NULL                                  03130000
         ICM   R3,3,0(R2)         ACQUIRE STRING LENGTH                 03140000
         LA    R2,2(,R2)          AND ORIGIN                            03150000
         B     TYPEANAL           READY FOR COMPARE                     03160000
                                                                        03170000
XDATA    DS    0H                                                       03180000
         ICM   R3,15,0(R2)        ACQUIRE STRING LENGTH                 03190000
         ICM   R2,15,4(R2)        AND ORIGIN                            03200000
         LAE   R2,TABLE(R2)       CONVERT OFFSET TO ADDRESS             03210000
                                                                        03220000
*--------------------------------------------------------------         03230000
*   Select comparison procedure by comparand data type                  03240000
*--------------------------------------------------------------         03250000
                                                                        03260000
TYPEANAL DS    0H                                                       03270000
         CLI   TBPRTYPE,TBPR$LIK  MASKED (LIKE) STRING COMPARE?         03280000
         BE    EVLIKE                                                   03290000
                                                                        03300000
         SR    R15,R15            PREPARE FOR INSERT                    03310000
         IC    R15,TBCDTYPE       FETCH PRIMARY DATA TYPE               03320000
         SLL   R15,2              CONVERT TO MULTIPLE OF FOUR           03330000
                                                                        03340000
         B     *+4(R15)                                                 03350000
         B     TYPENUM            NUMERIC DATA TYPE                     03360000
         B     EV_CHR             CHAR                                  03370000
         B     EV_BIN             BINARY                                03380000
         B     EVAL_ERR           BOOLEAN                               03390000
         B     EV_CHR             VARCHAR                               03400000
         B     EV_BIN             VARBINARY                             03410000
         B     EV_CHR             VARCHAR ALTERNATE FORMAT              03420000
         B     EV_BIN             VARBINARY ALTERNATE FORMAT            03430000
         B     EVAL_ERR           TIMESTAMP                             03440000
                                                                        03450000
TYPENUM  DS    0H                                                       03460000
         IC    R15,TBCNTYPE       FETCH NUMERIC DATA TYPE               03470000
         SLL   R15,2              CONVERT TO MULTIPLE OF FOUR           03480000
                                                                        03490000
         B     *+4(R15)                                                 03500000
         B     EVAL_ERR           RESERVED                              03510000
         B     EV_INT             INTEGER                               03520000
         B     EV_UINT            UNSIGNED INT                          03530000
         B     EVAL_ERR           DECIMAL                               03540000
         B     EVAL_ERR           MONEY                                 03550000
         B     EVAL_ERR           FLOAT                                 03560000
         B     EVAL_ERR           SCALE/PRECISION QUALIFIED NUMERIC     03570000
                                                                        03580000
*--------------------------------------------------------------         03590000
*   Datatype: like mask                                                 03600000
*--------------------------------------------------------------         03610000
                                                                        03620000
EVLIKE   DS    0H                                                       03630000
         LH    R4,TBPRCVLN        LENGTH OF MASK                        03640000
         STAM  AR2,AR2,FWORD      STORED ROW ALET AS PARM               03650000
                                                                        03660000
         $LIKE MASK=*TBPRCVAL,MASKLEN=(R4),                            X03670000
               STR=(R2),STRLEN=(R3),STRALET=*FWORD,                    X03680000
               MF=(E,MFE_LIST)                                          03690000
                                                                        03700000
         IC    R15,TBPROPR        ACQUIRE ENCODED RELATIONAL OPERATOR   03710000
         EX    R15,*+4            EVALUATE RESULT OF COMPARE            03720000
         BC    *-*,EVAL_HIT          SUCCESSFUL COMPARE                 03730000
         B     EVALMISS              UNSUCCESSFUL COMPARE               03740000
                                                                        03750000
*--------------------------------------------------------------         03760000
*   Datatype: char and char variants                                    03770000
*--------------------------------------------------------------         03780000
                                                                        03790000
EV_CHR   DS    0H                                                       03800000
         L     R14,TBPRCVAL       LOCATE COMPARAND VALUE                03810000
         LAE   R14,0(R14,0)       ENSURE REFERENCE TO PSPACE            03820000
         LH    R15,TBPRCVLN       ACQUIRE COMPARAND LENGTH              03830000
         ICM   R15,B'1000',=C' '  BLANK PAD                             03840000
         CLCL  R2,R14             COMPARE COLUMN TO SEARCH ARGUMENT     03850000
                                                                        03860000
         IC    R15,TBPROPR        ACQUIRE ENCODED RELATIONAL OPERATOR   03870000
         EX    R15,*+4            EVALUATE RESULT OF COMPARE            03880000
         BC    *-*,EVAL_HIT          SUCCESSFUL COMPARE                 03890000
         B     EVALMISS              UNSUCCESSFUL COMPARE               03900000
                                                                        03910000
*--------------------------------------------------------------         03920000
*   Datatype: binary and bin variants                                   03930000
*--------------------------------------------------------------         03940000
                                                                        03950000
EV_BIN   DS    0H                                                       03960000
         L     R14,TBPRCVAL       LOCATE COMPARAND VALUE                03970000
         LAE   R14,0(R14,0)       ENSURE REFERENCE TO PSPACE            03980000
         LH    R15,TBPRCVLN       ACQUIRE COMPARAND LENGTH              03990000
         CLCL  R2,R14             COMPARE COLUMN TO SEARCH ARGUMENT     04000000
                                                                        04010000
         IC    R15,TBPROPR        ACQUIRE ENCODED RELATIONAL OPERATOR   04020000
         EX    R15,*+4            EVALUATE RESULT OF COMPARE            04030000
         BC    *-*,EVAL_HIT          SUCCESSFUL COMPARE                 04040000
         B     EVALMISS              UNSUCCESSFUL COMPARE               04050000
                                                                        04060000
*--------------------------------------------------------------         04070000
*   Datatype: signed integer                                            04080000
*--------------------------------------------------------------         04090000
                                                                        04100000
EV_INT   DS    0H                                                       04110000
         BCTR  R3,0               PREPARE LENGTH FOR VALUE FETCH        04120000
         SLL   R3,2               TIMES 4 FOR FETCH TABLE               04130000
                                                                        04140000
         SR    R0,R0              CLEAR WORK REGISTER                   04150000
         EX    *-*,FETCH(R3)      LOAD R0 WITH VALUE FROM THE COLUMN    04160000
         BNM   *+8                SKIP IF POSITIVE                      04170000
         EX    *-*,SIGNXTND(R3)   ELSE EXTEND SIGN                      04180000
                                                                        04190000
         L     R3,TBPRCVAL        GET CONVERTED VALUE ADDRESS           04200000
         C     R0,0(,R3)          COMPARE COLUMN TO SEARCH ARGUMENT     04210000
                                                                        04220000
         IC    R15,TBPROPR        TEST SATISFACTION EVALUATOR           04230000
         EX    R15,*+4            EVALUATE RESULT OF COMPARE            04240000
         BC    *-*,EVAL_HIT          SUCCESSFUL COMPARE                 04250000
         B     EVALMISS              UNSUCCESSFUL COMPARE               04260000
                                                                        04270000
*--------------------------------------------------------------         04280000
*   Datatype: unsigned integer                                          04290000
*--------------------------------------------------------------         04300000
                                                                        04310000
EV_UINT  DS    0H                                                       04320000
         BCTR  R3,0               PREPARE LENGTH FOR VALUE FETCH        04330000
         SLL   R3,2               TIMES 4 FOR FETCH TABLE               04340000
         SR    R0,R0              CLEAR WORK REGISTER                   04350000
         EX    *-*,FETCH(R3)      LOAD R0 WITH VALUE FROM THE COLUMN    04360000
                                                                        04370000
         L     R3,TBPRCVAL        GET CONVERTED VALUE ADDRESS           04380000
         CL    R0,0(,R3)          COMPARE COLUMN TO SEARCH ARGUMENT     04390000
                                                                        04400000
         IC    R15,TBPROPR        TEST SATISFACTION EVALUATOR           04410000
         EX    R15,*+4            EVALUATE RESULT OF COMPARE            04420000
         BC    *-*,EVAL_HIT          MATCH                              04430000
         B     EVALMISS              MISMATCH                           04440000
                                                                        04450000
*--------------------------------------------------------------         04460000
*   Process boolean connector                                           04470000
*--------------------------------------------------------------         04480000
                                                                        04490000
EVAL_HIT DS    0H                                                       04500000
         LA    R15,RC00           MATCH                                 04510000
         B     EVALEND                                                  04520000
                                                                        04530000
EVALMISS DS    0H                                                       04540000
         LA    R15,RC04           MISMATCH                              04550000
         B     EVALEND                                                  04560000
                                                                        04570000
EVAL_ERR DS    0H                                                       04580000
         LA    R15,RC08           IMPROPER REQUEST                      04590000
         LAE   R1,0(R5,R0)        IDENTIFY NODE IN ERROR (PSPACE)       04600000
                                                                        04610000
EVALEND  DS    0H                 RETURN TO CALLER                      04620000
         NOP   0                  XDC                                   04630000
         PR    ,                                                        04640000
         DROP  R5                 VER 1 SARG TREE NODE                  04650000
                                                                        04660000
         EJECT                                                          04670000
***************************************************************         04680000
*                                                                       04690000
*   Local read only data areas                                          04700000
*                                                                       04710000
***************************************************************         04720000
                                                                        04730000
FETCH    DS    0H                 INTEGER FETCH                         04740000
         ICM   R0,1,0(R2)                                               04750000
         ICM   R0,3,0(R2)                                               04760000
         ICM   R0,7,0(R2)                                               04770000
         ICM   R0,15,0(R2)                                              04780000
                                                                        04790000
SIGNXTND DS    0F                 SIGNED INTEGER SIGN EXTEND            04800000
         O     R0,=X'FFFFFF00'                                          04810000
         O     R0,=X'FFFF0000'                                          04820000
         O     R0,=X'FF000000'                                          04830000
         O     R0,=X'00000000'                                          04840000
                                                                        04850000
         LTORG ,                                                        04860000
         END   ,                                                        04870000
