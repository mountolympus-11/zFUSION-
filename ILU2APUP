ILU2APUP TITLE 'INTEGRATOR - LU2 SESSION IMAGE UPDATE'                  00010000
                                                                        00020000
**<DOC-ON>************************************************************* 00030000
*                                                                       00040000
* ROUTINE: ILU2APUP - INTEGRATOR SESSION IMAGE UPDATE                   00050000
*                                                                       00060000
* DESCRIPTION: THIS ROUTINE IS CALLED TO PROCESS A 3270 DATASTREAM      00070000
*              SENT BY THE HOST APPLICATION.  IT IS CALLED BY           00080000
*              ILU2APPW OR ILU2APSF AFTER THE WRITE COMMAND HAS         00090000
*              BEEN ANALYZED.                                           00100000
*                                                                       00110000
* ON ENTRY:                                                             00120000
*                                                                       00130000
*    R15 = ENTRY POINT ADDRESS                                          00140000
*    R14 = RETURN ADDRESS                                               00150000
*    R13 = AVAILABLE SAVE AREA                                          00160000
*    R11 = ICVT ADDRESS                                                 00170000
*    R10 = ITASK ADDRESS                                                00180000
*    R01 = PARAMETER LIST ADDRESS                                       00190000
*          +00 --> SESSIMAG ADDRESS                                     00200000
*          +04 --> INPUT DATA ADDRESS                                   00210000
*          +08 --> INPUT DATA LENGTH                                    00220000
*                                                                       00230000
* ON EXIT:                                                              00240000
*                                                                       00250000
*    R15 = GENERAL RETURN CODE                                          00260000
*        = 0 --> INPUT SUCCESSFULLY PROCESSED, SEND POSITIVE RESPONSE   00270000
*                R00 = 0                                                00280000
*                R01 = 0                                                00290000
*        = 4 --> INPUT WAS IN ERROR, SEND NEGATIVE RESPONSE             00300000
*                R00 = SENSE DATA                                       00310000
*                R01 = 0                                                00320000
*                                                                       00330000
*    ALL OTHER REGISTERS ARE RESTORED.                                  00340000
*                                                                       00350000
**<DOC-OFF>************************************************************ 00360000
                                                                        00370000
*********************************************************************** 00380000
*                                                                       00390000
* MAINTENANCE:                                                          00400000
*                                                                       00410000
*   10/01/93 RANDY WITEK                                                00420000
*                                                                       00430000
*********************************************************************** 00440000
                                                                        00450000
         EQUS  ,                  GENERAL EQUATES                       00460000
                                                                        00470000
RICVT    EQU   R11                                                      00480000
RITASK   EQU   R10                                                      00490000
RIVTAM   EQU   R9                                                       00500000
RSESSIMG EQU   R8                                                       00510000
RDATA    EQU   R7                                                       00520000
RDATALEN EQU   R6                                                       00530000
                                                                        00540000
         USING ICVT,RICVT         ESTABLISH ADDRESSABILITY              00550000
         USING ITASK,RITASK       ESTABLISH ADDRESSABILITY              00560000
         USING IVTAMCVT,RIVTAM    ESTABLISH ADDRESSABILITY              00570000
         USING SESSIMAG,RSESSIMG  ESTABLISH ADDRESSABILITY              00580000
                                                                        00590000
WORKAREA #WORK ,                  READ/WRITE WORKAREA                   00600000
WRK256   DS    XL256              GENERAL WORKAREA                      00610000
SUB0SAVE DS    18F                SUBROUTINE SAVE AREA                  00620000
SUB1SAVE DS    18F                SUBROUTINE SAVE AREA                  00630000
IMAGE@   DS    A                  ADDRESS OF IMAGE BUFFER               00640000
OFFSET   DS    H                  CURRENT BUFFER OFFSET                 00650000
LASTMOVE DS    F                  SIZE OF LAST DATA MOVE                00660000
RETR15   DS    F                                                        00670000
RETR0    DS    F                                                        00680000
RETR1    DS    F                                                        00690000
RETREGS  EQU   RETR15,*-RETR15    INCLUSIVE SYMBOL                      00700000
SAVEWCC  DS    X                  3270 WCC FROM DATASTREAM              00710000
ORDTRAN  DS    X                  TRANSLATION OF 3270 ORDER             00720000
FLDATTR  DS    X                  FIELD ATTRIBUTE CONSTRUCTION          00730000
FLAGS    DS    B                  FLAGS                                 00740000
FLFLDCH  EQU   B'1'               ATTR CHANGE REQUIRES FLD VECTOR UPDT  00750000
WORKLEN  #ENDWORK                 END OF WORKAREA                       00760000
                                                                        00770000
         $MSGDFT PREFIX=ICTPID,                                        +00780000
               COMPID='LU2',                                           +00790000
               TABLE=*#MSGS,                                           +00800000
               WORKA=0,                                                +00810000
               MF=(E,WRK256),                                          +00820000
               PRINT=NOGEN                                              00830000
                                                                        00840000
ILU2APUP #ENTER BASE=R12,                                              +00850000
               PREG=(R2),          R1 --> R2                           +00860000
               AMODE=31,                                               +00870000
               RMODE=ANY                                                00880000
                                                                        00890000
*---------------------------------------------------------------------- 00900000
* INITIALIZATION                                                        00910000
*---------------------------------------------------------------------- 00920000
                                                                        00930000
         LM    R3,R5,0(R2)        PICK UP PARAMETERS                    00940000
         LR    RSESSIMG,R3        SESSIMAG  ADDRESS                     00950000
         LR    RDATA,R4           INPUT DATA ADDRESS                    00960000
         LR    RDATALEN,R5        INPUT DATA LENGTH                     00970000
         L     RIVTAM,ICTVTCVT    VTAM CVT ADDRESS                      00980000
         LTR   RDATALEN,RDATALEN  IS THERE ANY INPUT?                   00990000
         BNP   RETURN             BRANCH IF NOT                         01000000
         MVC   OFFSET,SEISCSR     INITIALIZE OFFSET                     01010000
         L     R1,SEIS1IMG        IMAGE ADDRESS                         01020000
         LA    R1,0(,R1)          ENSURE HI-BIT OFF                     01030000
         ST    R1,IMAGE@          IMAGE BUFFER ADDRESS                  01040000
                                                                        01050000
*---------------------------------------------------------------------- 01060000
* SHOW THAT THE IMAGE WAS UPDATED                                       01070000
*---------------------------------------------------------------------- 01080000
                                                                        01090000
         OI    SEIONCE,SEIO_INP   INPUT PROCESSED                       01100000
                                                                        01110000
*---------------------------------------------------------------------- 01120000
* RESET MODIFIED DATA TAGS IF REQUESTED                                 01130000
*---------------------------------------------------------------------- 01140000
                                                                        01150000
         LA    RDATA,1(,RDATA)    SKIP COMMAND BYTE                     01160000
         S     RDATALEN,=F'1'     SKIP COMMAND BYTE                     01170000
         BNP   RETURN             DONE IF NO WCC                        01180000
         MVC   SAVEWCC,0(RDATA)   SAVE THE WCC FOR LATER                01190000
         TM    0(RDATA),#3270RMD  RESET MDT ON?                         01200000
         BZ    MDTDONE            BRANCH IF NOT                         01210000
         ICM   R2,15,SEIS1FLV     FIELD VECTORS                         01220000
         BZ    MDTDONE            BRANCH IF NO FIELDS                   01230000
         LH    R3,0(,R2)          FIELD COUNT                           01240000
         LTR   R3,R3              TEST FIELD COUNT                      01250000
         BZ    MDTDONE            BRANCH IF NO FIELD ATTRIBUTES         01260000
         LA    R2,2(,R2)          FIRST FIELD OFFSET                    01270000
                                                                        01280000
MDTLOOP  DS    0H                                                       01290000
                                                                        01300000
         LH    R1,0(,R2)          LOAD FIELD OFFSET                     01310000
         A     R1,IMAGE@          FIELD ADDRESS                         01320000
         NI    0(R1),255-#3270MDT RESET MDT                             01330000
         LA    R2,2(,R2)          NEXT  FIELD OFFSET                    01340000
         BCT   R3,MDTLOOP         RESET ALL MDT'S                       01350000
                                                                        01360000
MDTDONE  DS    0H                                                       01370000
                                                                        01380000
         LA    RDATA,1(,RDATA)    SKIP WCC                              01390000
         S     RDATALEN,=F'1'     SKIP WCC                              01400000
         BNP   RETURN             DONE IF NO DATA                       01410000
                                                                        01420000
*---------------------------------------------------------------------- 01430000
* FIND AND PROCESS THE NEXT 3270 ORDER                                  01440000
*---------------------------------------------------------------------- 01450000
                                                                        01460000
NEXTORDR DS    0H                                                       01470000
                                                                        01480000
         TRTL  ARG=(RDATA),                                            +01490000
               LENGTH=(RDATALEN),                                      +01500000
               TRTABLE=*IVTXORDR  FIND ORDER OR INVALID CHARACTER       01510000
                                                                        01520000
         STC   R15,ORDTRAN        SAVE THE TRANSLATION                  01530000
         ST    R0,LASTMOVE        SIZE OF LAST INPUT COPY               01540000
         AR    RDATA,R0           ADDRESS OF ORDER                      01550000
         LA    RDATA,1(,RDATA)    SKIP ORDER                            01560000
         SR    RDATALEN,R0        UPDATE LENGTH                         01570000
         S     RDATALEN,=F'1'     SKIP ORDER                            01580000
                                                                        01590000
*                                                                       01600000
* COPY INPUT DATA INTO THE IMAGE BUFFER                                 01610000
*---------------------------------------------------------------------- 01620000
                                                                        01630000
         LTR   R3,R0              COUNT OF DATA                         01640000
         BZ    DATADONE           BRANCH IF NO DATA                     01650000
         LH    R0,OFFSET          CURRENT OFFSET                        01660000
                                                                        01670000
DATACOPY DS    0H                                                       01680000
                                                                        01690000
         L     R1,SEIS1SIZ        IMAGE SIZE                            01700000
         SR    R1,R0              LENGTH TO END-OF-BUFFER               01710000
         BNP   DATADONE           BRANCH IF LENGTH INVALID (SNO)        01720000
         CR    R1,R3              DATA GT LENGTH-TO-END-OF-BUFFER?      01730000
         BNH   DATALONG           BRANCH IF YES                         01740000
         LR    R1,R3              SET COPY-TO LENGTH                    01750000
                                                                        01760000
DATALONG DS    0H                                                       01770000
                                                                        01780000
         BAS   R14,WRITECHK       CHECK IF ATTRIBUTES WILL BE OVERLAID  01790000
         LR    R4,R1              SAVE LENGTH                           01800000
         A     R0,IMAGE@          SET COPY-TO ADDRESS                   01810000
         MVCL  R0,R2              COPY DATA TO IMAGE                    01820000
                                                                        01830000
         LR    R0,R4              AMOUNT MOVED                          01840000
         BAS   R14,UPOFFSET       UPDATE OFFSET VALUE                   01850000
         LTR   R3,R3              MORE DATA?                            01860000
         BNZ   DATACOPY           BRANCH IF YES                         01870000
                                                                        01880000
DATADONE DS    0H                                                       01890000
                                                                        01900000
*                                                                       01910000
* JUMP TO THE ROUTINE TO PROCESS THE 3270 ORDER THAT WAS FOUND          01920000
*---------------------------------------------------------------------- 01930000
                                                                        01940000
         SR    R1,R1              CLEAR FOR INSERT                      01950000
         IC    R1,ORDTRAN         PICK UP SAVED TRANSLATION OF ORDER    01960000
         SLL   R1,2               VALUE X 4                             01970000
         B     ORDJUMP(R1)        PROCESS RESULT OF SCAN                01980000
                                                                        01990000
ORDJUMP  B     RETURN             00 = NO MORE ORDERS (END OF DATA)     02000000
         B     ORDPT              01 = X'05' PROGRAM TAB                02010000
         B     ORDGE              02 = X'08' GRAPHIC ESCAPE             02020000
         B     ORDSBA             03 = X'11' SET BUFFER ADDRESS         02030000
         B     ORDEUA             04 = X'12' ERASE UNPROT. TO ADDRESS   02040000
         B     ORDIC              05 = X'13' INSERT CURSOR              02050000
         B     ORDSF              06 = X'1D' START FIELD                02060000
         B     ORDSA              07 = X'28' SET ATTRIBUTE              02070000
         B     ORDSFE             08 = X'29' START FIELD EXTENDED       02080000
         B     ORDMF              09 = X'2C' MODIFY FIELD               02090000
         B     ORDRA              0A = X'3C' REPEAT TO ADDRESS          02100000
         B     ORDERROR           0B = INVALID CHARACTER                02110000
                                                                        02120000
*                                                                       02130000
* 01 = X'05' PROGRAM TAB                                                02140000
*---------------------------------------------------------------------- 02150000
                                                                        02160000
ORDPT    DS    0H                                                       02170000
                                                                        02180000
         BAS   R14,BLDFLVEC       REBUILD FIELD VECTORS                 02190000
         LH    R4,OFFSET          CURRENT BUFFER ADDRESS                02200000
         ICM   R15,15,SEIS1FLV    FIELD VECTORS                         02210000
         BZ    OPTBUNFM           BRANCH IF NO FIELDS                   02220000
         LH    R14,0(,R15)        FIELD COUNT                           02230000
         LTR   R14,R14            TEST FIELD COUNT                      02240000
         BZ    OPTBUNFM           BRANCH IF NO FIELDS                   02250000
         LA    R15,2(,R15)        ADDRESS OF 1ST FIELD OFFSET           02260000
                                                                        02270000
OPTBFOFF DS    0H                                                       02280000
                                                                        02290000
         LH    R5,0(,R15)         POSSIBLE TRAILING FIELD OFFSET        02300000
         CR    R4,R5              IS THIS THE TRAILING FIELD OFFSET?    02310000
         BNH   OPTBGOFF           BRANCH IF YES                         02320000
         LA    R15,2(,R15)        NEXT FIELD VECTOR ADDRESS             02330000
         BCT   R14,OPTBFOFF       FIND THE TRAILING FIELD OFFSET        02340000
         L     R5,SEIS1SIZ        TRAILING OFFSET IS END OF IMAGE       02350000
         SR    R2,R2              NEW CURRENT OFFSET IS 0               02360000
         B     OPTBDONE           COMPLETE THE OPERATION                02370000
                                                                        02380000
OPTBGOFF DS    0H                                                       02390000
                                                                        02400000
         LH    R1,0(,R15)         OFFSET OF A SUBSEQUENT FIELD          02410000
         A     R1,IMAGE@          ADDRESS OF A SUBSEQUENT ATTRIBUTE     02420000
         TM    0(R1),#3270PRO     IS IT A PROTECTED FIELD?              02430000
         BZ    OPTBGUNP           BRANCH IF IT IS UNPROTECTED           02440000
         LA    R15,2(,R15)        NEXT FIELD VECTOR ADDRESS             02450000
         BCT   R14,OPTBGOFF       FIND THE SUBSEQUENT UNPROT. FIELD     02460000
         SR    R2,R2              NEW CURSOR OFFSET IS 0 IF NOT FOUND   02470000
         B     OPTBDONE           COMPLETE THE OPERATION                02480000
                                                                        02490000
OPTBGUNP DS    0H                                                       02500000
                                                                        02510000
         LH    R2,0(,R15)         OFFSET OF 1ST SUBSEQUENT UNPROT. FLD  02520000
         LA    R2,1(,R2)          OFFSET OF THE FIELD DATA              02530000
         B     OPTBDONE           COMPLETE THE OPERATION                02540000
                                                                        02550000
OPTBDONE DS    0H                                                       02560000
                                                                        02570000
         SR    R15,R15            MVCL 0 PAD AND 0 LENGTH               02580000
         STH   R2,OFFSET          SET CURRENT OFFSET                    02590000
         C     R2,SEIS1SIZ        WAS A TRAILING UNPROT FIELD FOUND?    02600000
         BL    OPTBCLR            BRANCH IF YES                         02610000
         STH   R15,OFFSET         CURRENT OFFSET = 0                    02620000
         B     OPTBCLR            GO CLEAR THE IMAGE                    02630000
                                                                        02640000
OPTBUNFM DS    0H                                                       02650000
                                                                        02660000
         SR    R15,R15            MVCL 0 PAD AND 0 LENGTH               02670000
         STH   R15,OFFSET         CURRENT OFFSET = 0                    02680000
         L     R5,SEIS1SIZ        TRAILING OFFSET                       02690000
                                                                        02700000
OPTBCLR  DS    0H                                                       02710000
                                                                        02720000
         OC    LASTMOVE,LASTMOVE  WAS THERE DATA BEFORE THE ORDER?      02730000
         BZ    NEXTORDR           BRANCH IF NOT, PT ALL DONE            02740000
         SR    R5,R4              LENGTH TO CLEAR                       02750000
         BNP   NEXTORDR           BRANCH IF ALL DONE                    02760000
         A     R4,IMAGE@          STARTING ADDRESS                      02770000
         MVCL  R4,R14             CLEAR IMAGE                           02780000
         B     NEXTORDR           GO FIND THE NEXT ORDER                02790000
                                                                        02800000
*                                                                       02810000
* 02 = X'08XX' GRAPHIC ESCAPE                                           02820000
*---------------------------------------------------------------------- 02830000
                                                                        02840000
ORDGE    DS    0H                                                       02850000
                                                                        02860000
         S     RDATALEN,=F'1'     PREMATURE END?                        02870000
         BM    ERR1005            BRANCH IF YES                         02880000
         LH    R0,OFFSET          DATA OFFSET                           02890000
         LA    R1,1               DATA LENGTH                           02900000
         BAS   R14,WRITECHK       CHECK IF ATTRIBUTES WILL BE OVERLAID  02910000
         LH    R1,OFFSET          DATA OFFSET                           02920000
         AL    R1,IMAGE@          DATA ADDRESS                          02930000
         MVI   0(R1),C'-'         SUBSTITUTE C'-'                       02940000
         LA    RDATA,1(,RDATA)    SKIP DATA BYTE                        02950000
         LA    R0,1               1 BYTE OF DATA                        02960000
         BAS   R14,UPOFFSET       UPDATE OFFSET                         02970000
         B     NEXTORDR           GET THE NEXT ORDER                    02980000
                                                                        02990000
*                                                                       03000000
* 03 = X'11XXXX' SET BUFFER ADDRESS                                     03010000
*---------------------------------------------------------------------- 03020000
                                                                        03030000
ORDSBA   DS    0H                                                       03040000
                                                                        03050000
         S     RDATALEN,=F'2'     ADDRESS BYTES PRESENT?                03060000
         BM    ERR1005            BRANCH IF NOT                         03070000
         BAS   R14,CONVADDR       CONVERT ADDRESS TO OFFSET             03080000
         LA    RDATA,2(,RDATA)    SKIP ADDRESS BYTES                    03090000
         C     R1,SEIS1SIZ        VALID OFFSET?                         03100000
         BNL   ERR1005            BRANCH IF NOT                         03110000
         STH   R1,OFFSET          SET CURRENT OFFSET                    03120000
         B     NEXTORDR           GO GET THE NEXT ORDER                 03130000
                                                                        03140000
*                                                                       03150000
* 04 = X'12XXXX' ERASE UNPROTECTED TO ADDRESS                           03160000
*---------------------------------------------------------------------- 03170000
                                                                        03180000
ORDEUA   DS    0H                                                       03190000
                                                                        03200000
         BAS   R14,BLDFLVEC       REBUILD FIELD VECTORS                 03210000
         LH    R2,OFFSET          CURRENT OFFSET                        03220000
         S     RDATALEN,=F'2'     SKIP ADDRESS BYTES                    03230000
         BM    ERR1005            BRANCH IF ERROR                       03240000
         BAS   R14,CONVADDR       CONVERT TO OFFSET                     03250000
         LA    RDATA,2(,RDATA)    SKIP ADDRESS BYTES                    03260000
         C     R1,SEIS1SIZ        VALID OFFSET?                         03270000
         BNL   ERR1005            BRANCH IF NOT                         03280000
         STH   R1,OFFSET          SET ENDING OFFSET                     03290000
         SR    R5,R5              MVCL 0 PAD AND 0 FROM-LENGTH          03300000
         L     R3,SEIS1SIZ        IMAGE SIZE                            03310000
         CR    R2,R1              DOES THIS EUA WRAP TO TOP?            03320000
         BNL   OEUASTRT           BRANCH IF YES                         03330000
         LR    R3,R1              USE ORDER SPECIFIED ADDR AS END       03340000
                                                                        03350000
OEUASTRT DS    0H                                                       03360000
                                                                        03370000
         ICM   R15,15,SEIS1FLV    FIELD VECTORS                         03380000
         BZ    OEUAUNFM           BRANCH IF NO FIELDS                   03390000
         LH    R14,0(,R15)        FIELD COUNT                           03400000
         LTR   R14,R14            TEST FIELD COUNT                      03410000
         BZ    OEUAUNFM           BRANCH IF NO FIELDS                   03420000
         LR    R1,R14             COPY COUNT                            03430000
         SLL   R1,1               OFFSET OF LAST FIELD ENTRY            03440000
         AR    R1,R15             ADDRESS OF LAST FIELD ENTRY           03450000
         LH    R1,0(,R1)          OFFSET OF PRECEDING FIELD ATTR        03460000
         SR    R0,R0              OFFSET OF PRECEDING FIELD DATA        03470000
         LA    R15,2(,R15)        ADDRESS OF FIRST FIELD ENTRY          03480000
                                                                        03490000
OEUACKCL DS    0H                                                       03500000
                                                                        03510000
         CR    R3,R0              IS ENDING OFFSET PAST DATA START?     03520000
         BNH   OEUASEND           BRANCH IF NOT                         03530000
         CH    R2,0(,R15)         IS BEGINNING OFFSET IN THIS FIELD?    03540000
         BNL   OEUANEXT           BRANCH IF NOT                         03550000
         A     R1,IMAGE@          ADDRESS OF PRECEDING FIELD ATTR       03560000
         TM    0(R1),#3270PRO     IS THIS FIELD PROTECTED?              03570000
         BO    OEUANEXT           BRANCH IF YES                         03580000
         CR    R2,R0              BEGINNING OFFSET PRECEDE FIELD DATA?  03590000
         BL    OEUAGOTB           BRANCH IF YES                         03600000
         LR    R0,R2              SET TO CLEAR FROM BEGINNING OFFSET    03610000
                                                                        03620000
OEUAGOTB DS    0H                                                       03630000
                                                                        03640000
         LH    R1,0(,R15)         END OF FIELD OFFSET                   03650000
         CR    R3,R1              ENDING OFFSET PRECEDE END OF FIELD?   03660000
         BH    OEUAGOTT           BRANCH IF NOT                         03670000
         LR    R1,R3              SET TO CLEAR TO END OF FIELD OFFSET   03680000
                                                                        03690000
OEUAGOTT DS    0H                                                       03700000
                                                                        03710000
         SR    R1,R0              MVCL COPY-TO LENGTH                   03720000
         A     R0,IMAGE@          MVCL COPY-TO ADDRESS                  03730000
         MVCL  R0,R4              CLEAR THE FIELD                       03740000
                                                                        03750000
OEUANEXT DS    0H                                                       03760000
                                                                        03770000
         LH    R1,0(,R15)         OFFSET OF PRECEDING FIELD ATTR        03780000
         LA    R0,1(,R1)          OFFSET OF PRECEDING FIELD DATA        03790000
         LA    R15,2(,R15)        ADDRESS NEXT FIELD VECTOR             03800000
         BCT   R14,OEUACKCL       GO CHECK IF FIELD NEEDS CLEARING      03810000
                                                                        03820000
OEUASEND DS    0H                                                       03830000
                                                                        03840000
         CH    R3,OFFSET          "REAL" END OF OPERATION?              03850000
         BE    NEXTORDR           BRANCH IF YES                         03860000
         LH    R3,OFFSET          ENDING OFFSET                         03870000
         SR    R2,R2              BEGINNING OFFSET                      03880000
         B     OEUASTRT           CLEAR IN THE WRAPPED SEGMENT          03890000
                                                                        03900000
OEUAUNFM DS    0H                                                       03910000
                                                                        03920000
         LR    R1,R3              ENDING OFFSET                         03930000
         SR    R1,R2              MVCL COPY-TO LENGTH                   03940000
         LR    R0,R2              BEGINNING OFFSET                      03950000
         A     R0,IMAGE@          MVCL COPY-TO ADDRESS                  03960000
         MVCL  R0,R4              CLEAR THE FIELD                       03970000
         CH    R3,OFFSET          "REAL" END OF OPERATION?              03980000
         BE    NEXTORDR           BRANCH IF YES                         03990000
         LH    R3,OFFSET          ENDING OFFSET                         04000000
         SR    R2,R2              BEGINNING OFFSET                      04010000
         B     OEUAUNFM           CLEAR IN THE WRAPPED SEGMENT          04020000
                                                                        04030000
*                                                                       04040000
* 05 = X'13' INSERT CURSOR                                              04050000
*---------------------------------------------------------------------- 04060000
                                                                        04070000
ORDIC    DS    0H                                                       04080000
                                                                        04090000
         LH    R1,OFFSET          CURRENT OFFSET                        04100000
         ST    R1,SEISCSR         SET CURSOR                            04110000
         B     NEXTORDR           GET THE NEXT ORDER                    04120000
                                                                        04130000
*                                                                       04140000
* 06 = X'1DXX' START FIELD                                              04150000
*---------------------------------------------------------------------- 04160000
                                                                        04170000
ORDSF    DS    0H                                                       04180000
                                                                        04190000
         S     RDATALEN,=F'1'     ATTRIBUTE PRESENT?                    04200000
         BM    ERR1005            BRANCH IF NOT, ERROR                  04210000
         LH    R3,OFFSET          OFFSET OF ATTRIBUTE                   04220000
         A     R3,IMAGE@          ADDRESS OF ATTRIBUTE                  04230000
         L     R15,IVTXATTO       XLATE ATTRIBUTES OUTBOUND             04240000
         TRT   0(1,R3),0(R15)     IS POSITION CURRENTLY AN ATTRIBUTE?   04250000
         BNZ   OSFSTORE           BRANCH IF YES                         04260000
         OI    FLAGS,FLFLDCH      FIELD VECTOR HAS CHANGED              04270000
                                                                        04280000
OSFSTORE DS    0H                                                       04290000
                                                                        04300000
         MVC   0(1,R3),0(RDATA)   COPY ATTR BYTE                        04310000
         L     R15,IVTXATTI       XLATE ATTRIBUTES INBOUND              04320000
         TR    0(1,R3),0(R15)     CHANGE TO INTEGRATOR ATTR CODE        04330000
         LA    RDATA,1(,RDATA)    POINT PAST ATTRIBUTE                  04340000
         LA    R0,1               1 BYTE LENGTH                         04350000
         BAS   R14,UPOFFSET       UPDATE OFFSET                         04360000
         B     NEXTORDR           GO GET NEXT ORDER                     04370000
                                                                        04380000
*                                                                       04390000
* 07 = X'28TTVV' SET ATTRIBUTE                                          04400000
*---------------------------------------------------------------------- 04410000
                                                                        04420000
ORDSA    DS    0H                                                       04430000
                                                                        04440000
         S     RDATALEN,=F'2'     SKIP TTVV BYTES                       04450000
         BM    ERR1005            ERROR IF TYPE/VALUE MISSING           04460000
         LA    RDATA,2(,RDATA)    SKIP TTVV BYTES                       04470000
         B     NEXTORDR           GO SCAN FOR NEXT ORDER                04480000
                                                                        04490000
*                                                                       04500000
* 08 = X'29##TTVV...' START FIELD EXTENDED                              04510000
*---------------------------------------------------------------------- 04520000
                                                                        04530000
ORDSFE   DS    0H                                                       04540000
                                                                        04550000
         LA    R3,1(,RDATA)       ADDRESS OF TV PAIRS                   04560000
         S     RDATALEN,=F'1'     ENOUGH FOR ## COUNT FIELD?            04570000
         BM    ERR1005            BRANCH IF LENGTH ERROR                04580000
         SR    R4,R4              CLEAR FOR ICM                         04590000
         ICM   R4,1,0(RDATA)      COUNT OF TV PAIRS                     04600000
         SLL   R4,1               LENGTH OF TV PAIRS                    04610000
         SR    RDATALEN,R4        LENGTH REMAINING                      04620000
         BM    ERR1005            BRANCH IF LENGTH ERROR                04630000
         LA    RDATA,1(R4,RDATA)  SKIP ENTIRE ORDER                     04640000
         SRL   R4,1               COUNT OF TV PAIRS                     04650000
         LH    R5,OFFSET          CURRENT OFFSET                        04660000
         A     R5,IMAGE@          ADDRESS OF ATTRIBUTE                  04670000
         LA    R0,1               ONE BYTE FOR FIELD ATRRIBUTE          04680000
         BAS   R14,UPOFFSET       UPDATE OFFSET                         04690000
         L     R15,IVTXATTO       XLATE ATTRIBUTES OUTBOUND             04700000
         TRT   0(1,R5),0(R15)     IS POSITION CURRENTLY AN ATTRIBUTE?   04710000
         BNZ   OSFESTOR           BRANCH IF YES                         04720000
         CLI   ORDTRAN,X'09'      IS THIS A MODIFY FIELD?               04730000
         BE    ERR1005            BRANCH IF SO, THIS IS AN ERROR        04740000
         OI    FLAGS,FLFLDCH      FIELD VECTOR HAS CHANGED              04750000
                                                                        04760000
OSFESTOR DS    0H                                                       04770000
                                                                        04780000
         MVC   FLDATTR(1),0(R5)   SAVE EXISTING ATTRIBUTE               04790000
         L     R15,IVTXATTO       XLATE ATTRIBUTES OUTBOUND             04800000
         TR    FLDATTR(1),0(R15)  XLATE TO 3270 GRAPHICS                04810000
         CLI   ORDTRAN,X'09'      IS THIS A MODIFY FIELD?               04820000
         BE    OSFEOK             BRANCH IF YES                         04830000
         MVI   FLDATTR,X'40'      SET DEFAULT ATTRIBUTE FOR SFE         04840000
                                                                        04850000
OSFEOK   DS    0H                                                       04860000
                                                                        04870000
         LTR   R4,R4              ANY PAIRS LEFT?                       04880000
         BZ    OSFEXLAT           BRANCH IF NOT                         04890000
         CLI   0(R3),#3270TFA     FIELD ATTRIBUTE TYPE?                 04900000
         BNE   OSFENXTP           BRANCH IF NOT TO GET NEXT PAIR        04910000
         MVC   FLDATTR(1),1(R3)   SAVE FIELD ATTRIBUTE                  04920000
                                                                        04930000
OSFENXTP DS    0H                                                       04940000
                                                                        04950000
         LA    R3,2(,R3)          ADDRESS OF NEXT PAIR                  04960000
         BCT   R4,OSFEOK          GO CHECK NEXT PAIR                    04970000
                                                                        04980000
OSFEXLAT DS    0H                                                       04990000
                                                                        05000000
         L     R15,IVTXATTI       XLATE ATTRIBUTES INBOUND              05010000
         TR    FLDATTR(1),0(R15)  XLATE TO INTERNAL FORMAT              05020000
         MVC   0(1,R5),FLDATTR    SET ATTRIBUTE                         05030000
         B     NEXTORDR           GO GET NEXT ORDER                     05040000
                                                                        05050000
*                                                                       05060000
* 09 = X'2C##TTVV...' MODIFY FIELD                                      05070000
*---------------------------------------------------------------------- 05080000
                                                                        05090000
ORDMF    DS    0H                                                       05100000
                                                                        05110000
         B     ORDSFE             ALMOST THE SAME AS SFE PROCESSING     05120000
                                                                        05130000
*                                                                       05140000
* 0A = X'3CXXXXYY' OR X'3CXXXX08YY' REPEAT TO ADDRESS                   05150000
*---------------------------------------------------------------------- 05160000
                                                                        05170000
ORDRA    DS    0H                                                       05180000
                                                                        05190000
         BAS   R14,CONVADDR       GET ENDING OFFSET                     05200000
         S     RDATALEN,=F'2'     SKIP ADDRESS BYTES                    05210000
         BM    ERR1005            BRANCH IF NO ADDRESS BYTES            05220000
         LA    RDATA,2(,RDATA)    SKIP ADDRESS BYTES                    05230000
         C     R1,SEIS1SIZ        VALID OFFSET?                         05240000
         BNL   ERR1005            BRANCH IF NOT                         05250000
         LR    R2,R1              SAVE ENDING OFFSET                    05260000
         S     RDATALEN,=F'1'     SKIP DATA/GE BYTE                     05270000
         BM    ERR1005            BRANCH IF NO DATA BYTE                05280000
         SR    R5,R5              CLEAR                                 05290000
         CLI   0(RDATA),#3270GE   GRAPHIC ESCAPE?                       05300000
         BNE   ORANORM            BRANCH IF NOT A 2-BYTER               05310000
         S     RDATALEN,=F'1'     SKIP DATA BYTE                        05320000
         BM    ERR1005            BRANCH IF NO DATA BYTE                05330000
         LA    RDATA,1(,RDATA)    SKIP GE BYTE                          05340000
         ICM   R5,B'1000',=C'-'   SUBSTITUTE C'-'                       05350000
         B     ORASETUP           PERFORM THE REPEAT                    05360000
                                                                        05370000
ORANORM  DS    0H                                                       05380000
                                                                        05390000
         ICM   R5,8,0(RDATA)      GET DATA BYTE                         05400000
         CLI   0(RDATA),X'20'     CONFLICT WITH INTERNAL ATTR?          05410000
         BL    ORASETUP           BRANCH IF NOT                         05420000
         CLI   0(RDATA),X'3F'     CONFLICT WITH INTERNAL ATTR?          05430000
         BH    ORASETUP           BRANCH IF NOT                         05440000
         ICM   R5,8,=C'-'         SUBSTITUTE C'-' FOR ATTR CONFLICT     05450000
                                                                        05460000
ORASETUP DS    0H                                                       05470000
                                                                        05480000
         LA    RDATA,1(,RDATA)    SKIP DATA BYTE                        05490000
         LH    R0,OFFSET          CURRENT OFFSET                        05500000
         STH   R2,OFFSET          SET ENDING OFFSET AS CURRENT          05510000
         SR    R2,R0              LENGTH OF REPEAT                      05520000
         LR    R1,R2              LENGTH OF REPEAT                      05530000
         BP    ORARPEAT           BRANCH IF NO WRAP TO TOP              05540000
         LH    R2,OFFSET          LENGTH OF REPEAT AT TOP               05550000
         L     R1,SEIS1SIZ        IMAGE SIZE                            05560000
         SR    R1,R0              LENGTH OF REPEAT AT BOTTOM            05570000
         AR    R2,R1              LENGTH OF REPEAT                      05580000
                                                                        05590000
ORARPEAT DS    0H                                                       05600000
                                                                        05610000
         SR    R2,R1              LENGTH OF REPEAT AT TOP               05620000
         BAS   R14,WRITECHK       CHECK IF ATTRIBUTES WILL BE OVERLAID  05630000
         A     R0,IMAGE@          STARTING ADDRESS OF REPEAT            05640000
         MVCL  R0,R4              REPEAT THE DATA BYTE                  05650000
         SLR   R0,R0              RESET OFFSET TO BEGINNING             05660000
         LTR   R1,R2              IS THERE SOME REPEAT AT THE TOP?      05670000
         BNZ   ORARPEAT           BRANCH IF YES                         05680000
         B     NEXTORDR           GO GET THE NEXT ORDER                 05690000
                                                                        05700000
*                                                                       05710000
* 0B = 01,02,03,04,06,07,09,0A,0B,0E,0F,10,14,16,17,18,1A,1B,1E,1F      05720000
*      20,21,22,23,24,25,26,27,2A,2B,2D,2E,2F,30,31,32,33,34,35,36,37   05730000
*      38,39,3A,3B,3D,3E,3F = INVALID ORDER                             05740000
*---------------------------------------------------------------------- 05750000
                                                                        05760000
ORDERROR DS    0H                                                       05770000
                                                                        05780000
         LH    R0,OFFSET          CURRENT OFFSET                        05790000
         LA    R1,1               1 BYTE OF DATA                        05800000
         BAS   R14,WRITECHK       CHECK IF ATTRIBUTES WILL BE OVERLAID  05810000
         LH    R1,OFFSET          CURRENT OFFSET                        05820000
         A     R1,IMAGE@          ADDRESS IN IMAGE                      05830000
         MVI   0(R1),C'-'         USE C'-' IN IMAGE                     05840000
         LA    R0,1               INCREMENT BY ONE                      05850000
         BAS   R14,UPOFFSET       UPDATE OFFSET                         05860000
         B     NEXTORDR           GO GET THE NEXT ORDER                 05870000
                                                                        05880000
*---------------------------------------------------------------------- 05890000
* EXCEPTION ROUTINES                                                    05900000
*---------------------------------------------------------------------- 05910000
                                                                        05920000
ERR1003  DS  0H                                                         05930000
                                                                        05940000
         MVC   RETR0,=X'10030000'                                       05950000
         B     ERREXIT                                                  05960000
                                                                        05970000
ERR1005  DS    0H                                                       05980000
                                                                        05990000
         MVC   RETR0,=X'10050000'                                       06000000
         B     ERREXIT                                                  06010000
                                                                        06020000
ERREXIT DS     0H                                                       06030000
                                                                        06040000
         MVC   RETR15,=F'4'       ISSUE NEGATIVE RESPONSE               06050000
         B     RETURN                                                   06060000
                                                                        06070000
*---------------------------------------------------------------------- 06080000
* RETURN TO CALLER                                                      06090000
*---------------------------------------------------------------------- 06100000
                                                                        06110000
RETURN   DS    0H                                                       06120000
                                                                        06130000
         BAS   R14,BLDFLVEC       REBUILD FIELD VECTORS                 06140000
                                                                        06150000
         OC    RETR15,RETR15      SUCCESSFUL PROCESSING?                06160000
         BNZ   RETNOKBR           BRANCH IF NOT                         06170000
                                                                        06180000
         TM    SAVEWCC,#3270KBR   KEYBOARD RESTORE REQUESTED?           06190000
         BZ    RETNOKBR           BRANCH IF NOT                         06200000
         OI    SEIFSNA,SEIF_KBR   KEYBOARD IS RESTORED                  06210000
         MVI   SEIAID,#3270NUL    NO-AID PRESENT                        06220000
                                                                        06230000
RETNOKBR DS    0H                                                       06240000
                                                                        06250000
         TM    SAVEWCC,#3270SAA   AUDIBLE ALARM REQUESTED?              06260000
         BZ    RETNOBEL           BRANCH IF NOT                         06270000
         OI    SEIONCE,SEIO_BEL   ALARM WAS SOUNDED                     06280000
         MVI   SEIAID,#3270NUL    NO-AID PRESENT                        06290000
                                                                        06300000
RETNOBEL DS    0H                                                       06310000
                                                                        06320000
         LM    R15,R1,RETREGS     LOAD RETURN VALUES                    06330000
                                                                        06340000
         #EXIT R1=YES             RETURN W/R15,R0,R1                    06350000
                                                                        06360000
*---------------------------------------------------------------------- 06370000
* SUBROUTINE UPOFFSET: UPDATE BUFFER OFFSET                             06380000
*                                                                       06390000
* ENTRY:  R0  = NUMBER OF CHARACTERS TO INCREMENT THE OFFSET            06400000
*         R14 = RETURN ADDRESS                                          06410000
*                                                                       06420000
* RETURN: R0  = CURRENT OFFSET                                          06430000
*---------------------------------------------------------------------- 06440000
                                                                        06450000
UPOFFSET DS    0H                                                       06460000
                                                                        06470000
         AH    R0,OFFSET          ADD CURRENT OFFSET TO THE INCREMENT   06480000
         STH   R0,OFFSET          SET NEW OFFSET VALUE                  06490000
         C     R0,SEIS1SIZ        IS OFFSET PAST THE END OF BUFFER?     06500000
         BLR   R14                BRANCH IF NOT                         06510000
         SR    R0,R0              ZERO OFFSET                           06520000
         STH   R0,OFFSET          SET NEW OFFSET VALUE                  06530000
         BR    R14                RETURN                                06540000
                                                                        06550000
*---------------------------------------------------------------------- 06560000
* SUBROUTINE CONVADDR: CONVERT BUFFER ADDRESS TO ZERO-BASED OFFSET      06570000
*                                                                       06580000
* ENTRY:  RDATA = ADDRESS OF A TWO-BYTE 3270 BUFFER ADDRESS             06590000
*                                                                       06600000
* RETURN: R1    = ZERO-BASED OFFSET                                     06610000
*---------------------------------------------------------------------- 06620000
                                                                        06630000
CONVADDR DS    0H                                                       06640000
                                                                        06650000
         SR    R1,R1              CLEAR                                 06660000
         ICM   R1,B'11',0(RDATA)  LOAD 3270 ADDRESS BYTES               06670000
         TM    0(RDATA),X'C0'     14-BIT ADDRESS?                       06680000
         BZR   R14                BRANCH IF YES                         06690000
         SLL   R1,26              XXXXXX00 00000000 00000000 00000000   06700000
         SRL   R1,24              00000000 00000000 00000000 XXXXXX00   06710000
         ICM   R1,2,0(RDATA)      00000000 00000000 YYYYYYYY XXXXXX00   06720000
         SRL   R1,2               00000000 00000000 00YYYYYY YYXXXXXX   06730000
         N     R1,=X'00000FFF'    00000000 00000000 0000YYYY YYXXXXXX   06740000
         BR    R14                RETURN                                06750000
                                                                        06760000
*---------------------------------------------------------------------- 06770000
* SUBROUTINE WRITECHK: CHECK IF WRITE DATA OVERLAYS AN ATTRIBUTE        06780000
*                                                                       06790000
* ENTRY:  R0 = WRITE START OFFSET                                       06800000
*         R1 = LENGTH OF WRITE                                          06810000
*                                                                       06820000
* RETURN: ALL REGISTERS ARE RESTORED.                                   06830000
*---------------------------------------------------------------------- 06840000
                                                                        06850000
WRITECHK DS    0H                                                       06860000
                                                                        06870000
         STM   R14,R4,SUB0SAVE    SAVE REGISTERS                        06880000
         L     R3,IMAGE@          IMAGE ADDRESS                         06890000
         AR    R3,R0              WRITE ADDRESS                         06900000
         LR    R4,R1              WRITE LENGTH                          06910000
                                                                        06920000
         TRTL  ARG=(R3),                                               +06930000
               LENGTH=(R4),                                            +06940000
               TRTABLE=*IVTXATTO  CHECK FOR ATTR IN WRITE RANGE         06950000
                                                                        06960000
         BZ    WCHKDONE           BRANCH IF NOT                         06970000
         OI    FLAGS,FLFLDCH      FLV IS NOT VALID                      06980000
                                                                        06990000
WCHKDONE DS    0H                                                       07000000
                                                                        07010000
         LM    R14,R4,SUB0SAVE    RELOAD REGISTER                       07020000
         BR    R14                RETURN                                07030000
                                                                        07040000
*---------------------------------------------------------------------- 07050000
* SUBROUTINE BLDFLVEC: REBUILD FIELD VECTOR IF NECESSARY                07060000
*                                                                       07070000
* ENTRY:  SESSIMAG BLOCK                                                07080000
*                                                                       07090000
* RETURN: ALL REGISTERS ARE RESTORED.                                   07100000
*---------------------------------------------------------------------- 07110000
                                                                        07120000
BLDFLVEC DS    0H                                                       07130000
                                                                        07140000
         TM    FLAGS,FLFLDCH      HAS THERE BEEN A FIELD CHANGE?        07150000
         BZR   R14                BRANCH IF NOT                         07160000
         STM   R14,R7,SUB0SAVE    SAVE REGISTERS                        07170000
         NI    FLAGS,255-FLFLDCH  CLEAR THE FLAG                        07180000
         L     R6,SEIS1FLM        MAXIMUM FIELDS THAT WILL FIT          07190000
         SR    R5,R5              FIELD COUNT                           07200000
         L     R4,SEIS1FLV        FIELD VECTORS                         07210000
         LA    R4,2(,R4)          ADDRESS OF FIRST VECTOR               07220000
         L     R3,IMAGE@          IMAGE ADDRESS                         07230000
         L     R7,SEIS1SIZ        IMAGE SIZE                            07240000
                                                                        07250000
BLDFLOOP DS    0H                                                       07260000
                                                                        07270000
         TRTL  ARG=(R3),                                               +07280000
               LENGTH=(R7),                                            +07290000
               TRTABLE=*IVTXATTO  LOCATE NEXT FIELD ATTRIBUTE           07300000
                                                                        07310000
         BZ    BLDFDONE           BRANCH IF DONE                        07320000
         S     R1,IMAGE@          ATTRIBUTE OFFSET                      07330000
         LA    R5,1(,R5)          NUMBER OF FIELDS                      07340000
         CR    R5,R6              WILL THIS ONE FIT?                    07350000
         BNH   BLDFSTOR           BRANCH IF YES                         07360000
         BAS   R14,BUMPFLV        GO DOUBLE THE SIZE                    07370000
         L     R6,SEIS1FLM        REFRESH MAXIMUM FIELD COUNT           07380000
         LR    R4,R5              # OF CURRENT FIELD ATTRIBUTE          07390000
         SLL   R4,1               OFFSET OF FIELD ENTRY IN FLV          07400000
         A     R4,SEIS1FLV        REFRESH FLV ENTRY ADDRESS             07410000
                                                                        07420000
BLDFSTOR DS    0H                                                       07430000
                                                                        07440000
         STH   R1,0(,R4)          SET THE FIELD ATTRIBUTE OFFSET        07450000
         LA    R4,2(,R4)          NEXT FLV ENTRY                        07460000
         A     R0,=F'1'           SKIP FIELD ATTRIBUTE                  07470000
         AR    R3,R0              RESUME ADDRESS                        07480000
         SR    R7,R0              REMAINING LENGTH                      07490000
         B     BLDFLOOP           GO FIND NEW FIELD ATTRIBUTE           07500000
                                                                        07510000
BLDFDONE DS    0H                                                       07520000
                                                                        07530000
         ICM   R1,15,SEIS1FLV     FIELD VECTORS                         07540000
         BZ    BLDFEXIT           BRANCH IF NO FIELDS                   07550000
         STH   R5,0(,R1)          SET NEW FIELD COUNT                   07560000
         L     R1,SEIS1SIZ        IMAGE SIZE                            07570000
         STH   R1,0(,R4)          TERMINATE FIELD VECTORS               07580000
                                                                        07590000
BLDFEXIT DS    0H                                                       07600000
                                                                        07610000
         LM    R14,R7,SUB0SAVE    RESTORE REGISTERS                     07620000
         BR    R14                RETURN TO CALLER                      07630000
                                                                        07640000
*---------------------------------------------------------------------- 07650000
* SUBROUTINE BUMPFLV: INCREASE THE SIZE OF THE FIELD VECTOR TABLE       07660000
*                                                                       07670000
* ENTRY:  SESSIMAG BLOCK                                                07680000
*                                                                       07690000
* RETURN: ALL REGISTERS ARE RESTORED.                                   07700000
*---------------------------------------------------------------------- 07710000
                                                                        07720000
BUMPFLV  DS    0H                                                       07730000
                                                                        07740000
         STM   R14,R7,SUB1SAVE    SAVE REGISTERS                        07750000
         L     R3,SEIS1FLM        CURRENT MAX FIELD COUNT               07760000
         LR    R7,R3              SAVE COUNT                            07770000
         L     R6,SEIS1FLV        CURRENT FIELD VECTOR ADDRESS          07780000
         SLL   R3,1               DOUBLE IT                             07790000
         LTR   R3,R3              IS THIS THE INITIAL ALLOCATION?       07800000
         BNZ   BUMPGET            BRANCH IF NOT                         07810000
         L     R3,=A(IVTFVSIZ)    INITIAL COUNT FOR NEW FLV             07820000
                                                                        07830000
BUMPGET  DS    0H                                                       07840000
                                                                        07850000
         ST    R3,SEIS1FLM        SET NEW MAXIMUM                       07860000
         LA    R3,2(,R3)          PLUS TWO ENTRIES (SIZE & TERMINATOR)  07870000
         SLL   R3,1               AMOUNT OF STORAGE NEEDED              07880000
                                                                        07890000
         $GETSTOR (R3),                                                +07900000
               LOC=ANY            DEFAULT TO PROC STORAGE               07910000
                                                                        07920000
         ST    R1,SEIS1FLV        SET NEW FIELD VECTOR ADDRESS          07930000
         LTR   R7,R7              EXISTING FLV TO COPY?                 07940000
         BNP   BUMPDONE           BRANCH IF NOT                         07950000
         LA    R7,2(,R7)          PLUS TWO ENTRIES (SIZE & TERMINATOR)  07960000
         SLL   R7,1               AMOUNT OF TABLE TO COPY               07970000
         LR    R0,R1              COPY-TO ADDRESS                       07980000
         LR    R1,R7              COPY-TO LENGTH                        07990000
         LR    R3,R6              PRESERVE ADDRESS FOR RELEASE          08000000
         MVCL  R0,R6              COPY THE OLD FLV TO THE NEW ONE       08010000
                                                                        08020000
         $RETSTOR (R3)            RELEASE THE OLD FLV                   08030000
                                                                        08040000
BUMPDONE DS    0H                                                       08050000
                                                                        08060000
         LM    R14,R7,SUB1SAVE    RESTORE REGISTERS                     08070000
         BR    R14                RETURN TO CALLER                      08080000
                                                                        08090000
*---------------------------------------------------------------------- 08100000
*  CONSTANTS AND LITERALS                                               08110000
*---------------------------------------------------------------------- 08120000
                                                                        08130000
         LTORG ,                                                        08140000
         PRINT NOGEN                                                    08150000
         IHAPSA ,                 MVS PREFIXED SAVE AREA                08160000
         ISTDBIND ,               VTAM BIND IMAGE                       08170000
         TRACODES ,               INTEGRATOR TRACE CODE EQUATES         08180000
         SESSIMAG ,               INTEGRATOR LU2 IMAGE BLOCK            08190000
         ICVT  ,                  INTEGRATOR CVT                        08200000
         IVTAMCVT ,               INTEGRATOR VTAM CVT                   08210000
         ITASK ,                  INTEGRATOR TASK BLOCK                 08220000
         ISESS ,                  INTEGRATOR ISESS BLOCK                08230000
         TMSG  ,                  INTEGRATOR INTERTASK MSG FORMAT       08240000
         EVCODES ,                INTEGRATOR EVENT CODES                08250000
         ABCODES ,                INTEGRATOR $ABEND CODES               08260000
         MSGCODES ,               INTEGRATOR INTERTASK MSGING CODES     08270000
         @EPB ,                   INTEGRATOR EVENT PROCESS BLOCK        08280000
         END   ,                                                        08290000
